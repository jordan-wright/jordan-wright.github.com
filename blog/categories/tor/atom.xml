<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: tor | jordan-wright]]></title>
  <link href="http://jordan-wright.github.io/blog/categories/tor/atom.xml" rel="self"/>
  <link href="http://jordan-wright.github.io/"/>
  <updated>2015-05-27T06:10:07-05:00</updated>
  <id>http://jordan-wright.github.io/</id>
  <author>
    <name><![CDATA[Jordan]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[How Tor Works Part Three - The Consensus]]></title>
    <link href="http://jordan-wright.github.io/blog/2015/05/14/how-tor-works-part-three-the-consensus/"/>
    <updated>2015-05-14T18:30:00-05:00</updated>
    <id>http://jordan-wright.github.io/blog/2015/05/14/how-tor-works-part-three-the-consensus</id>
    <content type="html"><![CDATA[<p><img src="/images/headers/how_tor_works_2.png"/></p>

<h3>Introduction</h3>

<p>Welcome to the third post in my series on how Tor works! In the <a href="/blog/categories/tor/">past two posts</a>, we talked about how clients tunnel traffic through relays, as well as introduced the idea of unpublished relays called bridges.</p>

<p>But how do clients know what relays are active? How is the Tor network actually organized and maintained? This post will answer this question by talking about a living document called the <strong>consensus</strong> as well as introducing a few very important Tor nodes that run the show behind the scenes.</p>

<!--more-->


<h3>Respect My Authoritah</h3>

<p>In the last post, we mentioned that there is a master list of Tor relays as well as a master list of Tor bridges. Before talking about <em>how</em> this list is maintained, we need to talk about <em>who</em> maintains it.</p>

<p><a href="https://gitweb.torproject.org/tor.git/tree/src/or/config.c#n824">Hardcoded into each Tor client</a> is the information about 10 beefy Tor nodes run by trusted volunteers. These nodes have a very special role &ndash; to maintain the status of the entire Tor network. These nodes are known as <strong>directory authorities</strong> (DA&rsquo;s).</p>

<p>I&rsquo;ve <a href="/blog/2014/12/19/what-happens-if-tor-directory-authorities-are-seized/">written a bit</a> about DA&rsquo;s in the past. Distributed around the world, DA&rsquo;s are in charge of distributing an ever-updated master list of all known Tor relays. They are the gatekeepers that choose what relays are valid, and when.</p>

<p>So why 10? We know it&rsquo;s usually a bad idea to have an even number of things voting on something, since there could be ties. You&rsquo;ll recall that in the previous post I mentioned that there is a master list of relays <em>and</em> a master list of bridges. This is where the split happens. 9 of the DA&rsquo;s maintain the master list of relays, while one DA (Tonga) maintains the list of bridges.</p>

<p>Here are the DA&rsquo;s:</p>

<p><img src="http://jordan-wright.github.io/images/blog/how_tor_works/authorities.png"/></p>

<h3>Reaching a Consensus</h3>

<p>So there are DA&rsquo;s and they maintain the status of the Tor network. But, <strong>how</strong>?</p>

<p>The status of all the Tor relays is maintained in a living document called the <strong>consensus</strong>. DA&rsquo;s maintain this document and update it every hour by a vote. Here&rsquo;s a basic flow of how this updating process works.</p>

<ul>
<li>Each DA compiles a list of all known relays</li>
<li>Each DA then computes the other needed data, such as relay flags, bandwidth weights, and more</li>
<li>The DA then submits this data as a &ldquo;status-vote&rdquo; to all the other authorities</li>
<li>Each DA next will go get any other votes it is missing from the other authorities</li>
<li>All the parameters, relay information, etc. from each vote are combined or computed and then <strong>signed</strong> by each DA</li>
<li>This signature is then posted to the other DA&rsquo;s</li>
<li>There should be a majority of the DA&rsquo;s that agree on the data, validating the new consensus</li>
<li>The consensus is then published by each DA</li>
</ul>


<p>You&rsquo;ll notice that I mention each DA publishes this consensus. This is done over HTTP such that anyone can download the latest copy at <code>http://directory_authority/tor/status-vote/current/consensus/</code>. You can see for yourself by downloading the most current consensus from <code>tor26</code> <a href="http://86.59.21.38/tor/status-vote/current/consensus/">here</a>.</p>

<p>So we see a consensus&hellip; but what does it mean?</p>

<h3>Anatomy of a Consensus</h3>

<p>The consensus document is a bit tough to get a handle on right away just by reading <a href="https://gitweb.torproject.org/torspec.git/tree/dir-spec.txt">the spec</a>. I find it helps to have things broken down visually to get an idea of how things are structured.</p>

<p>To help with this, I made a poster in the fantastic <a href="https://github.com/corkami/">corkami</a> style. Here&rsquo;s a dissection of a snipped down version of the Tor consensus document (click for full resolution!):</p>

<p><a href="http://jordan-wright.github.io/images/blog/how_tor_works/consensus.png"><img src="http://jordan-wright.github.io/images/blog/how_tor_works/consensus_small.png"/></a></p>

<h3>Next Steps</h3>

<p>The consensus is a powerful document. By having trusted authorities keeping a master list of relays and their capabilities, it is easy for new and existing clients to keep track of the addition and removal of Tor relays.</p>

<p>Now, you&rsquo;ll notice that we haven&rsquo;t really covered exit relays. These relays hold a very important position in the Tor network, and deserve their own discussion. So, in the next post we&rsquo;ll talk about how exit relays work, and what happens when exit relay operators decide to &ldquo;break bad&rdquo;, or wreak havoc on Tor users.</p>

<p>Until then, let me know if you have any questions or comments below!</p>

<p>-Jordan (<a href="https://twitter.com/jw_sec">@jw_sec</a>)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[How Tor Works: Part Two - Relays vs. Bridges]]></title>
    <link href="http://jordan-wright.github.io/blog/2015/05/09/how-tor-works-part-two-relays-vs-bridges/"/>
    <updated>2015-05-09T15:00:00-05:00</updated>
    <id>http://jordan-wright.github.io/blog/2015/05/09/how-tor-works-part-two-relays-vs-bridges</id>
    <content type="html"><![CDATA[<p><img src="/images/headers/how_tor_works_2.png"/></p>

<h3>Introduction</h3>

<p>Welcome back to my series on how Tor works! In the <a href="/blog/2015/02/28/how-tor-works-part-one/">last post</a>, we took a look at how Tor operates from a very high level. In this post, we&rsquo;ll dive a bit deeper, taking a look at a potential issue with relays in order to introduce a new concept: <strong>bridges</strong>.</p>

<!--more-->


<h3>Relay Recap</h3>

<p>In the last post, we introduced relays as systems designed to move traffic in the Tor network. You&rsquo;ll recall that there were three types of relays:</p>

<ul>
<li><strong>Entry/Guard Relays</strong> &ndash; Entry points into the Tor network</li>
<li><strong>Middle Relays</strong> &ndash; Send traffic from an entry relay to an exit relay</li>
<li><strong>Exit Relays</strong> &ndash; Send the traffic out of the Tor network to the original destination</li>
</ul>


<p>Relays are created by volunteers by simply configuring the Tor software to act as a relay. As a reminder, if you have bandwidth to spare, consider setting up a Tor relay!</p>

<h3>The Problem With Relays</h3>

<p>When a Tor client starts up, it needs a way to fetch a list of all the entry, middle, and exit relays available. This list of all relays isn&rsquo;t a secret. In fact, in the next post I&rsquo;ll explain in detail how this list is distributed (for a sneak peek check out documents on the <em>concensus</em>). While making this list public is necessary, it also presents a problem.</p>

<p>To figure out why this is problem, let&rsquo;s play the role of the attacker and ask ourselves: <em>What Would an Oppressive Government Do (WWOGD)?</em>. By thinking to ourselves what a <strong><em>real OG</em></strong> would do, we can figure out why Tor is built the way it is.</p>

<p>So what would a real OG do? Since censorship is a pretty big deal, and Tor is pretty darn good at getting around it, a real OG would want to block users from using Tor. There are two ways to &ldquo;block Tor users&rdquo;:</p>

<ul>
<li>Block users coming out of Tor</li>
<li>Block users going into Tor</li>
</ul>


<p>The first situation is possible, and is up to the discretion of the device (router, etc.) or website owner. All a site owner needs to do is to download the list of Tor exit nodes and block all traffic from those nodes. While this would be unfortunate, there&rsquo;s nothing Tor can really do about it.</p>

<p>However, the second situation is much worse. While blocking incoming Tor users can keep them from a particular site, blocking users from going into Tor will keep them from <strong>every</strong> site, making Tor effectively useless to those under censorship &ndash; some of the users who need Tor most. Just using relays, this is possible since real OG&rsquo;s can just download a list of all guard relays and block any traffic to them.</p>

<p>Thankfully, the Tor project thought of exactly this situation and came up with a clever solution around it. Say hello to <strong>bridges</strong>.</p>

<h3>Introducing Bridges</h3>

<p><a href="https://www.torproject.org/docs/bridges.html.en">Bridges</a> are a clever solution to this problem. At their core, bridges are just unpublished entry relays. Users that are behind censored networks can use bridges as a way to access the Tor network.</p>

<p>So if bridges are unpublished, how do users know where they are? Won&rsquo;t a master list need to be published somewhere? We&rsquo;ll talk more about these master lists of relays and bridges in the next post, but for now the answer is yes &ndash; there is a list of bridges maintained by the Tor project.</p>

<p><strong>This list just isn&rsquo;t made public.</strong></p>

<p>Instead, the Tor project has created a way for users to receive a small list of bridges so that they can connect to the rest of the Tor network. This project, called <a href="https://bridges.torproject.org/bridges">BridgeDB</a> gives users the information about a few bridges at a time. This makes sense, since a few bridges should be all any user needs.</p>

<p>By only giving users a few bridges at a time, it is possible to prevent OG&rsquo;s from blocking all possible entry points into the Tor network. Sure, as relays are discovered they can be blocked, but can anyone really discover all the bridges?</p>

<h3>Can Anyone Find Every Bridge?</h3>

<p>The list of all bridges is a closely guarded secret. If a real OG were able to gain access to this list, it would be able to completely block users from using Tor. With this being the case, there has been <a href="https://blog.torproject.org/blog/research-problems-ten-ways-discover-tor-bridges">research</a> done by the Tor project into possible ways people could discover all the bridges.</p>

<p>I&rsquo;d like to talk very briefly about #2 and #6 on that list, since that&rsquo;s <a href="https://zmap.io/paper.pdf"><em>exactly</em></a> <a href="http://www.cs.uml.edu/~xinwenfu/paper/Bridge.pdf">what</a> researchers have done with some significant success. In the first scenario, researchers scanned the entire IPv4 space using a fast port scanner called ZMap looking for Tor bridges and &ldquo;were able to identify 79â€“86%&rdquo;<sup>1</sup> of them. I recommend reading the paper for the really cool technical details (about finding Tor bridges and ZMap in general).</p>

<p>The second scenario is a neat one and introduces an important challenge for Tor (or any network for that matter). It all comes down to a simple concept &ndash; <em>users can&rsquo;t be trusted</em>. In order to keep the Tor network as anonymous and locked down as possible, the Tor network is designed in such a way to intentionally distrust relay operators. We&rsquo;ll see more examples of this later.</p>

<h3>Next Steps</h3>

<p>In this post, we&rsquo;ve talked about the need for relays that aren&rsquo;t published in some &ldquo;master list&rdquo;. But, you&rsquo;ll notice I didn&rsquo;t give many details about <em>how</em> this master list is created, or how Tor clients get access to the list.</p>

<p>So, in our next post, we&rsquo;ll take a look at how the Tor network maintains the status of all relays in the network. We&rsquo;ll also introduce some very powerful relays in the Tor network who run the show &ndash; <strong>directory authorities</strong>.</p>

<p>As always, please let me know if you have any questions or comments below!</p>

<p><em>Update: <a href="/blog/2015/05/14/how-tor-works-part-three-the-consensus/">Part three &ndash; &ldquo;The Consensus&rdquo;</a> has been published!</em></p>

<p>-Jordan (<a href="https://twitter.com/jw_sec">@jw_sec</a>)</p>

<p><sup>[1] <a href="https://zmap.io/paper.pdf">https://zmap.io/paper.pdf</a></sup></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[How Tor Works: Part One]]></title>
    <link href="http://jordan-wright.github.io/blog/2015/02/28/how-tor-works-part-one/"/>
    <updated>2015-02-28T18:00:00-06:00</updated>
    <id>http://jordan-wright.github.io/blog/2015/02/28/how-tor-works-part-one</id>
    <content type="html"><![CDATA[<p><img src="/images/headers/how_tor_works_1.png"/></p>

<h3>Introduction</h3>

<p>Tor is an anonymity tool used by those who want to stay private and uncensored when browsing the Internet. Over time, it&rsquo;s grown to be pretty darn good at this. This makes the security, stability, and speed of the underlying network critical to those depending on it.</p>

<p>But how does Tor work under the hood? In this series of posts, we&rsquo;ll take a deep dive into the structure and protocols used by the Tor network in order to see first-hand how Tor operates.</p>

<!--more-->


<h3>Brief History of Tor</h3>

<p>The concept of Onion Routing (more on why it&rsquo;s called this later) was first <a href="http://www.onion-router.net/History.html">proposed</a> in 1995, where it was first funded by the <a href="http://www.onr.navy.mil/">Office of Naval Research</a> (ONR) and later helped out by DARPA in 1997. Since then, funding for the Tor Project has been provided by a <a href="https://www.torproject.org/about/sponsors.html.en">number of different sponsors</a>, and the Tor Project was recently announced a winner of the <a href="http://www.redditblog.com/2015/02/announcing-winners-of-reddit-donate.html">reddit donate</a> campaign.</p>

<p>The Tor software as we know it today was originally open-sourced in October of 2003, and is the 3<sup>rd</sup> generation of Onion Routing software. This idea of Onion Routing was (and is!) simply that we can wrap traffic in encrypted layers (like <em>onions</em>) in order to protect the contents of the data as well as the anonymity of the sender and receiver.</p>

<h3>Tor 101</h3>

<p>Now that we know a bit about Tor&rsquo;s history, let&rsquo;s talk about how it works. At an <em>extremely</em> high level, Tor works by bouncing connections from your computer to destinations (such as google.com) through a series of intermediate computers, or <strong>relays</strong>.</p>

<div style="padding:10px;background:#3498DB;border-radius:5px;">
<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   width="100%"
   height="482"
   style="max-height:250px;"
   onclick="d.reset().play();"
   viewBox="0 0 748 483"
   id="earth"
   version="1.1">
  <defs
     id="defs5976" />
  <g
     inkscape:label="Layer 1"
     inkscape:groupmode="layer"
     id="layer1"
     transform="translate(-135.6,-230.9)">
    <g
       id="g6088"
       transform="matrix(9.9,0,0,9.9,135.6,230.9)"
       style="fill:#ffffff">
      <g
         id="g6036"
         style="fill:#ffffff">
    <g
   id="g6038"
   style="fill:#ffffff">
        <polygon
   id="polygon6040"
   points="35.5,9.4 34.7,9.5 34.5,9.9 34.5,10.2 34.9,10.5 35.4,10.8 35.4,11.1 34.9,11.2 34.8,12.0 35.5,12.0 36.3,11.9 36.8,11.4 36.3,11.2 36.0,10.9 35.7,10.3 "
   style="fill:#ffffff" />

        <polygon
   id="polygon6042"
   points="33.8,10.5 33.3,11.2 33.3,11.7 33.8,11.7 34.8,11.1 34.8,10.6 34.4,10.4 "
   style="fill:#ffffff" />

        <path
   id="path6044"
   d="m 22.4,13.1 -0.1,0.3 h -0.6 v 0.3 h 0.1 c 0,0 0.0,0.0 0.0,0.1 l 0.3,-0.0 0.2,-0.1 0.0,-0.3 0.3,-0.0 0.1,-0.2 -0.2,-0.0 -0.2,0.0 z"
   inkscape:connector-curvature="0"
   style="fill:#ffffff" />

        <polygon
   id="polygon6046"
   points="20.8,13.7 20.7,14.0 21.2,14.0 21.2,13.7 21.0,13.4 "
   style="fill:#ffffff" />

        <path
   id="path6048"
   d="M 48.6,24.0 C 48.6,23.3 48.5,22.6 48.5,21.9 48.2,19.6 47.7,17.4 46.9,15.3 46.8,15.1 46.7,15.0 46.7,14.8 45.6,12.2 44.0,9.8 42.1,7.8 42.0,7.6 41.9,7.5 41.7,7.4 41.4,7.0 41.0,6.6 40.6,6.3 36.3,2.4 30.6,0 24.3,0 17.9,0 12.1,2.4 7.8,6.4 6.8,7.3 5.9,8.3 5.0,9.4 1.8,13.5 0,18.7 0,24.3 c 0,13.4 10.9,24.3 24.3,24.3 9.4,0 17.6,-5.4 21.6,-13.2 0.8,-1.6 1.5,-3.4 1.9,-5.3 0.1,-0.4 0.2,-0.9 0.3,-1.4 0.2,-1.3 0.3,-2.8 0.3,-4.2 10e-4,-0.0 -0.0,-0.1 -0.0,-0.2 z m -4.5,-9.7 0.1,-0.1 c 0.1,0.3 0.3,0.7 0.5,1.0 l -0.2,-0.0 -0.4,0.0 V 14.3 z M 40.5,10.1 40.5,9.0 c 0.3,0.4 0.7,0.8 1.1,1.2 l -0.4,0.6 -1.5,-0.0 -0.0,-0.3 0.9,-0.4 z M 11.2,7.4 V 7.3 h 0.4 l 0.0,-0.1 h 0.7 v 0.3 l -0.2,0.3 h -1.0 l 10e-4,-0.4 0,0 z m 0.7,1.0 c 0,0 0.4,-0.0 0.5,-0.0 0.0,0 0,0.4 0,0.4 L 11.4,8.9 11.2,8.7 11.9,8.4 z m 33.6,9.6 h -1.7 l -1.0,-0.8 -1.1,0.1 v 0.6 h -0.3 l -0.3,-0.2 -1.9,-0.5 v -1.2 l -2.5,0.1 -0.7,0.4 h -0.9 l -0.4,-0.0 -1.2,0.6 v 1.2 l -2.4,1.7 0.2,0.7 h 0.5 L 31,21.8 l -0.3,0.1 -0.0,1.8 2.1,2.4 h 0.9 l 0.0,-0.1 h 1.6 l 0.4,-0.4 h 0.9 l 0.5,0.5 1.4,0.1 -0.1,1.8 1.5,2.7 -0.8,1.5 0.0,0.7 0.6,0.6 v 1.7 l 0.8,1.1 v 1.4 h 0.7 c -4.0,5.0 -10.3,8.2 -17.3,8.2 C 12.0,46.6 2,36.6 2,24.3 2,21.2 2.6,18.2 3.7,15.5 V 14.8 L 4.5,13.9 C 4.8,13.3 5.1,12.8 5.4,12.3 L 5.5,12.7 4.5,13.9 C 4.2,14.4 4.0,15.0 3.7,15.5 v 1.2 l 0.9,0.4 v 1.7 l 0.8,1.5 0.7,0.1 0.0,-0.5 -0.8,-1.3 -0.1,-1.2 h 0.5 l 0.2,1.3 1.2,1.7 -0.3,0.5 0.7,1.1 1.9,0.4 v -0.3 l 0.7,0.1 -0.0,0.5 0.6,0.1 0.9,0.2 1.3,1.5 1.7,0.1 0.1,1.3 -1.1,0.8 -0.0,1.2 -0.1,0.7 1.6,2.1 0.1,0.7 c 0,0 0.6,0.1 0.6,0.1 0.0,0 1.3,0.9 1.3,0.9 v 3.8 l 0.4,0.1 -0.3,1.7 0.7,1.0 -0.1,1.7 1.0,1.8 1.3,1.1 1.3,0.0 0.1,-0.4 -0.9,-0.8 0.0,-0.4 0.1,-0.5 0.0,-0.5 -0.6,-0.0 -0.3,-0.4 0.5,-0.5 0.0,-0.3 -0.6,-0.1 0.0,-0.3 0.8,-0.1 1.3,-0.6 0.4,-0.8 1.3,-1.7 -0.3,-1.3 0.4,-0.7 1.2,0.0 0.8,-0.6 0.2,-2.6 0.9,-1.2 0.1,-0.7 -0.8,-0.2 -0.5,-0.9 -1.9,-0.0 -1.5,-0.5 -0.0,-1.1 -0.5,-0.9 -1.4,-0.0 -0.8,-1.2 -0.7,-0.3 -0.0,0.3 -1.3,0.0 -0.4,-0.6 -1.3,-0.2 -1.1,1.3 -1.7,-0.3 -0.1,-2.0 -1.2,-0.2 0.5,-0.9 -0.1,-0.5 -1.7,1.1 -1.0,-0.1 -0.3,-0.8 0.2,-0.8 0.5,-1.0 1.3,-0.6 2.6,-0.0 -0.0,0.8 0.9,0.4 -0.0,-1.3 0.6,-0.6 1.3,-0.9 0.0,-0.6 1.3,-1.4 1.4,-0.8 -0.1,-0.1 0.9,-0.9 0.3,0.0 0.1,0.2 0.3,-0.4 0.0,-0.0 -0.4,-0.0 -0.4,-0.1 v -0.4 l 0.2,-0.1 h 0.4 l 0.2,0.0 0.1,0.3 0.2,-0.0 v -0.0 l 0.0,0.0 0.6,-0.1 0.0,-0.3 0.3,0.0 v 0.3 l -0.3,0.2 h 10e-4 l 0.0,0.3 1.2,0.3 c 0,0 10e-4,0.0 0.0,0.0 l 0.2,-0.0 0.0,-0.5 -0.9,-0.4 -0.0,-0.2 0.8,-0.2 0.0,-0.7 -0.8,-0.5 -0.0,-1.3 -1.1,0.5 h -0.4 l 0.1,-1.0 -1.5,-0.3 -0.6,0.4 v 1.5 l -1.1,0.3 -0.4,0.9 -0.5,0.0 V 10.5 L 16.9,10.3 16.3,10.0 16.1,9.2 18.1,8.0 19.0,7.7 19.1,8.4 19.7,8.3 19.7,8.0 20.3,7.9 20.3,7.8 20.1,7.7 20.0,7.4 l 0.6,-0.0 0.4,-0.4 0.0,-0.0 0.0,0.0 0.1,-0.1 1.4,-0.1 0.6,0.5 -1.6,0.9 2.1,0.5 0.2,-0.7 h 0.9 L 25.4,7.1 24.7,7.0 V 6.2 L 22.6,5.2 21.2,5.4 20.4,5.8 20.4,6.9 19.6,6.7 19.5,6.2 20.3,5.4 18.8,5.3 l -0.4,0.1 -0.1,0.5 0.5,0.0 -0.1,0.5 -0.9,0.0 -0.1,0.3 -1.3,0.0 c 0,0 -0.0,-0.7 -0.0,-0.7 -0.0,0 1.0,-0.0 1.0,-0.0 L 18.0,5.5 17.5,5.3 16.9,5.8 15.9,5.8 15.3,5.0 H 14.1 L 12.8,6.0 h 1.2 l 0.1,0.3 -0.3,0.2 1.3,0.0 0.2,0.4 L 13.8,7.1 13.7,6.7 12.8,6.5 12.3,6.2 11.2,6.2 C 14.8,3.5 19.4,2 24.3,2 c 5.6,0 10.7,2.1 14.7,5.5 l -0.2,0.4 -1.0,0.4 -0.4,0.4 0.1,0.5 0.5,0.0 0.3,0.8 0.9,-0.3 0.1,1.0 h -0.2 l -0.7,-0.1 -0.8,0.1 -0.8,1.1 -1.1,0.1 -0.1,0.9 0.4,0.1 -0.1,0.6 -1.1,-0.2 -1.0,0.2 -0.2,0.5 0.1,1.2 0.6,0.2 1.0,-0.0 0.6,-0.0 0.2,-0.5 1.0,-1.4 0.7,0.1 0.7,-0.6 0.1,0.5 1.7,1.1 -0.2,0.2 -0.7,-0.0 0.3,0.4 0.4,0.1 0.5,-0.2 -0.0,-0.6 0.2,-0.1 -0.2,-0.2 -1.1,-0.6 -0.3,-0.8 h 0.9 l 0.3,0.3 0.8,0.7 0.0,0.8 0.8,0.9 0.3,-1.2 0.5,-0.3 0.1,1.0 0.5,0.6 1.1,-0.0 c 0.2,0.5 0.4,1.1 0.6,1.7 l -0.1,0.1 z m -32.3,-7.0 0.5,-0.2 0.5,0.1 -0.1,0.7 -0.5,0.1 -0.3,-0.7 z m 3.0,1.6 v 0.4 h -1.3 l -0.5,-0.1 0.1,-0.3 0.6,-0.2 h 0.8 v 0.2 h 0.1 z m 0.6,0.6 V 13.8 l -0.3,0.2 -0.4,0.0 c 0,0 0,-0.6 0,-0.7 h 0.7 z m -0.3,-0.1 v -0.5 l 0.4,0.4 -0.4,0.1 z m 0.2,1.0 v 0.4 l -0.3,0.3 h -0.7 l 0.1,-0.4 0.3,-0.0 0.0,-0.1 0.5,-0.0 z m -1.7,-0.8 h 0.7 l -0.9,1.3 -0.3,-0.2 0.0,-0.5 0.5,-0.5 z m 3.0,0.7 v 0.4 H 17.3 l -0.1,-0.2 v -0.4 h 0.0 l 0.8,0.2 z m -0.6,-0.5 0.2,-0.2 0.3,0.2 -0.2,0.2 -0.2,-0.2 z m 28.5,5.7 0.0,-0.0 c 0.0,0.1 0.0,0.2 0.0,0.3 l -0.1,-0.2 z"
   inkscape:connector-curvature="0"
   style="fill:#ffffff" />

        <path
   id="path6050"
   d="M 3.7,14.8 V 15.5 C 4.0,15.0 4.2,14.4 4.5,13.9 l -0.7,0.9 z"
   inkscape:connector-curvature="0"
   style="fill:#ffffff" />

    </g>

</g>
      <g
         id="g6052"
         style="fill:#ffffff">
</g>
      <g
         id="g6054"
         style="fill:#ffffff">
</g>
      <g
         id="g6056"
         style="fill:#ffffff">
</g>
      <g
         id="g6058"
         style="fill:#ffffff">
</g>
      <g
         id="g6060"
         style="fill:#ffffff">
</g>
      <g
         id="g6062"
         style="fill:#ffffff">
</g>
      <g
         id="g6064"
         style="fill:#ffffff">
</g>
      <g
         id="g6066"
         style="fill:#ffffff">
</g>
      <g
         id="g6068"
         style="fill:#ffffff">
</g>
      <g
         id="g6070"
         style="fill:#ffffff">
</g>
      <g
         id="g6072"
         style="fill:#ffffff">
</g>
      <g
         id="g6074"
         style="fill:#ffffff">
</g>
      <g
         id="g6076"
         style="fill:#ffffff">
</g>
      <g
         id="g6078"
         style="fill:#ffffff">
</g>
      <g
         id="g6080"
         style="fill:#ffffff">
</g>
    </g>
    <path
       style="fill:none;stroke:#96281b;stroke-width:3;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
       d="m 292.9,394.7 c 0,0 85.8,-133.3 186.8,20.2"
       id="path6115"
       inkscape:connector-curvature="0" />
    <path
       style="fill:none;stroke:#000000;stroke-width:3;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
       d="m 479.8,414.9 c 0,0 87.8,-141.4 56.5,63.6"
       id="path6625"
       inkscape:connector-curvature="0" />
    <path
       style="fill:none;stroke:#90c695;stroke-width:3;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
       d="m 401.4,247.1 c 0,0 -142.8,-90.7 -216.4,33.5"
       id="path6627"
       inkscape:connector-curvature="0"
       transform="translate(135.6,230.9)" />
    <path
       style="fill:none;stroke:#f4b350;stroke-width:3;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
       d="m 185.7,280.0 c 0,0 17.8,-149.2 -93.5,-107.1"
       id="path6629"
       inkscape:connector-curvature="0"
       transform="translate(135.6,230.9)" />
    <path
       style="fill:none;stroke:#96281b;stroke-width:3;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
       d="m 688.2,283.4 39.3,0"
       id="path6631"
       inkscape:connector-curvature="0" />
    <path
       style="fill:none;stroke:#000000;stroke-width:3;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
       d="m 688.7,338.5 39.3,0"
       id="path6631-4"
       inkscape:connector-curvature="0" />
    <path
       style="fill:none;stroke:#90c695;stroke-width:3;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
       d="m 688.7,393.5 39.3,0"
       id="path6631-6"
       inkscape:connector-curvature="0" />
    <path
       style="fill:none;stroke:#f4b350;stroke-width:3;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
       d="m 688.7,452.1 39.3,0"
       id="path6631-0"
       inkscape:connector-curvature="0" />
    <text
       xml:space="preserve"
       style="font-size:20px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;line-height:125%;letter-spacing:0px;word-spacing:0px;fill:#ffffff;fill-opacity:1;stroke:none;font-family:Segoe UI;-inkscape-font-specification:Segoe UI"
       x="740.7"
       y="288.3"
       id="text6740"
       sodipodi:linespacing="125%"><tspan
         sodipodi:role="line"
         x="740.7"
         y="288.3"
         id="tspan6742"><tspan
           x="740.7"
           y="288.3"
           style="font-weight:300;fill:#ffffff;"
           id="tspan6744">Guard Node</tspan></tspan></text>
    <text
       xml:space="preserve"
       style="font-size:20px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;line-height:125%;letter-spacing:0px;word-spacing:0px;fill:#ffffff;fill-opacity:1;stroke:none;font-family:Segoe UI;-inkscape-font-specification:Segoe UI"
       x="743.0"
       y="344.3"
       id="text6746"
       sodipodi:linespacing="125%"><tspan
         sodipodi:role="line"
         x="743.0"
         y="344.3"
         id="tspan6748"><tspan
           x="743.0"
           y="344.3"
           style="font-weight:300;fill:#ffffff;"
           id="tspan6750">Middle Node</tspan></tspan></text>
    <text
       xml:space="preserve"
       style="font-size:20px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;line-height:125%;letter-spacing:0px;word-spacing:0px;fill:#ffffff;fill-opacity:1;stroke:none;font-family:Segoe UI;-inkscape-font-specification:Segoe UI"
       x="741.4"
       y="399.8"
       id="text6752"
       sodipodi:linespacing="125%"><tspan
         sodipodi:role="line"
         x="741.4"
         y="399.8"
         id="tspan6754"><tspan
           x="741.4"
           y="399.8"
           style="font-weight:300;fill:#ffffff;"
           id="tspan6756">Exit Node</tspan></tspan></text>
    <text
       xml:space="preserve"
       style="font-size:20px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;line-height:125%;letter-spacing:0px;word-spacing:0px;fill:#ffffff;fill-opacity:1;stroke:none;font-family:Segoe UI;-inkscape-font-specification:Segoe UI"
       x="742.3"
       y="458.5"
       id="text6758"
       sodipodi:linespacing="125%"><tspan
         sodipodi:role="line"
         x="742.3"
         y="458.5"
         id="tspan6760"><tspan
           x="742.3"
           y="458.5"
           style="font-weight:300;fill:#ffffff;"
           id="tspan6762">Final Destination</tspan></tspan></text>
  </g>
</svg>
</div>


<br/>


<p>Currently, there are <a href="https://metrics.torproject.org/networksize.html">about 6000 relays</a> routing traffic through the Tor network. These relays are located all across the world and run completely by volunteers willing to give up some bandwidth for the cause. It&rsquo;s important to note that most relays don&rsquo;t have special hardware or software to run. They just have the Tor software configured to act as a relay.</p>

<p>When it comes to speed and anonymity of the Tor network &ndash; the more relays, the better! This makes sense, because every relay only has so much bandwidth to offer. Additionally, if there are more relays to choose from, it will be more difficult to track any one user.</p>

<h3>Types of Relays</h3>

<p>By default, Tor bounces connections through 3 relays. Each of these have a specific role to play (we&rsquo;ll cover each in more detail in later posts):</p>

<div style="padding:10px;background:#3498DB;border-radius:5px;">
<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   width="100%"
   height="1236.6"
   id="network"
   version="1.1"
   style="max-height:300px;"
   onclick="e.reset().play(1.25);"
   viewBox="0 0 1956 1236">
  <defs
     id="defs8112" />
     <g
        inkscape:label="Layer 1"
        inkscape:groupmode="layer"
        id="layer1"
        transform="translate(885.83545,44.405879)">
       <g
          id="g8200"
          transform="matrix(0.38940404,0,0,0.37354888,832.4136,424.91373)"
          style="fill:#ffffff">
         <g
            id="g8160"
            style="fill:#ffffff">
    <path
      id="path8162"
      d="M 578.766,51.487 V 50.592 H 575.77 35.93 32.934 v 0.895 C 15.272,52.701 2.095,66.753 0,83.808 v 3.002 355.724 c 0,6.898 1.795,12.712 4.791,17.949 6.893,12.137 17.068,18.269 31.14,18.269 h 197.012 v 49.695 h -37.425 c -9.281,0 -16.467,7.218 -16.467,16.48 0,9.262 7.186,16.479 16.467,16.479 h 220.666 c 9.281,0 16.768,-7.218 16.768,-16.479 0,-9.263 -7.486,-16.48 -16.768,-16.48 H 378.759 V 478.752 H 575.77 c 14.078,0 24.343,-6.132 31.14,-18.269 3.085,-5.493 5.091,-11.37 5.091,-17.949 V 86.811 83.809 C 609.905,66.753 595.833,52.701 578.766,51.487 z m 0,35.324 v 355.724 c 0,2.108 -0.895,3.002 -2.996,3.002 H 35.93 c -2.095,0 -2.996,-0.894 -2.996,-3.002 V 86.811 83.809 h 545.831 v 3.002 z"
      inkscape:connector-curvature="0"
      style="fill:#ffffff" />

   </g>
         <g
            id="g8164"
            style="fill:#ffffff">
   </g>
         <g
            id="g8166"
            style="fill:#ffffff">
   </g>
         <g
            id="g8168"
            style="fill:#ffffff">
   </g>
         <g
            id="g8170"
            style="fill:#ffffff">
   </g>
         <g
            id="g8172"
            style="fill:#ffffff">
   </g>
         <g
            id="g8174"
            style="fill:#ffffff">
   </g>
         <g
            id="g8176"
            style="fill:#ffffff">
   </g>
         <g
            id="g8178"
            style="fill:#ffffff">
   </g>
         <g
            id="g8180"
            style="fill:#ffffff">
   </g>
         <g
            id="g8182"
            style="fill:#ffffff">
   </g>
         <g
            id="g8184"
            style="fill:#ffffff">
   </g>
         <g
            id="g8186"
            style="fill:#ffffff">
   </g>
         <g
            id="g8188"
            style="fill:#ffffff">
   </g>
         <g
            id="g8190"
            style="fill:#ffffff">
   </g>
         <g
            id="g8192"
            style="fill:#ffffff">
   </g>
       </g>
       <path
          id="path8222"
          d="m -228.29943,189.87983 h -114.8306 c -2.06335,0 -3.73222,1.67169 -3.73222,3.73343 v 33.93777 c 0,2.06174 1.66887,3.73222 3.73222,3.73222 h 114.831 c 2.06536,0 3.73262,-1.67048 3.73262,-3.73222 v -33.93536 c 0,-2.06415 -1.66766,-3.73584 -3.73302,-3.73584 z m -57.4143,29.54742 h -49.01236 v -19.60463 h 49.01236 v 19.60463 z m 57.4143,20.51836 h -114.8306 c -2.06335,0 -3.73222,1.67048 -3.73222,3.73222 v 33.93898 c 0,2.06294 1.66887,3.73463 3.73222,3.73463 h 114.831 c 2.06536,0 3.73262,-1.67169 3.73262,-3.73463 v -33.93898 c 0,-2.06174 -1.66766,-3.73222 -3.73302,-3.73222 z m -57.4143,29.04184 h -49.01236 v -19.60502 h 49.01236 v 19.60502 z m 57.4143,20.53889 h -114.8306 c -2.06335,0 -3.73222,1.67411 -3.73222,3.73584 v 33.93777 c 0,2.06134 1.66887,3.73102 3.73222,3.73102 h 114.831 c 2.06536,0 3.73262,-1.66928 3.73262,-3.73102 v -33.93777 c 0,-2.06173 -1.66766,-3.73584 -3.73302,-3.73584 z m -57.4143,30.50664 h -49.01236 v -19.60342 h 49.01236 v 19.60342 z m 25.89933,45.95518 h 29.29383 v 5.34836 h -29.24633 v 0.25078 c 0,3.3792 -2.73557,6.11437 -6.11035,6.11437 h -39.67859 c -3.37438,0 -6.11276,-2.73557 -6.11276,-6.11437 v -0.25078 h -29.24271 v -5.34836 h 29.29504 c 0.26083,-3.13648 2.85994,-5.60316 6.06083,-5.60316 h 12.17722 v -12.21988 c 0,-3.37478 2.73516,-6.11477 6.10994,-6.11477 h 3.05598 c 3.37518,0 6.11115,2.74039 6.11115,6.11477 V 360.385 h 12.22431 c 3.20249,0 5.79758,2.47151 6.06244,5.60316 z"
          inkscape:connector-curvature="0"
          style="fill:#ffffff" />
       <g
          id="g8414"
          transform="matrix(2.4669289,0,0,2.4669289,-885.8347,435.09715)"
          style="fill:#ffffff">
         <g
            id="g8370"
            style="fill:#ffffff">
    <g
      id="g8372"
      style="fill:#ffffff">
        <path
      id="path8374"
      d="m 97.265,71.261 c -0.093,-0.108 -0.23,-0.172 -0.374,-0.172 H 0.494 c -0.144,0 -0.28,0.063 -0.374,0.172 -0.094,0.108 -0.136,0.253 -0.115,0.396 0.014,0.09 1.468,9.016 12.753,9.016 h 71.869 c 11.284,0 12.738,-8.926 12.753,-9.016 0.02,-0.143 -0.022,-0.288 -0.115,-0.396 z m -41.323,6.286 h -14.5 v -3.334 h 14.5 v 3.334 z"
      inkscape:connector-curvature="0"
      style="fill:#ffffff" />

        <path
      id="path8376"
      d="m 10.507,67.619 h 76.37 c 1.104,0 2,-0.896 2,-2 V 18.713 c 0,-1.104 -0.896,-2 -2,-2 h -76.37 c -1.104,0 -2,0.896 -2,2 v 46.906 c 0,1.104 0.896,2 2,2 z m 5,-43.906 h 66.37 V 60.619 H 15.507 V 23.713 z"
      inkscape:connector-curvature="0"
      style="fill:#ffffff" />

    </g>

   </g>
         <g
            id="g8378"
            style="fill:#ffffff">
   </g>
         <g
            id="g8380"
            style="fill:#ffffff">
   </g>
         <g
            id="g8382"
            style="fill:#ffffff">
   </g>
         <g
            id="g8384"
            style="fill:#ffffff">
   </g>
         <g
            id="g8386"
            style="fill:#ffffff">
   </g>
         <g
            id="g8388"
            style="fill:#ffffff">
   </g>
         <g
            id="g8390"
            style="fill:#ffffff">
   </g>
         <g
            id="g8392"
            style="fill:#ffffff">
   </g>
         <g
            id="g8394"
            style="fill:#ffffff">
   </g>
         <g
            id="g8396"
            style="fill:#ffffff">
   </g>
         <g
            id="g8398"
            style="fill:#ffffff">
   </g>
         <g
            id="g8400"
            style="fill:#ffffff">
   </g>
         <g
            id="g8402"
            style="fill:#ffffff">
   </g>
         <g
            id="g8404"
            style="fill:#ffffff">
   </g>
         <g
            id="g8406"
            style="fill:#ffffff">
   </g>
       </g>
       <path
          id="path8222-9"
          d="m -234.01367,435.59412 h -114.8306 c -2.06335,0 -3.73222,1.67169 -3.73222,3.73343 v 33.93777 c 0,2.06174 1.66887,3.73222 3.73222,3.73222 h 114.831 c 2.06536,0 3.73262,-1.67048 3.73262,-3.73222 v -33.93536 c 0,-2.06415 -1.66766,-3.73584 -3.73302,-3.73584 z m -57.4143,29.54742 h -49.01236 v -19.60463 h 49.01236 v 19.60463 z m 57.4143,20.51836 h -114.8306 c -2.06335,0 -3.73222,1.67048 -3.73222,3.73222 v 33.93898 c 0,2.06294 1.66887,3.73463 3.73222,3.73463 h 114.831 c 2.06536,0 3.73262,-1.67169 3.73262,-3.73463 v -33.93898 c 0,-2.06174 -1.66766,-3.73222 -3.73302,-3.73222 z m -57.4143,29.04184 h -49.01236 v -19.60502 h 49.01236 v 19.60502 z m 57.4143,20.53889 h -114.8306 c -2.06335,0 -3.73222,1.67411 -3.73222,3.73584 v 33.93777 c 0,2.06134 1.66887,3.73102 3.73222,3.73102 h 114.831 c 2.06536,0 3.73262,-1.66928 3.73262,-3.73102 v -33.93777 c 0,-2.06173 -1.66766,-3.73584 -3.73302,-3.73584 z m -57.4143,30.50664 h -49.01236 v -19.60342 h 49.01236 v 19.60342 z m 25.89933,45.95518 h 29.29383 v 5.34836 h -29.24633 v 0.25078 c 0,3.3792 -2.73557,6.11437 -6.11035,6.11437 h -39.67859 c -3.37438,0 -6.11276,-2.73557 -6.11276,-6.11437 v -0.25078 h -29.24271 v -5.34836 h 29.29504 c 0.26083,-3.13648 2.85994,-5.60316 6.06083,-5.60316 h 12.17722 v -12.21988 c 0,-3.37478 2.73516,-6.11477 6.10994,-6.11477 h 3.05598 c 3.37518,0 6.11115,2.74039 6.11115,6.11477 v 12.21988 h 12.22431 c 3.20249,0 5.79758,2.47151 6.06244,5.60316 z"
          inkscape:connector-curvature="0"
          style="fill:#ffffff" />
       <path
          id="path8222-90"
          d="m -242.5851,692.73698 h -114.8306 c -2.06335,0 -3.73222,1.67169 -3.73222,3.73343 v 33.93777 c 0,2.06174 1.66887,3.73222 3.73222,3.73222 h 114.831 c 2.06536,0 3.73262,-1.67048 3.73262,-3.73222 v -33.93536 c 0,-2.06415 -1.66766,-3.73584 -3.73302,-3.73584 z m -57.4143,29.54742 h -49.01236 v -19.60463 h 49.01236 v 19.60463 z m 57.4143,20.51836 h -114.8306 c -2.06335,0 -3.73222,1.67048 -3.73222,3.73222 v 33.93898 c 0,2.06294 1.66887,3.73463 3.73222,3.73463 h 114.831 c 2.06536,0 3.73262,-1.67169 3.73262,-3.73463 v -33.93898 c 0,-2.06174 -1.66766,-3.73222 -3.73302,-3.73222 z m -57.4143,29.04184 h -49.01236 v -19.60502 h 49.01236 v 19.60502 z m 57.4143,20.53889 h -114.8306 c -2.06335,0 -3.73222,1.67411 -3.73222,3.73584 v 33.93777 c 0,2.06134 1.66887,3.73102 3.73222,3.73102 h 114.831 c 2.06536,0 3.73262,-1.66928 3.73262,-3.73102 v -33.93777 c 0,-2.06173 -1.66766,-3.73584 -3.73302,-3.73584 z m -57.4143,30.50664 h -49.01236 v -19.60342 h 49.01236 v 19.60342 z m 25.89933,45.95518 h 29.29383 v 5.34836 h -29.24633 v 0.25078 c 0,3.3792 -2.73557,6.11437 -6.11035,6.11437 h -39.67859 c -3.37438,0 -6.11276,-2.73557 -6.11276,-6.11437 v -0.25078 h -29.24271 v -5.34836 h 29.29504 c 0.26083,-3.13648 2.85994,-5.60316 6.06083,-5.60316 h 12.17722 v -12.21988 c 0,-3.37478 2.73516,-6.11477 6.10994,-6.11477 h 3.05598 c 3.37518,0 6.11115,2.74039 6.11115,6.11477 v 12.21988 h 12.22431 c 3.20249,0 5.79758,2.47151 6.06244,5.60316 z"
          inkscape:connector-curvature="0"
          style="fill:#ffffff" />
       <path
          id="path8222-90-7"
          d="M 191.70061,-44.405879 H 76.870013 c -2.063349,0 -3.732221,1.67169 -3.732221,3.733428 v 33.93777 c 0,2.061738 1.668872,3.7322207 3.732221,3.7322207 H 191.70101 c 2.06536,0 3.73262,-1.6704827 3.73262,-3.7322207 v -33.935354 c 0,-2.064154 -1.66766,-3.735844 -3.73302,-3.735844 z M 134.28632,-14.85846 H 85.27395 v -19.604625 h 49.01237 V -14.85846 z M 191.70061,5.6598986 H 76.870013 c -2.063349,0 -3.732221,1.6704828 -3.732221,3.7322208 V 43.331097 c 0,2.062945 1.668872,3.734636 3.732221,3.734636 H 191.70101 c 2.06536,0 3.73262,-1.671691 3.73262,-3.734636 V 9.3921194 c 0,-2.061738 -1.66766,-3.7322208 -3.73302,-3.7322208 z M 134.28632,34.701745 H 85.27395 V 15.096717 h 49.01237 v 19.605028 z m 57.41429,20.538887 H 76.870013 c -2.063349,0 -3.732221,1.674106 -3.732221,3.735844 v 33.93777 c 0,2.061335 1.668872,3.731013 3.732221,3.731013 H 191.70101 c 2.06536,0 3.73262,-1.669275 3.73262,-3.731013 v -33.93777 c 0,-2.061738 -1.66766,-3.735844 -3.73302,-3.735844 z M 134.28632,85.747271 H 85.27395 V 66.143853 h 49.01237 v 19.603418 z m 25.89932,45.955179 h 29.29383 v 5.34837 h -29.24633 v 0.25077 c 0,3.3792 -2.73557,6.11437 -6.11034,6.11437 h -39.6786 c -3.37437,0 -6.11276,-2.73557 -6.11276,-6.11437 v -0.25077 H 79.088736 v -5.34837 h 29.295034 c 0.26084,-3.13648 2.85995,-5.60316 6.06083,-5.60316 h 12.17722 v -12.21988 c 0,-3.37478 2.73516,-6.11477 6.10994,-6.11477 h 3.05598 c 3.37518,0 6.11115,2.74039 6.11115,6.11477 v 12.21988 h 12.22431 c 3.2025,0 5.79758,2.47151 6.06244,5.60316 z"
          inkscape:connector-curvature="0"
          style="fill:#ffffff" />
       <g
          style="fill:#ffffff"
          id="g8224-3-3"
          transform="matrix(0.40252597,0,0,0.40252597,40.374593,-44.405879)" />
       <g
          style="fill:#ffffff"
          id="g8226-0-4"
          transform="matrix(0.40252597,0,0,0.40252597,40.374593,-44.405879)" />
       <g
          style="fill:#ffffff"
          id="g8228-3-0"
          transform="matrix(0.40252597,0,0,0.40252597,40.374593,-44.405879)" />
       <g
          style="fill:#ffffff"
          id="g8230-50-8"
          transform="matrix(0.40252597,0,0,0.40252597,40.374593,-44.405879)" />
       <g
          style="fill:#ffffff"
          id="g8232-7-8"
          transform="matrix(0.40252597,0,0,0.40252597,40.374593,-44.405879)" />
       <g
          style="fill:#ffffff"
          id="g8234-6-1"
          transform="matrix(0.40252597,0,0,0.40252597,40.374593,-44.405879)" />
       <g
          style="fill:#ffffff"
          id="g8236-7-5"
          transform="matrix(0.40252597,0,0,0.40252597,40.374593,-44.405879)" />
       <g
          style="fill:#ffffff"
          id="g8238-83-2"
          transform="matrix(0.40252597,0,0,0.40252597,40.374593,-44.405879)" />
       <g
          style="fill:#ffffff"
          id="g8240-6-3"
          transform="matrix(0.40252597,0,0,0.40252597,40.374593,-44.405879)" />
       <g
          style="fill:#ffffff"
          id="g8242-4-2"
          transform="matrix(0.40252597,0,0,0.40252597,40.374593,-44.405879)" />
       <g
          style="fill:#ffffff"
          id="g8244-4-4"
          transform="matrix(0.40252597,0,0,0.40252597,40.374593,-44.405879)" />
       <g
          style="fill:#ffffff"
          id="g8246-1-6"
          transform="matrix(0.40252597,0,0,0.40252597,40.374593,-44.405879)" />
       <g
          style="fill:#ffffff"
          id="g8248-9-6"
          transform="matrix(0.40252597,0,0,0.40252597,40.374593,-44.405879)" />
       <g
          style="fill:#ffffff"
          id="g8250-5-6"
          transform="matrix(0.40252597,0,0,0.40252597,40.374593,-44.405879)" />
       <g
          style="fill:#ffffff"
          id="g8252-5-2"
          transform="matrix(0.40252597,0,0,0.40252597,40.374593,-44.405879)" />
       <path
          id="path8222-90-4"
          d="M 183.12918,244.16555 H 68.298585 c -2.063349,0 -3.732221,1.67169 -3.732221,3.73343 v 33.93777 c 0,2.06174 1.668872,3.73222 3.732221,3.73222 H 183.12958 c 2.06536,0 3.73263,-1.67048 3.73263,-3.73222 v -33.93536 c 0,-2.06415 -1.66767,-3.73584 -3.73303,-3.73584 z m -57.41429,29.54742 H 76.702522 v -19.60463 h 49.012368 v 19.60463 z m 57.41429,20.51836 H 68.298585 c -2.063349,0 -3.732221,1.67048 -3.732221,3.73222 v 33.93898 c 0,2.06294 1.668872,3.73463 3.732221,3.73463 H 183.12958 c 2.06536,0 3.73263,-1.67169 3.73263,-3.73463 v -33.93898 c 0,-2.06174 -1.66767,-3.73222 -3.73303,-3.73222 z m -57.41429,29.04184 H 76.702522 v -19.60502 h 49.012368 v 19.60502 z m 57.41429,20.53889 H 68.298585 c -2.063349,0 -3.732221,1.67411 -3.732221,3.73584 v 33.93777 c 0,2.06134 1.668872,3.73102 3.732221,3.73102 H 183.12958 c 2.06536,0 3.73263,-1.66928 3.73263,-3.73102 V 347.5479 c 0,-2.06173 -1.66767,-3.73584 -3.73303,-3.73584 z M 125.71489,374.3187 H 76.702522 v -19.60342 h 49.012368 v 19.60342 z m 25.89932,45.95518 h 29.29383 v 5.34836 h -29.24633 v 0.25078 c 0,3.3792 -2.73556,6.11437 -6.11034,6.11437 h -39.6786 c -3.37437,0 -6.112756,-2.73557 -6.112756,-6.11437 v -0.25078 H 70.517308 v -5.34836 h 29.295035 c 0.260837,-3.13648 2.859947,-5.60316 6.060837,-5.60316 h 12.17721 v -12.21988 c 0,-3.37478 2.73517,-6.11477 6.10994,-6.11477 h 3.05598 c 3.37518,0 6.11115,2.74039 6.11115,6.11477 v 12.21988 h 12.22431 c 3.2025,0 5.79758,2.47151 6.06244,5.60316 z"
          inkscape:connector-curvature="0"
          style="fill:#ffffff" />
       <path
          id="path8222-90-3"
          d="M 174.55775,549.87984 H 59.727153 c -2.063349,0 -3.732221,1.67169 -3.732221,3.73343 v 33.93777 c 0,2.06174 1.668872,3.73222 3.732221,3.73222 H 174.55815 c 2.06536,0 3.73262,-1.67048 3.73262,-3.73222 v -33.93536 c 0,-2.06415 -1.66766,-3.73584 -3.73302,-3.73584 z m -57.41429,29.54742 H 68.13109 v -19.60463 h 49.01237 v 19.60463 z m 57.41429,20.51836 H 59.727153 c -2.063349,0 -3.732221,1.67048 -3.732221,3.73222 v 33.93898 c 0,2.06294 1.668872,3.73463 3.732221,3.73463 H 174.55815 c 2.06536,0 3.73262,-1.67169 3.73262,-3.73463 v -33.93898 c 0,-2.06174 -1.66766,-3.73222 -3.73302,-3.73222 z m -57.41429,29.04184 H 68.13109 v -19.60502 h 49.01237 v 19.60502 z m 57.41429,20.53889 H 59.727153 c -2.063349,0 -3.732221,1.67411 -3.732221,3.73584 v 33.93777 c 0,2.06134 1.668872,3.73102 3.732221,3.73102 H 174.55815 c 2.06536,0 3.73262,-1.66928 3.73262,-3.73102 v -33.93777 c 0,-2.06173 -1.66766,-3.73584 -3.73302,-3.73584 z m -57.41429,30.50664 H 68.13109 v -19.60342 h 49.01237 v 19.60342 z m 25.89932,45.95518 h 29.29383 v 5.34836 h -29.24633 v 0.25078 c 0,3.3792 -2.73557,6.11437 -6.11034,6.11437 H 97.301342 c -3.374375,0 -6.11276,-2.73557 -6.11276,-6.11437 v -0.25078 H 61.945876 v -5.34836 h 29.295035 c 0.260837,-3.13648 2.859947,-5.60316 6.060833,-5.60316 h 12.177216 v -12.21988 c 0,-3.37478 2.73516,-6.11477 6.10994,-6.11477 h 3.05598 c 3.37518,0 6.11115,2.74039 6.11115,6.11477 v 12.21988 h 12.22431 c 3.2025,0 5.79758,2.47151 6.06244,5.60316 z"
          inkscape:connector-curvature="0"
          style="fill:#ffffff" />
       <path
          id="path8222-90-39"
          d="M 183.12918,889.87983 H 68.298584 c -2.063349,0 -3.732221,1.67169 -3.732221,3.73343 v 33.93777 c 0,2.06174 1.668872,3.73222 3.732221,3.73222 H 183.12958 c 2.06536,0 3.73263,-1.67048 3.73263,-3.73222 v -33.93536 c 0,-2.06415 -1.66767,-3.73584 -3.73303,-3.73584 z m -57.41429,29.54742 H 76.702521 v -19.60463 h 49.012369 v 19.60463 z m 57.41429,20.51836 H 68.298584 c -2.063349,0 -3.732221,1.67048 -3.732221,3.73222 v 33.93898 c 0,2.06294 1.668872,3.73463 3.732221,3.73463 H 183.12958 c 2.06536,0 3.73263,-1.67169 3.73263,-3.73463 v -33.93898 c 0,-2.06174 -1.66767,-3.73222 -3.73303,-3.73222 z m -57.41429,29.04184 H 76.702521 v -19.60502 h 49.012369 v 19.60502 z m 57.41429,20.53889 H 68.298584 c -2.063349,0 -3.732221,1.67411 -3.732221,3.73584 V 1027.2 c 0,2.0613 1.668872,3.731 3.732221,3.731 H 183.12958 c 2.06536,0 3.73263,-1.6693 3.73263,-3.731 v -33.93782 c 0,-2.06173 -1.66767,-3.73584 -3.73303,-3.73584 z M 125.71489,1020.033 H 76.702521 v -19.6034 h 49.012369 v 19.6034 z m 25.89932,45.9552 h 29.29383 v 5.3483 h -29.24633 v 0.2508 c 0,3.3792 -2.73556,6.1144 -6.11034,6.1144 h -39.6786 c -3.37437,0 -6.112757,-2.7356 -6.112757,-6.1144 v -0.2508 H 70.517307 v -5.3483 h 29.295035 c 0.260838,-3.1365 2.859948,-5.6032 6.060838,-5.6032 h 12.17721 v -12.2199 c 0,-3.3748 2.73516,-6.1148 6.10994,-6.1148 h 3.05598 c 3.37518,0 6.11115,2.7404 6.11115,6.1148 v 12.2199 h 12.22431 c 3.2025,0 5.79758,2.4715 6.06244,5.6032 z"
          inkscape:connector-curvature="0"
          style="fill:#ffffff" />
       <path
          id="path8222-90-38"
          d="m 603.12919,138.45126 h -114.8306 c -2.06335,0 -3.73222,1.67169 -3.73222,3.73343 v 33.93777 c 0,2.06174 1.66887,3.73222 3.73222,3.73222 h 114.831 c 2.06536,0 3.73262,-1.67048 3.73262,-3.73222 V 142.1871 c 0,-2.06415 -1.66766,-3.73584 -3.73302,-3.73584 z m -57.4143,29.54742 h -49.01236 v -19.60463 h 49.01236 v 19.60463 z m 57.4143,20.51836 h -114.8306 c -2.06335,0 -3.73222,1.67048 -3.73222,3.73222 v 33.93898 c 0,2.06294 1.66887,3.73463 3.73222,3.73463 h 114.831 c 2.06536,0 3.73262,-1.67169 3.73262,-3.73463 v -33.93898 c 0,-2.06174 -1.66766,-3.73222 -3.73302,-3.73222 z m -57.4143,29.04184 h -49.01236 v -19.60502 h 49.01236 v 19.60502 z m 57.4143,20.53889 h -114.8306 c -2.06335,0 -3.73222,1.67411 -3.73222,3.73584 v 33.93777 c 0,2.06134 1.66887,3.73102 3.73222,3.73102 h 114.831 c 2.06536,0 3.73262,-1.66928 3.73262,-3.73102 v -33.93777 c 0,-2.06173 -1.66766,-3.73584 -3.73302,-3.73584 z m -57.4143,30.50664 h -49.01236 v -19.60342 h 49.01236 v 19.60342 z m 25.89933,45.95518 h 29.29383 v 5.34836 h -29.24633 v 0.25078 c 0,3.3792 -2.73557,6.11437 -6.11035,6.11437 h -39.67859 c -3.37438,0 -6.11276,-2.73557 -6.11276,-6.11437 v -0.25078 h -29.24271 v -5.34836 h 29.29504 c 0.26083,-3.13648 2.85994,-5.60316 6.06083,-5.60316 h 12.17722 v -12.21988 c 0,-3.37478 2.73516,-6.11477 6.10994,-6.11477 h 3.05598 c 3.37518,0 6.11115,2.74039 6.11115,6.11477 v 12.21988 h 12.22431 c 3.20249,0 5.79758,2.47151 6.06244,5.60316 z"
          inkscape:connector-curvature="0"
          style="fill:#ffffff" />
       <path
          id="path8222-90-8"
          d="m 603.12919,404.16555 h -114.8306 c -2.06335,0 -3.73222,1.67169 -3.73222,3.73343 v 33.93777 c 0,2.06174 1.66887,3.73222 3.73222,3.73222 h 114.831 c 2.06536,0 3.73262,-1.67048 3.73262,-3.73222 v -33.93536 c 0,-2.06415 -1.66766,-3.73584 -3.73302,-3.73584 z m -57.4143,29.54742 h -49.01236 v -19.60463 h 49.01236 v 19.60463 z m 57.4143,20.51836 h -114.8306 c -2.06335,0 -3.73222,1.67048 -3.73222,3.73222 v 33.93898 c 0,2.06294 1.66887,3.73463 3.73222,3.73463 h 114.831 c 2.06536,0 3.73262,-1.67169 3.73262,-3.73463 v -33.93898 c 0,-2.06174 -1.66766,-3.73222 -3.73302,-3.73222 z m -57.4143,29.04184 h -49.01236 v -19.60502 h 49.01236 v 19.60502 z m 57.4143,20.53889 h -114.8306 c -2.06335,0 -3.73222,1.67411 -3.73222,3.73584 v 33.93777 c 0,2.06134 1.66887,3.73102 3.73222,3.73102 h 114.831 c 2.06536,0 3.73262,-1.66928 3.73262,-3.73102 V 507.5479 c 0,-2.06173 -1.66766,-3.73584 -3.73302,-3.73584 z m -57.4143,30.50664 h -49.01236 v -19.60342 h 49.01236 v 19.60342 z m 25.89933,45.95518 h 29.29383 v 5.34836 h -29.24633 v 0.25078 c 0,3.3792 -2.73557,6.11437 -6.11035,6.11437 h -39.67859 c -3.37438,0 -6.11276,-2.73557 -6.11276,-6.11437 v -0.25078 h -29.24271 v -5.34836 h 29.29504 c 0.26083,-3.13648 2.85994,-5.60316 6.06083,-5.60316 h 12.17722 v -12.21988 c 0,-3.37478 2.73516,-6.11477 6.10994,-6.11477 h 3.05598 c 3.37518,0 6.11115,2.74039 6.11115,6.11477 v 12.21988 h 12.22431 c 3.20249,0 5.79758,2.47151 6.06244,5.60316 z"
          inkscape:connector-curvature="0"
          style="fill:#ffffff" />
       <path
          id="path8222-90-2"
          d="m 603.12919,675.59412 h -114.8306 c -2.06335,0 -3.73222,1.67169 -3.73222,3.73343 v 33.93777 c 0,2.06174 1.66887,3.73222 3.73222,3.73222 h 114.831 c 2.06536,0 3.73262,-1.67048 3.73262,-3.73222 v -33.93536 c 0,-2.06415 -1.66766,-3.73584 -3.73302,-3.73584 z m -57.4143,29.54742 h -49.01236 v -19.60463 h 49.01236 v 19.60463 z m 57.4143,20.51836 h -114.8306 c -2.06335,0 -3.73222,1.67048 -3.73222,3.73222 v 33.93898 c 0,2.06294 1.66887,3.73463 3.73222,3.73463 h 114.831 c 2.06536,0 3.73262,-1.67169 3.73262,-3.73463 v -33.93898 c 0,-2.06174 -1.66766,-3.73222 -3.73302,-3.73222 z m -57.4143,29.04184 h -49.01236 v -19.60502 h 49.01236 v 19.60502 z m 57.4143,20.53889 h -114.8306 c -2.06335,0 -3.73222,1.67411 -3.73222,3.73584 v 33.93777 c 0,2.06134 1.66887,3.73102 3.73222,3.73102 h 114.831 c 2.06536,0 3.73262,-1.66928 3.73262,-3.73102 v -33.93777 c 0,-2.06173 -1.66766,-3.73584 -3.73302,-3.73584 z m -57.4143,30.50664 h -49.01236 v -19.60342 h 49.01236 v 19.60342 z m 25.89933,45.95518 h 29.29383 v 5.34836 h -29.24633 v 0.25078 c 0,3.3792 -2.73557,6.11437 -6.11035,6.11437 h -39.67859 c -3.37438,0 -6.11276,-2.73557 -6.11276,-6.11437 v -0.25078 h -29.24271 v -5.34836 h 29.29504 c 0.26083,-3.13648 2.85994,-5.60316 6.06083,-5.60316 h 12.17722 v -12.21988 c 0,-3.37478 2.73516,-6.11477 6.10994,-6.11477 h 3.05598 c 3.37518,0 6.11115,2.74039 6.11115,6.11477 v 12.21988 h 12.22431 c 3.20249,0 5.79758,2.47151 6.06244,5.60316 z"
          inkscape:connector-curvature="0"
          style="fill:#ffffff" />
       <path
          style="fill:none;stroke:#ffffff;stroke-width:5;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
          d="M -605.71457,586.64818 -339.19506,367.78404"
          id="path8901"
          inkscape:connector-curvature="0" />
       <path
          style="fill:none;stroke:#ffffff;stroke-width:5;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
          d="M -232.62393,367.1089 72.821982,1070.2735"
          id="path8903"
          inkscape:connector-curvature="0" />
       <path
          style="fill:none;stroke:#ffffff;stroke-width:5;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
          d="M 178.42094,1070.3735 492.84919,315.40803"
          id="path8905"
          inkscape:connector-curvature="0" />
       <path
          style="fill:none;stroke:#ffffff;stroke-width:5;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
          d="M 598.64615,315.96501 814.29764,589.51697"
          id="path8907"
          inkscape:connector-curvature="0" />
       <text
          xml:space="preserve"
          style="font-size:40px;font-style:normal;font-weight:normal;line-height:125%;letter-spacing:0px;word-spacing:0px;fill:#ffffff;fill-opacity:1;stroke:none;font-family:Segoe UI;-inkscape-font-specification:Segoe UI;font-stretch:normal;font-variant:normal"
          x="-840.00891"
          y="1171.5078"
          id="text9491"
          sodipodi:linespacing="125%"><tspan
            sodipodi:role="line"
            x="-840.00891"
            y="1171.5078"
            id="tspan9493"><tspan
              x="-840.00891"
              y="1171.5078"
              id="tspan9495"
              style="-inkscape-font-specification:Segoe UI;font-family:Segoe UI;font-weight:normal;font-style:normal;font-stretch:normal;font-variant:normal;fill:#ffffff">Client</tspan></tspan></text>
       <text
          xml:space="preserve"
          style="font-size:40px;font-style:normal;font-weight:normal;line-height:125%;letter-spacing:0px;word-spacing:0px;fill:#ffffff;fill-opacity:1;stroke:none;font-family:Segoe UI;-inkscape-font-specification:Segoe UI;font-stretch:normal;font-variant:normal"
          x="-411.45981"
          y="1177.25"
          id="text9497"
          sodipodi:linespacing="125%"><tspan
            sodipodi:role="line"
            x="-411.45981"
            y="1177.25"
            id="tspan9499"><tspan
              x="-411.45981"
              y="1177.25"
              id="tspan9501"
              style="-inkscape-font-specification:Segoe UI;font-family:Segoe UI;font-weight:normal;font-style:normal;font-stretch:normal;font-variant:normal;fill:#ffffff">Guard Relay</tspan></tspan></text>
       <text
          xml:space="preserve"
          style="font-size:40px;font-style:normal;font-weight:normal;line-height:125%;letter-spacing:0px;word-spacing:0px;fill:#ffffff;fill-opacity:1;stroke:none;font-family:Segoe UI;-inkscape-font-specification:Segoe UI;font-stretch:normal;font-variant:normal"
          x="2.2544701"
          y="1178.1072"
          id="text9503"
          sodipodi:linespacing="125%"><tspan
            sodipodi:role="line"
            x="2.2544701"
            y="1178.1072"
            id="tspan9505"><tspan
              x="2.2544701"
              y="1178.1072"
              id="tspan9507"
              style="-inkscape-font-specification:Segoe UI;font-family:Segoe UI;font-weight:normal;font-style:normal;font-stretch:normal;font-variant:normal;fill:#ffffff">Middle Relay</tspan></tspan></text>
       <text
          xml:space="preserve"
          style="font-size:40px;font-style:normal;font-weight:normal;line-height:125%;letter-spacing:0px;word-spacing:0px;fill:#ffffff;fill-opacity:1;stroke:none;font-family:Segoe UI;-inkscape-font-specification:Segoe UI;font-stretch:normal;font-variant:normal"
          x="462.25449"
          y="1183.8215"
          id="text9509"
          sodipodi:linespacing="125%"><tspan
            sodipodi:role="line"
            x="462.25449"
            y="1183.8215"
            id="tspan9511"><tspan
              x="462.25449"
              y="1183.8215"
              id="tspan9513"
              style="-inkscape-font-specification:Segoe UI;font-family:Segoe UI;font-weight:normal;font-style:normal;font-stretch:normal;font-variant:normal;fill:#ffffff">Exit Relay</tspan></tspan></text>
       <text
          xml:space="preserve"
          style="font-size:40px;font-style:normal;font-weight:normal;line-height:125%;letter-spacing:0px;word-spacing:0px;fill:#ffffff;fill-opacity:1;stroke:none;font-family:Segoe UI;-inkscape-font-specification:Segoe UI;font-stretch:normal;font-variant:normal"
          x="856.54022"
          y="1189.5358"
          id="text9515"
          sodipodi:linespacing="125%"><tspan
            sodipodi:role="line"
            x="856.54022"
            y="1189.5358"
            id="tspan9517"><tspan
              x="856.54022"
              y="1189.5358"
              id="tspan9519"
              style="-inkscape-font-specification:Segoe UI;font-family:Segoe UI;font-weight:normal;font-style:normal;font-stretch:normal;font-variant:normal;fill:#ffffff">Desination</tspan></tspan></text>
     </g>
   </svg>
</div>


<br/>


<ul>
<li><p><strong>Entry/Guard Relay</strong> &ndash; This is the entry point to the Tor network. Relays are selected to serve as guard relays after being around for a while, as well as having shown to be stable and having high bandwidth.<sup><a href="https://blog.torproject.org/blog/lifecycle-of-a-new-relay">1</a></sup></p></li>
<li><p><strong>Middle Relay</strong> &ndash; Middle relays are exactly that &ndash; middle nodes used to transport traffic from the guard relay to the exit relay. This prevents the guard and exit relay from knowing each other.</p></li>
<li><p><strong>Exit Relay</strong> &ndash; These relays are the exit point at the edge of the Tor network. These relays send traffic to the final destination intended by the client.</p></li>
</ul>


<p>Generally, it is safe to run a guard or middle relay on any VPS or shared server (such as  <a href="https://www.digitalocean.com/?refcode=2895d5b6c219">DigitalOcean</a> or <a href="https://aws.amazon.com/ec2/">EC2</a>), since all the server operators will see is harmless encrypted traffic (more on this later).</p>

<p>However, there are <a href="https://blog.torproject.org/blog/tips-running-exit-node-minimal-harassment">special responsibilities</a> to consider when running an exit node. Since exit relays send traffic directly to the end destination, any illicit activity done through Tor appears to come from the exit relay. This leads to the rare possibility of raids, abuse notices, or more.</p>

<p>If you meet an exit relay operator &ndash; thank them. <strong>They deserve it.</strong></p>

<h3>Why Onions?</h3>

<p>Now that we know how connections are routed through relays, how do we know we can actually <em>trust</em> relays? How can we be sure relays won&rsquo;t track who we&rsquo;re connecting to and sniff the data we send across the wire? The short answer is, <em>we don&rsquo;t have to!</em>.</p>

<p>Tor is designed to put as little trust in relays as possible. It does this through the use of <strong>encryption</strong>.</p>

<p>So what&rsquo;s the deal with all the references to onions? To answer this question, let&rsquo;s take a high-level look at how the encryption works when a client makes a connection through the Tor network.</p>

<p><span class="fa-stack fa-lg fa-1x">
<i class="fa fa-circle fa-stack-2x" style="color:#3498DB"></i>
<i class="fa fa-stack-1x" style="color:white; font-family:inherit;">1</i>
</span>
The client encrypts the original data in such a way that only the exit relay can decrypt it.</p>

<p><span class="fa-stack fa-lg fa-1x">
<i class="fa fa-circle fa-stack-2x" style="color:#3498DB"></i>
<i class="fa fa-stack-1x" style="color:white; font-family:inherit;">2</i>
</span>
This encrypted data is then encrypted again in such a way that only the middle relay can decrypt it.</p>

<p><span class="fa-stack fa-lg fa-1x">
<i class="fa fa-circle fa-stack-2x" style="color:#3498DB"></i>
<i class="fa fa-stack-1x" style="color:white; font-family:inherit;">3</i>
</span>
Finally, this encrypted data is encrypted once more in such a way that only the guard relay can decrypt it.</p>

<div style="padding:10px;background:#3498DB;border-radius:5px;">
<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   id="encryption"
   width="100%"
   height="191"
   viewBox="0 0 577 192"
   style="max-height:190px"
   onclick="s.reset().play();"
   version="1.0">
   <style
      id="style3946">
    .style0{
        fill:   none;
        stroke: #000000;
        stroke-width:   3;
        stroke-linejoin:    round;
    }
    .style1{
        fill:   none;
        stroke: #000000;
        stroke-width:   3;
    }
    .style2{
        font-size:  11.9px;
        line-height:    125%;
        letter-spacing: 0px;
        word-spacing:   0px;
        fill:   #000000;
        font-family:    Sans;
    }
    .style3{
        font-size:  11.9px;
    }
 </style>
   <metadata
      id="metadata1928">
     <rdf:RDF>
       <cc:Work
          rdf:about="">
         <dc:format>image/svg+xml</dc:format>
         <dc:type
            rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
         <dc:title></dc:title>
       </cc:Work>
     </rdf:RDF>
   </metadata>
   <defs
      id="defs1926" />
   <path
      id="path1934"
      d="m 354.4,37.8 c 12.5,0 22.9,34.2 22.9,75.7 0,41.6 -10.2,76.4 -22.7,76.4 -12.5,0 -22.7,-34.9 -22.7,-76.4 0,-41.5 9.9,-75.7 22.5,-75.7 z m 0,0 197,-0.3 c 11,0 24.3,34 24.3,75.8 0,41.9 -13,76.7 -24,76.7 l -197.2,-0.1"
      inkscape:connector-curvature="0"
      class="style0"
      style="fill:#ffffff;stroke:#4183d7;stroke-width:3;stroke-linejoin:round;fill-opacity:1;stroke-opacity:1" />
   <path
      id="path1934-1"
      d="m 292.9,56.4 c 4.6,0 8.5,25.5 8.5,56.7 0,31.1 -3.7,57.2 -8.4,57.2 -4.6,0 -8.4,-26.0 -8.4,-57.2 0,-31.1 3.7,-56.7 8.4,-56.7 z m 0,0 73.6,-0.2 c 4.1,0 9.1,25.4 9.1,56.8 0,31.3 -4.8,57.4 -8.9,57.4 l -73.6,-0.1"
      inkscape:connector-curvature="0"
      class="style0"
      style="fill:#ffffff;stroke:#4183d7;stroke-width:3;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;fill-opacity:1;stroke-opacity:1" />
   <path
      id="path1934-1-7"
      d="m 254.9,82.9 c 2.6,0 4.9,14.9 4.9,33.3 0,18.2 -2.1,33.6 -4.8,33.6 -2.6,0 -4.8,-15.2 -4.8,-33.6 0,-18.2 2.1,-33.3 4.8,-33.3 z m 0,0 42.3,-0.1 c 2.3,0 5.2,14.9 5.2,33.3 0,18.4 -2.7,33.7 -5.1,33.7 l -42.3,0"
      inkscape:connector-curvature="0"
      class="style0"
      style="fill:#ffffff;stroke:#4183d7;stroke-width:3;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;fill-opacity:1" />
   <path
      id="path1934-1-4"
      d="m 228.2,97.7 c 1.8,0 3.4,9.2 3.4,20.5 0,11.3 -1.5,20.7 -3.3,20.7 -1.8,0 -3.3,-9.4 -3.3,-20.7 0,-11.3 1.4,-20.5 3.3,-20.5 z m 0,0 29.4,-0.1 c 1.6,0 3.6,9.2 3.6,20.5 0,11.4 -1.9,20.7 -3.5,20.7 l -29.4,0"
      inkscape:connector-curvature="0"
      class="style0"
      style="fill:#ffffff;stroke:#4183d7;stroke-width:2.2;stroke-linejoin:round;stroke-opacity:1;fill-opacity:1" />
   <text
      xml:space="preserve"
      x="-4.7"
      y="10.2"
      id="text4004"
      style="font-size:14.0px;-inkscape-font-specification:Segoe UI;font-family:Segoe UI;font-weight:normal;font-style:normal;font-stretch:normal;font-variant:normal;fill:#ffffff"><tspan
        sodipodi:role="line"
        x="-4.7"
        y="10.2"
        id="tspan4006"
        style="font-size:12px;fill:#ffffff"><tspan
          x="-4.7"
          y="10.2"
          id="tspan4008"
          style="-inkscape-font-specification:Segoe UI;font-family:Segoe UI;font-weight:normal;font-style:normal;font-stretch:normal;font-variant:normal;font-size:12px;fill:#ffffff">Guard Relay Encryption</tspan></tspan></text>
   <text
      xml:space="preserve"
      x="-5.8"
      y="32.1"
      id="text3998"
      style="font-size:14.1px;-inkscape-font-specification:Segoe UI;font-family:Segoe UI;font-weight:normal;font-style:normal;font-stretch:normal;font-variant:normal;fill:#ffffff"><tspan
        sodipodi:role="line"
        x="-5.8"
        y="32.1"
        id="tspan4000"
        style="font-size:12px;fill:#ffffff"><tspan
          x="-5.8"
          y="32.1"
          id="tspan4002"
          style="-inkscape-font-specification:Segoe UI;font-family:Segoe UI;font-weight:normal;font-style:normal;font-stretch:normal;font-variant:normal;font-size:12px;fill:#ffffff">Middle Relay Encryption</tspan></tspan></text>
   <text
      xml:space="preserve"
      x="-5.1"
      y="52.7"
      id="text3992"
      style="font-size:14.0px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-family:Segoe UI;-inkscape-font-specification:Segoe UI;fill:#ffffff"><tspan
        sodipodi:role="line"
        x="-5.1"
        y="52.7"
        id="tspan3994"
        style="font-size:12px;fill:#ffffff"><tspan
          x="-5.1"
          y="52.7"
          id="tspan3996"
          style="font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-family:Segoe UI;-inkscape-font-specification:Segoe UI;fill:#ffffff">Exit Relay Encryption</tspan></tspan></text>
   <path
      style="fill:none;stroke:#4183d7;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
      d="m 548.4,36.3 c 0,0 41.8,75.0 0,153.5"
      id="path6775"
      inkscape:connector-curvature="0" />
   <path
      style="fill:none;stroke:#4183d7;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
      d="m 533.9,37.6 c 0,0 41.8,75.0 0,153.5"
      id="path6775-2"
      inkscape:connector-curvature="0" />
   <path
      style="fill:none;stroke:#4183d7;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
      d="m 517.8,37.7 c 0,0 41.8,75.0 0,153.5"
      id="path6775-8-4"
      inkscape:connector-curvature="0" />
   <path
      style="fill:none;stroke:#4183d7;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
      d="m 503.3,36.7 c 0,0 41.8,75.0 0,153.5"
      id="path6775-5"
      inkscape:connector-curvature="0" />
   <path
      style="fill:none;stroke:#4183d7;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
      d="m 487.1,36.8 c 0,0 41.8,75.0 0,153.5"
      id="path6775-8-2"
      inkscape:connector-curvature="0" />
   <path
      style="fill:none;stroke:#4183d7;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
      d="m 470.8,37.9 c 0,0 41.8,75.0 0,153.5"
      id="path6775-8-8"
      inkscape:connector-curvature="0" />
   <path
      style="fill:none;stroke:#4183d7;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
      d="m 451.6,39.1 c 0,0 41.8,75.0 0,153.5"
      id="path6775-8-9"
      inkscape:connector-curvature="0" />
   <path
      style="fill:none;stroke:#4183d7;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
      d="m 433.6,35.6 c 0,0 41.8,75.0 0,153.5"
      id="path6775-23"
      inkscape:connector-curvature="0" />
   <path
      style="fill:none;stroke:#4183d7;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
      d="m 414.4,36.7 c 0,0 41.8,75.0 0,153.5"
      id="path6775-62"
      inkscape:connector-curvature="0" />
   <path
      style="fill:none;stroke:#4183d7;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
      d="m 396.1,36.7 c 0,0 41.8,75.0 0,153.5"
      id="path6775-57"
      inkscape:connector-curvature="0" />
   <path
      style="fill:none;stroke:#4183d7;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
      d="m 380.0,36.8 c 0,0 41.8,75.0 0,153.5"
      id="path6775-8-827"
      inkscape:connector-curvature="0" />
   <path
      style="fill:none;stroke:#4183d7;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
      d="m 360.4,170.4 c 0,0 18.9,-42.4 0,-114.0"
      id="path6924"
      inkscape:connector-curvature="0" />
   <path
      style="fill:none;stroke:#4183d7;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
      d="m 353.0,170.9 c 0,0 18.9,-42.4 0,-114.0"
      id="path6924-0"
      inkscape:connector-curvature="0" />
   <path
      style="fill:none;stroke:#4183d7;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
      d="m 344.8,171.8 c 0,0 18.9,-42.4 0,-114.0"
      id="path6924-5"
      inkscape:connector-curvature="0" />
   <path
      style="fill:none;stroke:#4183d7;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
      d="m 336.7,170.7 c 0,0 18.9,-42.4 0,-114.0"
      id="path6924-5-5"
      inkscape:connector-curvature="0" />
   <path
      style="fill:none;stroke:#4183d7;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
      d="m 328.7,170.7 c 0,0 18.9,-42.4 0,-114.0"
      id="path6924-5-2"
      inkscape:connector-curvature="0" />
   <path
      style="fill:none;stroke:#4183d7;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
      d="m 320.1,169.6 c 0,0 18.9,-42.4 0,-114.0"
      id="path6924-5-7"
      inkscape:connector-curvature="0" />
   <path
      style="fill:none;stroke:#4183d7;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
      d="m 311.5,169.6 c 0,0 18.9,-42.4 0,-114.0"
      id="path6924-5-6"
      inkscape:connector-curvature="0" />
   <path
      style="fill:none;stroke:#4183d7;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
      d="m 303.5,171.3 c 0,0 18.9,-42.4 0,-114.0"
      id="path6924-5-78"
      inkscape:connector-curvature="0" />
   <path
      style="fill:none;stroke:#4183d7;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
      d="m 293.1,149.8 c 0,0 7.4,-30.9 0,-65.8"
      id="path7008"
      inkscape:connector-curvature="0" />
   <path
      style="fill:none;stroke:#4183d7;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
      d="m 288.8,148.9 c 0,0 7.4,-30.9 0,-65.8"
      id="path7008-7"
      inkscape:connector-curvature="0" />
   <path
      style="fill:none;stroke:#4183d7;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
      d="m 283.7,148.9 c 0,0 7.4,-30.9 0,-65.8"
      id="path7008-8"
      inkscape:connector-curvature="0" />
   <path
      style="fill:none;stroke:#4183d7;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
      d="m 278.5,149.5 c 0,0 7.4,-30.9 0,-65.8"
      id="path7008-1"
      inkscape:connector-curvature="0" />
   <path
      style="fill:none;stroke:#4183d7;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
      d="m 273.9,149.8 c 0,0 7.4,-30.9 0,-65.8"
      id="path7008-6"
      inkscape:connector-curvature="0" />
   <path
      style="fill:none;stroke:#4183d7;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
      d="m 268.8,148.6 c 0,0 7.4,-30.9 0,-65.8"
      id="path7008-0"
      inkscape:connector-curvature="0" />
   <path
      style="fill:none;stroke:#4183d7;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
      d="m 263.3,148.9 c 0,0 7.4,-30.9 0,-65.8"
      id="path7008-9"
      inkscape:connector-curvature="0" />
   <path
      style="fill:none;stroke:#4183d7;stroke-width:0.7;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
      d="m 254.8,97.7 c 0,0 8.0,17.9 0,41.2"
      id="path7074"
      inkscape:connector-curvature="0" />
   <path
      style="fill:none;stroke:#4183d7;stroke-width:0.7;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
      d="m 252.7,97.9 c 0,0 8.0,17.9 0,41.2"
      id="path7074-8"
      inkscape:connector-curvature="0" />
   <path
      style="fill:none;stroke:#4183d7;stroke-width:0.7;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
      d="m 250.6,97.4 c 0,0 8.0,17.9 0,41.2"
      id="path7074-9"
      inkscape:connector-curvature="0" />
   <path
      style="fill:none;stroke:#4183d7;stroke-width:0.7;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
      d="m 248.6,96.8 c 0,0 8.0,17.9 0,41.2"
      id="path7074-0"
      inkscape:connector-curvature="0" />
   <path
      style="fill:none;stroke:#4183d7;stroke-width:0.7;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
      d="m 246.1,97.2 c 0,0 8.0,17.9 0,41.2"
      id="path7074-00"
      inkscape:connector-curvature="0" />
   <path
      style="fill:none;stroke:#4183d7;stroke-width:0.7;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
      d="m 243.6,98.2 c 0,0 8.0,17.9 0,41.2"
      id="path7074-7"
      inkscape:connector-curvature="0" />
   <path
      style="fill:none;stroke:#4183d7;stroke-width:0.7;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
      d="m 241.1,98.1 c 0,0 8.0,17.9 0,41.2"
      id="path7074-2"
      inkscape:connector-curvature="0" />
   <path
      style="fill:none;stroke:#4183d7;stroke-width:0.7;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
      d="m 238.7,97.9 c 0,0 8.0,17.9 0,41.2"
      id="path7074-5"
      inkscape:connector-curvature="0" />
   <path
      style="fill:none;stroke:#4183d7;stroke-width:0.7;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
      d="m 236.3,97.2 c 0,0 8.0,17.9 0,41.2"
      id="path7074-52"
      inkscape:connector-curvature="0" />
   <path
      style="fill:none;stroke:#4183d7;stroke-width:0.7;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
      d="m 233.8,98.2 c 0,0 8.0,17.9 0,41.2"
      id="path7074-1"
      inkscape:connector-curvature="0" />
   <path
      style="fill:none;stroke:#4183d7;stroke-width:0.7;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
      d="m 231.5,98.2 c 0,0 8.0,17.9 0,41.2"
      id="path7074-4"
      inkscape:connector-curvature="0" />
   <path
      style="fill:none;stroke:#ffffff;stroke-width:2;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;stroke-miterlimit:4;stroke-dasharray:none"
      d="m 345.5,37.5 -153.5,0 -51.4,-29.7"
      id="path7159"
      inkscape:connector-curvature="0" />
   <path
      style="fill:none;stroke:#ffffff;stroke-width:2;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;stroke-miterlimit:4;stroke-dasharray:none"
      d="m 287.0,56.4 -98.3,0 -49.3,-28.2"
      id="path7161"
      inkscape:connector-curvature="0" />
   <path
      style="fill:none;stroke:#ffffff;stroke-width:2;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
      d="m 248.7,82.2 -57.3,0 -53.0,-28.3"
      id="path7163"
      inkscape:connector-curvature="0" />
   <path
      style="fill:none;stroke:#ffffff;stroke-width:2;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;stroke-miterlimit:4;stroke-dasharray:none"
      d="m 221.7,117.7 -33.2,0 -55.3,-31.9"
      id="path7165"
      inkscape:connector-curvature="0" />
   <text
      xml:space="preserve"
      x="-5.1"
      y="80.6"
      id="text3992-8"
      style="font-size:14.0px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;fill:#ffffff;font-family:Segoe UI;-inkscape-font-specification:Segoe UI"><tspan
        sodipodi:role="line"
        x="-5.1"
        y="80.6"
        id="tspan3994-6"
        style="font-size:12px;fill:#ffffff">Original Data</tspan></text>
 </svg>
       </div>


<br/>


<p>This means that we have wrapped our original data in layers of encryption, much like an onion is wrapped in layers of&hellip;well, more onion, I guess.</p>

<p>By doing this, each relay only has the information it needs to know &ndash; where it got the encrypted data from, and where to send it to next. Encrypting data this way is beneficial to both parties: client traffic isn&rsquo;t compromised and relays can&rsquo;t be held liable for data they can&rsquo;t see.</p>

<blockquote><p>Note: It&rsquo;s important to remember that exit relays <strong>can see the original data sent by the client</strong>, since they have to pass that data to the destination. This means that, if credentials are passed over HTTP, FTP, or other cleartext protocols, the exit relays can sniff the traffic!</p></blockquote>

<h3>Next Steps</h3>

<p>Our journey into the operation of Tor is just beginning. In future posts, we&rsquo;ll take a look at how the Tor network is organized, discuss the differences between relays and bridges, take a deep-dive into how exactly the encryption works, take a step-by-step view of what happens behind the scenes when you start up your Tor client for the first time, and more.</p>

<p>We have a lot to cover! Until then, feel free to read up on the official <a href="https://gitweb.torproject.org/torspec.git/tree/">Tor specifications</a>.</p>

<p>As always, please let me know if you have any questions or comments below!</p>

<p>-Jordan (<a href="https://twitter.com/jw_sec">@jw_sec</a>)</p>

<p><em>Update: <a href="/blog/2015/05/09/how-tor-works-part-two-relays-vs-bridges/">Part two &ndash; &ldquo;Relays vs. Bridges&rdquo;</a> has been published!</em></p>

<div>
<script>
d= new Vivus('earth', {type: 'oneByOne', duration: 30, start: 'inViewport', forceRender: false, dashGap: 20});
s= new Vivus('encryption', {type: 'async', duration: 30, start: 'inViewport', forceRender: false, dashGap: 20});
e= new Vivus('network', {type: 'oneByOne', duration: 30, start: 'inViewport', forceRender: false, dashGap: 20});
</script>
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[What Happens if Tor Directory Authorities are Seized?]]></title>
    <link href="http://jordan-wright.github.io/blog/2014/12/19/what-happens-if-tor-directory-authorities-are-seized/"/>
    <updated>2014-12-19T18:43:00-06:00</updated>
    <id>http://jordan-wright.github.io/blog/2014/12/19/what-happens-if-tor-directory-authorities-are-seized</id>
    <content type="html"><![CDATA[<p><img src="/images/headers/tor_seized.png"/></p>

<h3>Introduction</h3>

<p>The Tor Project <a href="https://blog.torproject.org/blog/possible-upcoming-attempts-disable-tor-network">has announced</a> that they have received threats about possible upcoming attempts to disable the Tor network through the seizure of Directory Authority (DA) servers. While we don&rsquo;t know the legitimacy behind these threats, it&rsquo;s worth looking at the role DA&rsquo;s play in the Tor network, showing what effects their seizure could have on the Tor network.*</p>

<!--more-->


<h3>What are Directory Authorities?</h3>

<p>Simply put, think of the DA servers as the trusted providers of a phonebook. This phonebook &ndash; called the <em>consensus</em> &ndash; contains the complete information about each known Tor relay, and is updated every hour. When it&rsquo;s time to update the list, a majority of the directory authorities must agree on the accuracy of the new list by cryptographically signing the proposed consensus. Once this process is complete, clients are able to download the updated list of relays.</p>

<p>There are currently 10 DA&rsquo;s whose information is <a href="https://gitweb.torproject.org/tor.git/tree/src/or/config.c#n824">hardcoded into Tor clients</a> &ndash; one of which (Tonga) is used for bridge access. This means that, to keep the network updated and stable, <strong>5 DA&rsquo;s must still be operational</strong>. If a seizure attempt is able to take down 5 or more DA&rsquo;s, the network will enter an unstable state, and the integrity of any updates to the consensus cannot be guaranteed.</p>

<h3>Where are the DA&rsquo;s Located?</h3>

<p>The seizure of 5 or more DA&rsquo;s would be a large feat, but it is absolutely possible. As one commenter on HN <a href="https://news.ycombinator.com/item?id=8775028">mentioned</a>, it would only take a joint effort by the US and Germany to take down 5 DA servers. Another <a href="https://news.ycombinator.com/item?id=8775009">comment</a> provides the geolocation and organization of each DA.</p>

<h3>The Aftermath</h3>

<p>An attack seizing the DA servers would severely cripple the Tor network. The Tor Project would not only need to replace the DA servers, but would then need to introduce a client update with the new DA information. During this time, the integrity of the consensus could not be trusted, and it would be <a href="https://blog.torproject.org/blog/possible-upcoming-attempts-disable-tor-network#comment-83762">increasingly difficult</a> for new clients to be introduced into the Tor network.</p>

<h3>This Doesn&rsquo;t Solve the Problem</h3>

<p>It&rsquo;s important to note that severing the Tor network doesn&rsquo;t solve any problem. Tor provides an invaluable escape from censorship, and the means to having privacy from otherwise prying eyes. I&rsquo;m confident that the Tor Project will be resilient in recovering from any attempted takedown attempts.</p>

<h3>More Information</h3>

<p>Further information and detailed status (obtained from the updated consensus) about each of the Tor Directory Authorities can be found at the following links:</p>

<ul>
<li><a href="https://globe.torproject.org/#/relay/CF6D0AAFB385BE71B8E111FC5CFF4B47923733BC">Faravahar &ndash; 154.35.32.5:443</a></li>
<li><a href="https://globe.torproject.org/#/relay/0AD3FA884D18F89EEA2D89C019379E0E7FD94417">urras &ndash; 208.83.223.34:80</a></li>
<li><a href="https://globe.torproject.org/#/relay/7BE683E65D48141321C5ED92F075C55364AC7123">dannenberg &ndash; 193.23.244.244:443</a></li>
<li><a href="https://globe.torproject.org/#/relay/4A0CCD2DDC7995083D73F5D667100C8A5831F16D">Tonga (<strong>bridge DA</strong>) &ndash; 82.94.251.203:443</a></li>
<li><a href="https://globe.torproject.org/#/relay/9695DFC35FFEB861329B9F1AB04C46397020CE31">moria1 &ndash; 128.31.0.34:9101</a></li>
<li><a href="https://globe.torproject.org/#/relay/BD6A829255CB08E66FBE7D3748363586E46B3810">maatuska &ndash; 171.25.193.9:80</a></li>
<li><a href="https://globe.torproject.org/#/relay/F2044413DAC2E02E3D6BCF4735A19BCA1DE97281">gabelmoo &ndash; 131.188.40.189:443</a></li>
<li><a href="https://globe.torproject.org/#/relay/7EA6EAD6FD83083C538F44038BBFA077587DD755">dizum &ndash; 194.109.206.212:443</a></li>
<li><a href="https://globe.torproject.org/#/relay/74A910646BCEEFBCD2E874FC1DC997430F968145">longclaw &ndash; 199.254.238.52:443</a></li>
<li><a href="https://globe.torproject.org/#/relay/847B1F850344D7876491A54892F904934E4EB85D">tor26 &ndash; 86.59.21.38:443</a></li>
</ul>


<p>Information regarding any updates to this situation can be found on the <a href="https://blog.torproject.org/blog/">Tor Project blog</a>.</p>

<p>As always, let me know if you have any questions or comments below!</p>

<p>-Jordan (<a href="http://twitter.com/jw_sec">@jw_sec</a>)</p>

<p><em>*It is worth noting that I am by no means a Tor expert, and am relying on knowledge gained from <a href="/blog/2014/10/06/creating-tor-hidden-services-with-python/">previous</a> <a href="http://raidersec.blogspot.com/2013/09/mapping-tor-relays-and-exit-nodes.html">research</a> into the Tor network structure.</em></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Creating Tor Hidden Services with Python]]></title>
    <link href="http://jordan-wright.github.io/blog/2014/10/06/creating-tor-hidden-services-with-python/"/>
    <updated>2014-10-06T20:00:00-05:00</updated>
    <id>http://jordan-wright.github.io/blog/2014/10/06/creating-tor-hidden-services-with-python</id>
    <content type="html"><![CDATA[<p><img src="/images/headers/hidden_services.png"/></p>

<h3>Introduction</h3>

<p>Tor is often used to protect the anonymity of someone who is trying to connect to a service. However, it is also possible to use Tor to protect the anonymity of a service provider via <a href="https://www.torproject.org/docs/hidden-services.html.en"><strong><em>hidden services</em></strong></a>. These services, operating under the <code>.onion</code> TLD, allow publishers to anonymously create and host content viewable only by other Tor users.</p>

<p>The Tor project has <a href="https://www.torproject.org/docs/tor-hidden-service.html.en">instructions</a> on how to create hidden services, but this can be a manual and arduous process if you want to setup multiple services. This post will show how we can use the fantastic <code>stem</code> Python library to automatically create and host a Tor hidden service.</p>

<!--more-->


<h3>Creating Hidden Services Manually</h3>

<p>The <a href="https://www.torproject.org/docs/tor-hidden-service.html.en#two">instructions provided by the Tor project</a> show that creating hidden services simply involves setting up the service locally (such as a web server listening on localhost), and then setting a few configuration options to make the service available via Tor.</p>

<p>There are two configuration settings necessary to setup a hidden service: <code>HiddenServiceDir</code>, the directory to store the <code>hostname</code> and <code>private_key</code> files, and <code>HiddenServicePort</code>, the ports used to proxy hidden service connections.</p>

<p>As the instructions show, each hidden service requires a variation of the following two lines to be present in the <code>torrc</code> configuration file (setting the directory, host, and ports appropriately):</p>

<p><code>
HiddenServiceDir /path/to/store/hidden_service/
HiddenServicePort 80 127.0.0.1:5000
</code></p>

<h3>A Bit About the Tor Control Protocol</h3>

<p>Changing the configuration file and restarting Tor everytime a change is needed can be a pain. Fortunately, Tor provides a way to dynamically change the running configuration using a simple text based protocol (similar to Telnet) called the Tor Control Protocol.</p>

<p>The <a href="https://gitweb.torproject.org/torspec.git?a=blob_plain;hb=HEAD;f=control-spec.txt">full specification</a> of the protocol is available, however here is a quick example of getting the valid authentication methods:</p>

<p>```
$ telnet localhost 9151
PROTOCOLINFO</p>

<p>250-PROTOCOLINFO 1
250-AUTH METHODS=COOKIE,SAFECOOKIE,HASHEDPASSWORD COOKIEFILE=&ldquo;Tor\control_auth_cookie&rdquo;
250-VERSION Tor=&ldquo;0.2.4.24&rdquo;
250 OK
```</p>

<p>Other examples using this extensive protocol can be found <a href="https://www.thesprawl.org/research/tor-control-protocol/">here</a> or in the full protocol spec.</p>

<h3>Introducing Stem</h3>

<p>To make interacting with the Tor control port both easier and programmatic, the Tor project maintains a fantastic Python library called <a href="https://stem.torproject.org/">Stem</a>.</p>

<h4><code>stem.Controller</code></h4>

<p>Interaction with the Tor control port is performed using the <code>stem.Controller</code> class. Creating an instance of the class involves connecting to the port and authenticating as follows:</p>

<p>```
from stem.control import Controller
controller = Controller.from_port(address=&ldquo;127.0.0.1&rdquo;, port=9151)
try:</p>

<pre><code>controller.authenticate(password="")
</code></pre>

<p>except Exception as e:</p>

<pre><code>print e
</code></pre>

<p>```</p>

<p>Now that we have a Controller, we can access the local configuration, pull the current descriptors for relays, and more.</p>

<p>Let&rsquo;s use the Controller to automatically set the configuration settings we saw in the previous section. When set, these configuration options will cause Tor to create the two files, <code>hostname</code> and <code>private_key</code>, necessary to run the hidden service. Here is a short script that will setup a hidden service to listen on TCP port 80 and proxy all requests to an (already established) web server listening on <a href="http://127.0.0.1:5000:">http://127.0.0.1:5000:</a></p>

<p>```
host = &ldquo;127.0.0.1&rdquo;
port = 5000
hidden_svc_dir = &ldquo;/tmp/hidden_service/&rdquo;
controller.set_options([</p>

<pre><code>("HiddenServiceDir", hidden_svc_dir),
("HiddenServicePort", "80 %s:%s" % (host, str(port)))
</code></pre>

<p>])
svc_name = open(hidden_svc_dir + &ldquo;/hostname&rdquo;, &ldquo;r&rdquo;).read().strip()
print &ldquo;Created host: %s&rdquo; % svc_name
```</p>

<p>Easy as that! Now that we have the configuration setup, our service should be ready to go.</p>

<h3>An Example Service</h3>

<p>Now that we&rsquo;ve seen a little about how Stem works, here&rsquo;s an extremely basic example showing how the hidden service can be setup to work with a Flask application:</p>

<p>```
from stem.control import Controller
from flask import Flask</p>

<p>if <strong>name</strong> == &ldquo;<strong>main</strong>&rdquo;:</p>

<pre><code>app = Flask("example")
port = 5000
host = "127.0.0.1"
hidden_svc_dir = "c:/temp/"

@app.route('/')
def index():
    return "&lt;h1&gt;Tor works!&lt;/h1&gt;"
print " * Getting controller"
controller = Controller.from_port(address="127.0.0.1", port=9151)
try:
    controller.authenticate(password="")
    controller.set_options([
        ("HiddenServiceDir", hidden_svc_dir),
        ("HiddenServicePort", "80 %s:%s" % (host, str(port)))
        ])
    svc_name = open(hidden_svc_dir + "/hostname", "r").read().strip()
    print " * Created host: %s" % svc_name
except Exception as e:
    print e
app.run()
</code></pre>

<p>```</p>

<p>Here&rsquo;s what this looks like in action:
<code>
C:\&gt;python tor_example.py
 * Getting controller
 * Created host: 4yrbax6gwnemqh7n.onion
 * Running on http://127.0.0.1:5000/
</code></p>

<p><img src="/images/blog/hidden_services/screenshot.png"/></p>

<h3>Caveats</h3>

<p>It is important to note that the security of the hidden service depends on protecting the location of the server. To do this, consider ways to prevent leaking the real server IP through debug messages, etc. There has been some <a href="https://news.ycombinator.com/item?id=8404511">great discussion</a> on the topic that might be worth looking into.</p>

<h3>Conclusion</h3>

<p>Hidden services deliver freedom of speech and the free exchange of ideas without censorship. By using Stem Python library, it&rsquo;s possible to take the pain out of manual configuration and instead programmatically create and manage multiple hidden services.</p>

<p>As always, let me know if you have any questions or comments.</p>

<p>-Jordan (<a href="http://twitter.com/jw_sec">@jw_sec</a>)</p>
]]></content>
  </entry>
  
</feed>
